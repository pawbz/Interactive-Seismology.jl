[{"url":"cheatsheets/","title":"Cheatsheets","tags":["welcome"],"text":"Cheatsheets Getting Started with Julia - live . Fastrack to Julia  cheatsheet. MATLAB-Julia-Python comparative cheatsheet  by  QuantEcon group Plots.jl cheatsheet"},{"url":"classes/","title":"Lecture Schedule","tags":["welcome"],"text":"main a img {\n    width: 5rem;\n    margin: 1rem;\n}\n History of seismology Wave Theory Harmonic oscillator Waves on a string Stress and strain Equation of motion and constitutive equations Boundary conditions Planewaves Lameâ€™s theorem; P and S waves Rayleigh & Love waves; dispersion Normal models of the Earth Intrinsic attenuation Seismic anisotropy Born approximation and imaging"},{"url":".","title":"index","tags":["homepage"],"text":""},{"url":"installation/","title":"Software installation","tags":["welcome"],"text":"First-time setup: Install Julia & Pluto Text and pictures version: Step 1: Install Julia  1.8.2 Go to  https://julialang.org/downloads  and download the current stable release, Julia  1.8.2 , using the correct version for your operating system (Linux x86, Mac, Windows, etc). Step 2: Run Julia After installing,  make sure that you can run Julia . On some systems, this means searching for the â€œJulia  1.8.2 â€ program installed on your computer; in others, it means running the command  julia  in a terminal. Make sure that you can execute  1 + 1 : Make sure that you are able to launch Julia and calculate  1+1  before proceeding! Step 3: Install  Pluto Next we will install the  Pluto , the notebook environment that we will be using during the course. Pluto is a Julia  programming environment  designed for interactivity and quick experiments. Open the  Julia REPL . This is the command-line interface to Julia, similar to the previous screenshot. Here you type  Julia commands , and when you press ENTER, it runs, and you see the result. To install Pluto, we want to run a  package manager command . To switch from  Julia  mode to  Pkg  mode, type  ]  (closing square bracket) at the  julia>  prompt: \njulia> ]\n\n(@v 1.8 ) pkg>\n The line turns blue and the prompt changes to  pkg> , telling you that you are now in  package manager mode . This mode allows you to do operations on  packages  (also called libraries). To install Pluto, run the following (case sensitive) command to  add  (install) the package to your system by downloading it from the internet.\nYou should only need to do this  once  for each installation of Julia: \n(@v 1.8 ) pkg> add Pluto\n This might take a couple of minutes, so you can go get yourself a cup of tea! You can now close the terminal. Step 4: Use a modern browser: Mozilla Firefox or Google Chrome We need a modern browser to view Pluto notebooks with. Firefox and Chrome work best. Second time:  Running Pluto & opening a notebook Repeat the following steps whenever you want to work on a project or homework assignment. Step 1: Start Pluto Start the Julia REPL, like you did during the setup. In the REPL, type: julia> using Pluto\n\njulia> Pluto.run()\n The terminal tells us to go to  http://localhost:1234/  (or a similar URL). Letâ€™s open Firefox or Chrome and type that into the address bar. If youâ€™re curious about what a  Pluto notebook  looks like, have a look at the  Featured Notebooks . These notebooks are useful for learning some basics of Julia programming. If you want to hear the story behind Pluto, have a look a the  JuliaCon presentation . If nothing happens in the browser the first time, close Julia and try again. And please let us know! Step 2a: Opening a notebook from the web This is the main menu - here you can create new notebooks, or open existing ones. Our homework assignments will always be based on a  template notebook , available in this GitHub repository. To start from a template notebook on the web, you can  paste the URL into the blue box  and press ENTER. For example, homework 0 is available  here . Go to this page, and on the top right, click on the button that says â€œEdit or run this notebookâ€. From these instructions, copy the notebook link, and paste it into the box. Press ENTER, and select OK in the confirmation box. The first thing we will want to do is to save the notebook somewhere on our own computer; see below. Step 2b: Opening an existing notebook file When you launch Pluto for the second time, your recent notebooks will appear in the main menu. You can click on them to continue where you left off. If you want to run a local notebook file that you have not opened before, then you need to enter its  full path  into the blue box in the main menu. More on finding full paths in step 3. Step 3: Saving a notebook We first need a folder to save our homework in. Open your file explorer and create one. Next, we need to know the  absolute path  of that folder. Hereâ€™s how you do that in  Windows ,  MacOS  and  Ubuntu . For example, you might have: C:\\Users\\fons\\Documents\\18S191_assignments\\  on Windows /Users/fons/Documents/18S191_assignments/  on MacOS /home/fons/Documents/18S191_assignments/  on Ubuntu Now that we know the absolute path, go back to your Pluto notebook, and at the top of the page, click on  â€œSave notebookâ€¦â€ . This is where you type the  new path+filename for your notebook : Click  Choose . Step 4: Sharing a notebook After working on your notebook (your code is autosaved when you run it), you will find your notebook file in the folder we created in step 3. This the file that you can share with others, or submit as your homework assignment to Canvas. \nconst run = f => f();\nrun(async () => {\nconst versions = await (await fetch(`https://julialang-s3.julialang.org/bin/versions.json`)).json()\nconst version_names = Object.keys(versions).sort().reverse()\nconst stable = version_names.find(v => versions[v].stable)\nconsole.log({stable})\nconst pkg_stable = /\\d+\\.\\d+/.exec(stable)[0]\ndocument.querySelectorAll(\"auto-julia-version\").forEach(el => {\n    console.log(el)\n    el.innerText = el.getAttribute(\"short\") == null ? stable : pkg_stable\n})\n});"},{"url":"introduction/","title":"Seismology","tags":["welcome"],"text":"main a img {\n    width: 5rem;\n    margin: 1rem;\n}\n Seismology: Unveiling Earthâ€™s Vibrations Seismology is the scientific study of earthquakes and the vibrations they generate within the Earth. By analyzing these seismic waves, seismologists can gain valuable insights into the structure and dynamics of our planet. Through the use of specialized instruments called seismometers, seismologists measure and record the ground motion caused by earthquakes. These recordings, known as seismograms, provide crucial data that can be used to understand the behavior of seismic waves as they propagate through different layers of the Earth. Seismology plays a vital role in various fields, including earthquake engineering, hazard assessment, and the exploration of natural resources. By studying seismic activity, scientists can assess the potential risks associated with earthquakes, develop strategies for building resilient structures, and even locate underground oil and gas reservoirs. In this course, we will delve into the fascinating world of seismology, exploring the principles and techniques used to analyze seismic data. By the end of this journey, you will have a solid foundation in seismology and be equipped with the tools to interpret seismic waves and unravel the secrets hidden beneath our feet. Letâ€™s embark on this seismic adventure and discover the captivating realm of seismology together."},{"url":"logistics/","title":"Course Logistics","tags":["welcome"],"text":"main a img {\n    width: 5rem;\n    margin: 1rem;\n}\n Grading Assignments (40%); Mid term presentations (30%); End term exam (30%) Late assignments will receive no credit, please submit Mid/End Term Exams Open book exams, where you will have access to textbook chapters/ other reading material. The exam duration will be 3 Hrs.\nThe only thing that will not be allowed is interaction with peers."},{"url":"references/","title":"References","tags":["welcome"],"text":"main a img {\n    width: 5rem;\n    margin: 1rem;\n}\n Books Aki, Keiiti, and Paul G. Richards. Quantitative seismology. 2002. Shearer, Peter M. Introduction to seismology. Cambridge university press, 2019. Stein, Seth, and Michael Wysession. An introduction to seismology, earthquakes, and earth structure. John Wiley & Sons, 2009. Other Resources Live Jupyter Notebooks for Seismology Pluto Resources Pluto repository at Github How to Install Pluto  (straight from the main author Fons van der Plas) Sample notebooks are available via the index page after starting Pluto."},{"url":"search/","title":"Search results","tags":[],"text":"window.init_search(); Search Results \nLoading..."},{"url":"assets/scripts/get_highlights/","title":"get_highlights","tags":[],"text":"if isempty get metadata \"homepage\" , \"highlights\", nothing else highlights htl \"\"\" section div class \"content\" h2 x \"name\" h2 p x \"text\" p div div class \"preview\" img src \" x \"img\" \" div section \"\"\" for x in metadata \"homepage\" \"highlights\" htl \"\"\" div class \"subjectscontainer wide\" h1 Highlights h1 div class \"contain\" highlights div div \"\"\" end"},{"url":"assets/scripts/get_subjects/","title":"get_subjects","tags":[],"text":"let sections metadata \"sidebar\" sections htl \"\"\" let input other page.input output other page.output name get output.frontmatter, \"title\", basename input.relative path desc get output.frontmatter, \"description\", nothing tags get output.frontmatter, \"tags\", String image get output.frontmatter, \"image\", nothing class \"no decoration\", \"tag replace x, \" \" \" \" \" for x in tags ..., image nothing || isempty image ? nothing htl \"\"\" a title desc class class href root url \" \" other page.url h3 name h3 img src image a \"\"\" end for other page in collections section id .pages \"\"\" for section id, section name in sections isempty sections ? nothing htl \"\"\" div class \"wide subjectscontainer\" h1 Subjects h1 div class \"subjects\" sections div div \"\"\" end"},{"url":"eqdata/polarization/","title":"Polarization","tags":["eqdata"],"text":" A Pluto.jl notebook v0.19.46 frontmatter layout \"layout.jlhtml\" tags \"eqdata\" title \"Polarization\" using Markdown using InteractiveUtils This Pluto notebook uses bind for interactivity. When running this notebook outside of Pluto, the following 'mock version' of bind gives bound variables a default value instead of an error . macro bind def, element quote local iv try Base.loaded modules Base.PkgId Base.UUID \"6e696c72 6542 2067 7265 42206c756150\" , \"AbstractPlutoDingetjes\" .Bonds.initial value catch b missing end local el esc element global esc def Core.applicable Base.get, el ? Base.get el iv el el end end begin using Pkg Pkg.add url \"https github.com anowacki Geodesics.jl\" Pkg.add url \"https github.com anowacki Seis.jl\" Pkg.add url \"https github.com anowacki SeisRequests.jl\" Pkg.add \"GeoMakie\" Pkg.add \"CairoMakie\" Pkg.add \"PlutoUI\" using Dates, Geodesics, Seis, SeisRequests using GeoMakie, CairoMakie using PlutoUI end md\"\"\" Plot Earthquake Data A notebook that quickly downloads sample earthquake data. Interactive Seismology Notebooks https pawbz.github.io Interactive Seismology.jl Instructor Pawan Bharadwaj , Indian Institute of Science, Bengaluru, India \"\"\" SeisRequests.server list md\"\"\" We will now request for events occuring between `starttime` and `endtime` from the IRIS server. \"\"\" ev get events starttime \"2014 03 21T13 40 30.00\",endtime \"2014 03 21T13 45 40.00\",minmagnitude 6,latitude 7.0, longitude 94.0,maxradius 5.0,server \"IRIS\",verbose false md\"\"\" We will now query for stations that recorded the first earthquake event, with some constraints on the network and station codes. \"\"\" newsta get stations ev 1 ,network \"II\",station \"UOSS\",location \"10\",channel \"BH?\",server \"IRIS\",verbose false md\"\"\" Lets go ahead and download the data. \"\"\" sta1 get data code \"II.UOSS.10.BH?\",starttime \"2014 03 21T13 40 30.00\",endtime \"2014 03 21T14 40 30.00\",verbose false need a slider to interact with the time axis bind tend PlutoUI.Slider 500 3000, default 3000 md\"\"\" Plotting the time series recorded at all the three component sensors. \"\"\" begin fig Figure for i, s in enumerate sta1 ax Axis fig i,1 , title string s , xlabel \"time s \" lines ax, range s.b, step s.delta, length length s.t , s.t xlims ax, 300, tend end fig end md\"\"\" Packages \"\"\" "},{"url":"imaging/Born-approximation/","title":"Born Approximation","tags":["imaging"],"text":" A Pluto.jl notebook v0.19.46 frontmatter title \"Born Approximation\" tags \"imaging\" layout \"layout.jlhtml\" description \"Draw subsurface heterogeneities and model their linearized response using the notion of scattering theory.\" using Markdown using InteractiveUtils This Pluto notebook uses bind for interactivity. When running this notebook outside of Pluto, the following 'mock version' of bind gives bound variables a default value instead of an error . macro bind def, element quote local iv try Base.loaded modules Base.PkgId Base.UUID \"6e696c72 6542 2067 7265 42206c756150\" , \"AbstractPlutoDingetjes\" .Bonds.initial value catch b missing end local el esc element global esc def Core.applicable Base.get, el ? Base.get el iv el el end end begin using Symbolics using SymbolicUtils using Latexify using FFTW using PlutoPlotly using PlutoUI using PlutoTeachingTools using SpecialFunctions using Einsum using Tullio using MLUtils using PlutoLinks, PlutoHooks end ChooseDisplayMode TableOfContents md\"\"\" Born Approximation In this notebook, we construct an integral equation to model scattering due to subsurface heterogeneities using the notion of scattering theory. We assume that the medium may be decomposed into a known reference wave speed profile plus a perturbation called the scatterer. The wavefield similarly may be decomposed into a reference wavefield plus a scattered perturbed field. Interactive Seismology Notebooks https pawbz.github.io Interactive Seismology.jl Instructor Pawan Bharadwaj , Indian Institute of Science, Bengaluru, India \"\"\" md\"\"\" Draw on the canvas below to place the scatterers and interact with this notebook. \"\"\" bind slowness pert draw input HTML \"\"\" div id parent canvas id canvas width 200px height 100px canvas button id clearButton clear button div script const canvasWidth 200, canvasHeight 100, background \" f1f1f1\" const parentDiv currentScript.previousElementSibling const c parentDiv.querySelector \"canvas\" const ctx c.getContext \"2d\" ctx.fillStyle background ctx.fillRect 0, 0, canvasWidth, canvasHeight ctx.fillStyle \" 010101\" ctx.fillRect 50, 50, 5, 5 parentDiv.value vec x,y for x in 50 55, y in 50 55 let drawing false c.addEventListener 'mousedown', drawing true c.addEventListener 'mouseup', drawing false c.addEventListener 'mousemove', e if drawing ctx.beginPath ctx.arc e.offsetX, e.offsetY, 4, 0, 2 Math.PI ctx.fillStyle \" 010101\" ctx.fill parentDiv.value.push e.offsetX, canvasHeight e.offsetY parentDiv.dispatchEvent new CustomEvent \"input\" function clearCanvas e ctx.fillStyle background ctx.fillRect 0, 0, canvasWidth, canvasHeight parentDiv.value parentDiv.dispatchEvent new CustomEvent \"input\" parentDiv.querySelector \" clearButton\" .addEventListener 'click', clearCanvas script \"\"\" TwoColumn md\"\"\" bind it plot Clock 0.1 \"\"\", md\"\"\" bind reset anim CounterButton \"Reset Animation\" \"\"\" md\" Scalar Helmholtz Equation\" TODO get Helmholtz eq with the following substitution U ğ±, ğ±â‚› exp Ä± Ï‰ t syms x z syms t Dx Differential x Dz Differential z L u, s Ï‰^2 s u Dx Dx u Dz Dz u L U ğ±, ğ±â‚› , s ğ± ~ F Ï‰ Î´ ğ± ğ±â‚› Dt Differential t variables Ï syms Ä± syms Ï‰ angular frequency syms s ğ± Î´s ğ± reference and perturbed slowness syms U ğ±, ğ±â‚› reference wavefield syms Î´U ğ±, ğ±â‚› scattered wavefield syms ğ± spatial coordinate vector syms ğ±â‚› source coordinate vector syms f t source time function syms F Ï‰ source in the frequency domain syms Î´ ğ± Dirac delta function md\" Perturbation Theory\" TwoColumn md\"\"\" Reference State Has a medium with slowness ```julia s ğ± ``` and the wavefield ```julia U ğ±,ğ±â‚› ``` that is initiated at t 0 and satisfies ```julia L U, s ~ F Ï‰ Î´ ğ± ğ±â‚› . ``` \"\"\", md\"\"\" Perturbed State Has a perturbed medium with slowness ```julia s ğ± Î´s ğ± ``` and the perturbed wavefield ```julia U ğ± Î´U ğ± ``` that is initiated at t 0 and satisfies ```julia L U Î´U, s Î´s ~ F Ï‰ Î´ ğ± ğ±â‚› . ``` \"\"\" L U ğ±, ğ±â‚› Î´U ğ±, ğ±â‚› , s ğ± Î´s ğ± ~ F Ï‰ Î´ ğ± ğ±â‚› scat wave eq L Î´U ğ±, ğ±â‚› , s ğ± ~ expand simplify expand derivatives L U ğ±, ğ±â‚› Î´U ğ±, ğ±â‚› , s ğ± Î´s ğ± L U ğ±, ğ±â‚› , s ğ± L Î´U ğ±, ğ±â‚› , s ğ± expand scat wave eq.rhs md\" Born Approximation\" born scat wave eq scat wave eq.lhs ~ substitute scat wave eq.rhs, Ï‰^2 Î´s ğ± Î´U ğ±, ğ±â‚› 0 TwoColumn md\"\"\" Perturbed State Has a perturbed medium with slowness ```julia s ğ± ``` and the perturbed wavefield ```julia u ğ±,ğ±â‚› Î´u ğ±,ğ±â‚› ``` that is initiated at t 0 and satisfies ```julia L u Î´u, s Î´s ~ F Ï‰ Î´ ğ± ğ±â‚› . ``` \"\"\", md\"\"\" Impulsive State Has a perturbed medium with slowness ```julia s ğ± ``` and the perturbed wavefield ```julia G ğ±,ğ±áµ£ ``` that is initiated at t 0 and satisfies ```julia L G, s ~ F Ï‰ Î´ ğ± ğ±áµ£ . ``` \"\"\" born scat wave eq receiver coordinate syms ğ±áµ£ Green's function evaluated at ğ±, and source at ğ±áµ£ syms G ğ±, ğ±áµ£ Green wave eq L G ğ±, ğ±áµ£ , s ğ± ~ Î´ ğ± ğ±áµ£ ex1 simplify expand Green wave eq.lhs Î´U ğ±, ğ±â‚› born scat wave eq.lhs G ğ±, ğ±áµ£ ex2 Green wave eq.rhs Î´U ğ±, ğ±â‚› born scat wave eq.rhs G ğ±, ğ±áµ£ volume integral syms âˆ«áµ¥ expression md\"\"\" Here, we consider only volume scatterers, i.e., we simply consider an unbounded medium. In this case, using the Sommerfeld radiation condition and Green's theorem, the integral below vanishes. \"\"\" âˆ«áµ¥ ex1 ~ 0 md\"Finally, the integral equation to model the scattered field is given below.\" scattered wavefield Î´U ğ±áµ£, ğ±â‚› ~ âˆ«áµ¥ arguments ex2 1 ~ âˆ«áµ¥ arguments ex2 2 md\" Modeling\" md\" Appendix\" reference mass density rho0 2000.0f0 reference P velocity vp0 2500.0f0 md\" Source Bandwidth\" time grid tgrid range 0, stop 1.5, step 0.005 ... corresponding frequency grid freqgrid Float32. collect rfftfreq length tgrid , inv step tgrid kgrid Float32. 2.0f0 pi freqgrid inv vp0 . 1.0f 6 begin a Gaussian spectrum for source with peak frequency fpeak 50.0f0 Hz Fsource exp. abs2. freqgrid . fpeak 1.0f 3 remove zero frequency Fsource 1 0.0f0 end plot scatter x freqgrid, y Fsource , Layout width 400, height 200, title \"Source Spectrum\", xaxis title \"Frequency Hz \" , begin nxUI 200 nzUI 100 Î´xUI 4.0 spatial sampling interval xgridUI range 0, step Î´xUI, length nxUI zgridUI range 0, step Î´xUI, length nzUI end begin slowness grid input zeros Float32, nzUI, nxUI map slowness pert draw input do I slowness grid input nzUI I 2 1, I 1 1.0f 8 end end paUI tgrid, vp0, rho0, freqgrid, kgrid, Fsource, xgrid xgridUI, zgrid zgridUI begin Î´xplot 11.0 xgrid range first xgridUI , stop last xgridUI , step Î´xplot zgrid range first xgridUI , stop last zgridUI , step Î´xplot nxgrid length xgrid nzgrid length zgrid end pagrid tgrid, vp0, rho0, freqgrid, kgrid, Fsource, xgrid xgridUI . 1.0f 3, zgrid zgridUI . 1.0f 3 md\" Source Receiver\" rlocs x grid last. collect Iterators.product zgrid, xgrid rlocs z grid first. collect Iterators.product zgrid, xgrid return x,z for the element I of user input, assuming spatial sampling ds function get xlocation I, Î´ Float32. I 1 1 Î´ end function get zlocation I, Î´ Float32. nzUI I 2 1 Î´ end slocs x 0.0 source location s slocs z 100.0 nr 50 md\"Select Receivers bind rUI MultiCheckBox 1 nr, select all true, default collect 1 nr \" md\"\"\" In the experiment above, the distance x range extrema xgridUI m and the depth z range extrema zgridUI m. The seismic source is located near the surface at x, z 0,0 , and length rUI receivers on the surface z 0 . \"\"\" rlocs x rx for rx in range 0, stop last xgridUI , length nr receiver locations rlocs z fill 10.0, length rlocs x acq map rlocs x, rlocs z, slocs x, slocs z do x Float32. x end acqgrid map rlocs x rlocs x grid, rlocs z rlocs z grid, slocs x, slocs z do x Float32. x end md\" 2 D Green's Function\" md\"\"\" Calculate Green's function for a 2 D homogeneous medium. Arguments `sx` Source location in the x direction `sz` Source location in the z direction `rx` Receiver location in the x direction `rz` Receiver location in the z direction `f` Frequency of the wave `c` Velocity of the medium. Returns Green's function for the given source receiver pair in the 2 D homogeneous medium. Green's function describes the response of a medium with velocity `c` and density `rho` to a point source at ` sx, sz ` and a receiver at ` rx, rz ` at a given frequency `f`. \"\"\" md\"Method to get distance between source and receiver\" rad sx, sz, rx, rz sqrt abs2 sx rx abs2 sz rz function G0 rx, rz, sx, sz, k, rho k Ï‰ c wavenumber r distance between source and receiver r rad sx, sz, rx, rz return 0.25 rho im hankelh2 0, k r end md\" Modeling\" function get forward operator with scatterer locations pa, acq, scatterer locations if isempty scatterer locations return 0.0 else select only 10 scatterers for speed scatterer locations randobs scatterer locations, 5 end xgrid, zgrid, freqgrid, kgrid, Fsource, vp0, rho0 pa scat x map scatterer locations do l get xlocation l, Î´xUI end scat z map scatterer locations do l get zlocation l, Î´xUI end nr length acq.rlocs x nÏ‰ length pa.freqgrid tullio F iÏ‰ freqgrid iÏ‰ freqgrid iÏ‰ Fsource iÏ‰ 4.0 pi pi tullio G iÏ‰, ir, iS G0 scat x iS , scat z iS , acq.slocs x, acq.slocs z, kgrid iÏ‰ , rho0 G0 acq.rlocs x ir , acq.rlocs z ir , scat x ix , scat z iz , kgrid iÏ‰ , rho0 F iÏ‰ remove zero frequencies tullio G 1, i, j complex 0.0 return reshape G, nr nÏ‰, end forward grid use memo reset anim do get forward operator with scatterer locations pagrid, acqgrid, slowness pert draw input end function get forward operator pa, acq xgrid, zgrid, freqgrid, kgrid, Fsource, vp0, rho0 pa X Float32. collect xgrid nx length X Z Float32. collect zgrid nz length Z nr length acq.rlocs x nÏ‰ length pa.freqgrid tullio F iÏ‰ freqgrid iÏ‰ freqgrid iÏ‰ Fsource iÏ‰ 4.0 pi pi tullio G iÏ‰, ir, iz, ix G0 X ix , Z iz , acq.slocs x, acq.slocs z, kgrid iÏ‰ , rho0 G0 acq.rlocs x ir , acq.rlocs z ir , X ix , Z iz , kgrid iÏ‰ , rho0 F iÏ‰ remove zero frequencies tullio G 1, i, j, k complex 0.0 return reshape G, nr nÏ‰, nx nz end forward UI get forward operator paUI, acq function get reference wavefield pa, acq xgrid, zgrid, freqgrid, kgrid, Fsource, vp0, rho0 pa tullio D iÏ‰, ir, is G0 acq.rlocs x ir , acq.rlocs z ir , acq.slocs x is , acq.slocs z is , kgrid iÏ‰ , rho0 Fsource iÏ‰ remove zero frequencies tullio D 1, i, j complex 0.0 transform to time domain return irfft D, length tgrid , 1, end d get reference wavefield paUI, acq dgrid reshape get reference wavefield pagrid, acqgrid , , nzgrid, nxgrid function get scattered wavefield slowness, G, acq, pa nr length acq.rlocs x nÏ‰ length pa.freqgrid s view slowness, d G s d reshape d, nÏ‰, nr transform to time domain return irfft d, length pa.tgrid , 1, end begin Î´d get scattered wavefield slowness grid input, forward UI, acq, paUI Î´d , filter x x âˆ‰ rUI, 1 nr . 0.0f0 end Î´dgrid reshape get scattered wavefield 1.0f 8 ones 5 , forward grid, acqgrid, pagrid , , nzgrid, nxgrid Î´s is the perturbation in slowness Î´x is the spatial sampling used to scale slowness pertindices rlocs and slocs are receiver and source positions function get migration image Î´d, G, acq, pa xgrid, zgrid pa nx length xgrid nz length zgrid Î´d rfft Î´d, 1, Î´d view Î´d, Î´s G' Î´d Î´s reshape Î´s, nz, nx transform to time domain return real. Î´s end image get migration image Î´d, forward UI, acq, paUI md\" Plots\" function plot data d, Î´d, d1max fig Plot Layout title \"Measured Wavefield\", yaxis autorange \"reversed\", height 400, width 500, yaxis title \"time s \", Subplots shared xaxes true, shared yaxes true, rows 1, cols 2, subplot titles \"Reference\" \"Scattered\" , x title \" Receiver\" add trace fig, heatmap y tgrid, z d, zmin d1max, zmax d1max, showscale false, colorscale \"jet\" , row 1, col 1 add trace fig, heatmap y tgrid, z Î´d, zmin d1max, zmax d1max, showscale false, colorscale \"jet\" , row 1, col 2 return PlutoPlotly.plot fig end plot data d , , 1 , Î´d , , 1 , maximum abs,d , ,1 2 function add ageom fig, ageom, row 1, col 1 if ageom nothing add trace fig, scatter x ageom.rlocs x filter x x âˆˆ rUI, 1 nr , y ageom.rlocs z, mode \"markers\", marker color \"black\", marker symbol \"triangle down\", showlegend false , row row, col col add trace fig, scatter x ageom.slocs x, y ageom.slocs z, mode \"markers\", marker color \"black\", marker size 10, marker symbol \"star\", showlegend false , row row, col col end end function plot image image fig Plot Layout yaxis autorange \"reversed\", xaxis attr range extrema xgridUI . 20, 20 , yaxis attr range extrema zgridUI . 10, 10 , height 225, width 350, yaxis title \"Depth\", xaxis title \"Distance\", Subplots shared xaxes true, shared yaxes true, rows 1, cols 1, subplot titles \"Migration Image\" \"\" add trace fig, heatmap x xgridUI, y zgridUI, z image, showscale false, colorscale \"seismic\" , row 1, col 1 add ageom fig, acq return PlutoPlotly.plot fig end plot image image function plot animations d1, d2, d1max fig Plot Layout title \"Wavefield\", yaxis autorange \"reversed\", xaxis attr range extrema xgridUI . 20, 20 , yaxis attr range extrema zgridUI . 10, 10 , height 225, width 700, yaxis title \"Depth\", xaxis title \"Distance\", Subplots shared xaxes true, shared yaxes true, rows 1, cols 2, subplot titles \"Reference\" \"Scattered\" add trace fig, heatmap x xgrid, y zgrid, z d1, zmin d1max, zmax d1max, showscale false, colorscale \"Greys\" , row 1, col 1 add trace fig, heatmap x xgrid, y zgrid, z d2, zmin d1max, zmax d1max, showscale false, colorscale \"Greys\" , row 1, col 2 add ageom fig, acq, 1, 1 add ageom fig, acq, 1, 2 return PlutoPlotly.plot fig end begin reset anim plot animations dgrid mod it plot, div length tgrid , 2 1, , , Î´dgrid mod it plot, div length tgrid , 2 1, , , maximum abs, dgrid 1.0 end md\" References\" md\"\"\" Stanford Notes http sepwww.stanford.edu public docs sep131 rgunther1 paper html node3.html SEG Wiki https wiki.seg.org wiki Born approximate modeling formula \"\"\" md\"\"\" TODO refine the derivation Disconnect b w symbolic derivation and numerical simulation, is it inevitable here? Elastic Wavefield w density scatterers Radiation of velocity and density scatterers \"\"\" "},{"url":"imaging/adjoint-state-method/","title":"Adjoint State Method","tags":["imaging"],"text":" A Pluto.jl notebook v0.19.46 frontmatter title \"Adjoint State Method\" tags \"imaging\" layout \"layout.jlhtml\" description \"This notebook presents a discrete symbolic version of the adjoint state formulation involving the seismic wave equation so that it can act as a reference while implementing methods for full waveform inversion.\" using Markdown using InteractiveUtils using Symbolics, SymbolicUtils, LinearAlgebra, ChainRules, PlutoUI, PlutoTeachingTools, TikzPictures TableOfContents variables q md\"\"\" Adjoint State Method In seismic imaging, the adjoint state method is a numerical method for efficiently computing the gradient of an objective function. This notebook presents a discrete version of the adjoint state formulation involving the seismic wave equation so that it can act as a reference while implementing methods for full waveform inversion. We focus on the velocity stress formulation, which is a widely used numerical method for solving wave propagation problems in geophysics. This method involves discretizing the governing equations of motion, such as the wave equation, using finite difference techniques. Interactive Seismology Notebooks https pawbz.github.io Interactive Seismology.jl Instructor Pawan Bharadwaj, Indian Institute of Science, Bengaluru, India \"\"\" md\" Medium Created two symbolic variables Ï and Î¼â»Â¹ which can be used to represent the density and inverse of the shear modulus of the medium as functions of position x.\" variables Ï 1 3 Î¼â»Â¹ 1 3 md\" State Variables\" md\"In the velocity stress formulation, the seismic wavefield is described in terms of two variables the particle velocity and the stress. Two symbolic variables `v x, t ` and `Ïƒ x, t ` representing velocity and stress, respectively, as functions of space `x` and time `t` .\" syms v x, t Ïƒ x, t t collect x v x 1 , t 1 md\"As the velocity and stress fields are staggered in time, we create corresponding vectors at each time value in t and tÌ‚, respectively.\" V hcat collect broadcast x collect map t v x, t , vcat tâ‚€, t, T , x ... velocity in the discrete world Î£ hcat collect broadcast x collect map t Ïƒ x, t , vcat tâ‚€, tÌ‚ , xÌ‚ ... stress in the discrete world md\" Forcing\" md\"The symbol `f` represents the body force density, which is a quantity that describes the force per unit volume acting on a material.\" syms f x, t F collect map t f 0, t , tÌ‚ F hcat collect broadcast x collect map t f x, t , vcat tâ‚€, tÌ‚ , x ... md\" Momentum Equation\" md\"\"\" This line defines the initial momentum of the system, which is equal to the difference between the initial velocity of the particle v x, tÌ‚ 1 and its velocity at time t 0 which is zero in this case multiplied by the density of the medium Ï x and then subtracting the force acting on the particle at time t 0 f 0, x . It represents the balance of forces and momentum of the system at the initial time. \"\"\" syms Î´â‚“ Î´â‚œ dÎ£dx diff Î£, dims 2 Î´â‚“ md\"\"\" We will now construct a vector that represents the time derivative of the velocity field. The first few elements can be computed using the `diff ` function applied to the `V` array. The last element is the time derivative of `v x, t ` evaluated at the final time `T`, which is computed as the difference between `v x, T ` and `v x, last tÌ‚ `. \"\"\" dVdt diff V, dims 1 Î´â‚œ Ït repeat reshape Ï, 1, , 4, 1 compute value of Ï on the velocity grid function avx Ït hcat 0.5 Ït , i 1 . Ït , i for i in 1 size Ït, 2 1 ... end Meqs dVdt , 2 end 1 . avx Ït dÎ£dx F , 2 end 1 avx Ït Meqs ~ 0 md\" Constitutive Relations In linear elasticity, for example, the constitutive relation is given by Hooke's law, which states that stress is proportional to strain. \" âˆ‚Vâˆ‚x diff V, dims 2 Î´â‚“ md\"Similar to velocity, we will construct a vector that represents the time derivative of the stress field.\" âˆ‚Î£âˆ‚t diff Î£, dims 1 Î´â‚œ Î¼â»Â¹t repeat reshape Î¼â»Â¹, 1, , 3, 1 md\"This equation states that the time derivative of stress minus the gradient of the stress scaled by the shear modulus is equal to zero. This is a simplified form of the constitutive relation.\" Ceqs âˆ‚Î£âˆ‚t . Î¼â»Â¹t âˆ‚Vâˆ‚x 2 end 1, Ceqs ~ 0 md\" Leap frog Scheme\" md\"The leap frog scheme updates the values of the velocity and stress components at half integer time steps, staggered in time and space. The first two steps stress and velocity updates of this scheme are marked here.\" md\" Objective Function\" md\"Variable to define an observed velocity field, which is a function of space and time.\" syms vâ‚€ x, t md\"This defines a simple quadratic objective function that measures the difference between the model predicted velocity field v and the observed velocity field vâ‚€. Squaring the difference ensures that all differences are positive and also gives more weight to larger differences. The goal is to minimize this objective function to find the velocity field that best matches the observed data.\" Vâ‚€ hcat collect broadcast x collect map t vâ‚€ x, t , vcat t , x ... obj v, vâ‚€ v vâ‚€ ^2 md\"The final value of the objective function.\" J sum map obj, V 2 end 1, , Vâ‚€ md\" Adjoint State Variables Adjoint state variables are introduced in the context of optimization problems. In this case, these variables are used to find gradients of an objective function with respect to the parameters mass density and shear modulus.\" syms u x, t Ï„ x, t size Meqs md\"One multiplier for each of Meqsâ‹¯\" U hcat collect broadcast x collect map t u x, t , vcat tÌ‚, TÌ‚ , x 2 end 1 ... size Ceqs md\"One multiplier for each Ceqsâ‹¯\" ğ›• hcat collect broadcast x collect map t Ï„ x, t , vcat t end 1 , t end , T , xÌ‚ ... md\" Lagrangian\" Meqs | size, U| size md\"The Lagrangian component, for momentum equations `Meqs`, is given by\" Lâ‚ sum U . Meqs md\"The Lagrangian component, for constitutive equations `Ceqs`, is given by\" Lâ‚‚ sum ğ›• . Ceqs md\"Adding all the components of the Lagrangian together gives\" L Lâ‚ Lâ‚‚ J md\" Adjoint State Equations\" md\" Final Condition Time Reversal To obtain the final condition, we shall compute the gradient of the Lagrangian with respect to `v x, T `.\" md\"The solution of these adjoint equations is often obtained by using a time reversed version of the original numerical solver, known as the backpropagation.\" md\" Parameter Gradients Lets compute the gradient of L with respect to Ï and Î¼.\" gradient w.r.t. mass density âˆ‡Ï Differential Ï 2 L | expand derivatives , u x, TÌ‚ 0, v x, 0 0 gradient w.r.t. shear modulus âˆ‡Î¼â»Â¹ Differential Î¼â»Â¹ 2 L | expand derivatives , Ïƒ x, 0 0, Ï„ x, T 0 md\" Appendix\" md\" Variables\" md\"These commands create three symbolic time variables `t`, and staggered time variables `tÌ‚` and space variable `x`. We will consider three time steps for the leap frog scheme. The ` syms` macro is used in the `Symbolics.jl` package to declare symbolic variables.\" variables t 1 3 tÌ‚ 1 3 tÌ‚ is staggered collect t , collect tÌ‚ syms T TÌ‚ final time syms tâ‚€ variables x 1 4 xÌ‚ 1 3 space md\" Lagrangian\" md\"This code computes the gradient of the Lagrangian with respect to the velocity field to obtain adjoint equations.\" âˆ‚vL broadcast V 2 end, 2 end 1 do v Differential v L | expand derivatives end âˆ‚vL ~ 0 md\"This code computes the gradient of the Lagrangian with respect to the stress field to obtain adjoint equations.\" âˆ‚ÏƒL broadcast Î£ 2 end, do Ïƒ Differential Ïƒ L | expand derivatives end âˆ‚ÏƒL ~ 0 md\" Final Condition\" âˆ‚Lâˆ‚VT broadcast V end, do v Differential v L | expand derivatives end âˆ‚Lâˆ‚VT ~ 0 md\" Gradient Expressions\" nt 3 Vs1 V , Vs2 reverse Vs1, dims 1 Us1 hcat fill 0, 4 , U , , fill 0, 4 Us2 reverse Us1, dims 1 begin âˆ‡Ï1 0.0 for it in 2 5 âˆ‡Ï1 0.5 Î´â‚œ Us2 it 1, 2 Vs2 it 1, 2 Vs2 it, 2 0.5 Î´â‚œ Us2 it 1, 3 Vs2 it 1, 3 Vs2 it, 3 end end âˆ‡Ï âˆ‡Ï1 âˆ‡Ï âˆ‡Ï1 Î£s1 Ïƒ x, tÌ‚ 1 , Ïƒ x, tÌ‚ 2 , Ïƒ x, tÌ‚ 3 Î£s2 reverse Î£s1 ğ›•s Ï„ x, t 3 , Ï„ x, t 2 , Ï„ x, t 1 âˆ‡Î¼â»Â¹1 simplify sum ğ›•s it Î£s1 nt it Î£s1 nt it 1 for it in 1 nt 2 , expand true ğ›•s nt 1 Î£s1 1 âˆ‡Î¼â»Â¹2 simplify sum ğ›•s it 1 Î£s2 it Î£s2 it 1 for it in 2 nt 1 , expand true ğ›•s nt 1 Î£s2 nt âˆ‡Î¼â»Â¹ âˆ‡Î¼â»Â¹1 âˆ‡Î¼â»Â¹ âˆ‡Î¼â»Â¹2 md\" Tikz\" tikz default options raw\"\"\" background rectangle .style fill white , show background rectangle, \"\"\" tikz preamble raw\"\"\" \\usepackage tikz \\usepackage tikz \\usetikzlibrary fit, matrix, shapes.geometric \\tikzset % use tikzset, not tikzstyle cell .style rectangle, rounded corners 5pt, draw, \\tikzset % use tikzset, not tikzstyle cellv .style rectangle, rounded corners 5pt, draw, rotate 90, \\usepackage xifthen \\usetikzlibrary hobby \\usepackage pgfplots \\usepackage fontawesome \\usepackage bm,amsfonts,amsmath \\usetikzlibrary backgrounds,pgfplots.groupplots,snakes \\usepgfplotslibrary patchplots \\pgfplotsset try min ticks 2 \\usepackage pgfplotstable \\usetikzlibrary plotmarks,positioning,spy \\usetikzlibrary shapes.geometric, arrows, fadings \\usepgfplotslibrary groupplots, polar \\usepackage space grffile \\usetikzlibrary % decorations.pathreplacing,% decorations.pathmorphing% \\usetikzlibrary positioning,fit,backgrounds \\usetikzlibrary shapes,arrows \\usetikzlibrary decorations.markings \\usetikzlibrary patterns \\usetikzlibrary plotmarks \\usetikzlibrary fit \\usetikzlibrary intersections \\usepgfplotslibrary fillbetween \\pgfplotsset axis line style black 10 , every axis label .append style black 10 , every axis title .append style black 10 , every tick label .append style black 10 % need for pgfplots \\newcommand \\axisz 0cm \\newcommand \\axisx 0cm \\usetikzlibrary positioning \\usetikzlibrary shapes.geometric \\usetikzlibrary backgrounds \"\"\" t1, t2, t3, tv are texts s1 and s2 are labels with sizes plot state tikz TikzPicture L\"\"\" \\tikzstyle vertex circle,minimum size 20pt,inner sep 0pt \\foreach \\name \\x in v 0 1, v t 1 5, v t 2 9, v t 3 13, v T 17 \\node vertex,fill black 25, v \\x at \\x,0 \\name \\foreach \\name \\x in \\sigma 0 3, \\sigma \\hat t 1 7, \\sigma \\hat t 2 11, \\sigma \\hat t 3 15 \\node vertex,fill red 25 s \\x at \\x, 1 \\name \\foreach \\name \\x in f 0 3, f \\hat t 1 7, f \\hat t 2 11, f \\hat t 3 15 \\node vertex,fill blue 25 f \\x at \\x,1 \\name \\draw ,thick, red s 3 s 7 node above, midway, red 1 \\draw ,thick, red v 5 s 7 node above, midway, red 1 \\draw ,thick, blue s 7 v 9 node below, midway, blue 2 \\draw ,thick, blue v 5 v 9 node above, midway, blue 2 \\node above right 2mm of s 3 0 \\node above right 2mm of v 1 0 \"\"\", options tikz default options, preamble tikz preamble, width \"20cm\" plot state tikz t1, t2, t3, tv are texts s1 and s2 are labels with sizes plot adjstate tikz TikzPicture L\"\"\" \\tikzstyle vertex circle,minimum size 20pt,inner sep 0pt \\foreach \\name \\x in u 0 1, u \\hat t 1 5, u \\hat t 2 9, u \\hat t 3 13, u \\hat T 17 \\node vertex,fill black 25, v \\x at \\x,0 \\name \\foreach \\name \\x in \\tau t 1 3, \\tau t 2 7, \\tau t 3 11, \\tau T 15 \\node vertex,fill red 25 s \\x at \\x, 1 \\name \\foreach \\name \\x in g t 1 7, g t 2 11, g t 3 15 \\node vertex,fill blue 25 f \\x at \\x,1 \\name \\draw ,thick, red s 15 s 11 node above, midway, red 1 \\draw ,thick, red v 13 s 11 node above, midway, red 1 \\draw ,thick, blue s 11 v 9 node below, midway, blue 2 \\draw ,thick, blue v 13 v 9 node above, midway, blue 2 \\node above right 2mm of s 15 0 \\node above right 2mm of v 17 0 \"\"\", options tikz default options, preamble tikz preamble, width \"20cm\" plot adjstate tikz md\"\"\" References ^plessix R. E. Plessix, A review of the adjoint state method for computing the gradient of a functional with geophysical applications, Geophysical Journal International, Volume 167, Issue 2, November 2006, Pages 495â€“503, https doi.org 10.1111 j.1365 246X.2006.02978.x \"\"\" "},{"url":"imaging/adjoint-state-method_acoustic/","title":"adjoint-state-method_acoustic","tags":[],"text":" A Pluto.jl notebook v0.19.46 using Markdown using InteractiveUtils This Pluto notebook uses bind for interactivity. When running this notebook outside of Pluto, the following 'mock version' of bind gives bound variables a default value instead of an error . macro bind def, element quote local iv try Base.loaded modules Base.PkgId Base.UUID \"6e696c72 6542 2067 7265 42206c756150\" , \"AbstractPlutoDingetjes\" .Bonds.initial value catch b missing end local el esc element global esc def Core.applicable Base.get, el ? Base.get el iv el el end end using Symbolics, SymbolicUtils, LinearAlgebra, ChainRules, PlutoUI, PlutoTeachingTools, TikzPictures ChooseDisplayMode TableOfContents md\"\"\" Adjoint State Method In seismic imaging, the adjoint state method is a numerical method for efficiently computing the gradient of an objective function. This notebook presents a discrete version of the adjoint state formulation involving the seismic wave equation so that it can act as a reference while implementing methods for full waveform inversion. We focus on the velocity stress formulation, which is a widely used numerical method for solving wave propagation problems in geophysics. This method involves discretizing the governing equations of motion, such as the wave equation, using finite difference techniques. Interactive Seismology Notebooks https pawbz.github.io Interactive Seismology.jl Instructor Pawan Bharadwaj, Indian Institute of Science, Bengaluru, India \"\"\" md\" Medium Created two symbolic variables Ï and Î¼â»Â¹ which can be used to represent the density and inverse of the shear modulus of the medium as functions of position x.\" variables Ï 1 3 Kâ»Â¹ 1 3 md\" State Variables\" md\"In the velocity stress formulation, the seismic wavefield is described in terms of two variables the particle velocity and the stress. Two symbolic variables `v x, t ` and `Ïƒ x, t ` representing velocity and stress, respectively, as functions of space `x` and time `t` .\" syms v x, t p x, t md\"As the velocity and stress fields are staggered in time, we create corresponding vectors at each time value in t and tÌ‚, respectively.\" V hcat collect broadcast x collect map t v x, t , vcat tâ‚€, t, T , x ... velocity in the discrete world P hcat collect broadcast x collect map t p x, t , vcat tâ‚€, tÌ‚ , xÌ‚ ... stress in the discrete world md\" Forcing\" md\"The symbol `f` represents the body force density, which is a quantity that describes the force per unit volume acting on a material.\" syms f x, t F collect map t f 0, t , tÌ‚ F hcat collect broadcast x collect map t f x, t , vcat tâ‚€, tÌ‚ , x ... md\" Momentum Equation\" md\"\"\" This line defines the initial momentum of the system, which is equal to the difference between the initial velocity of the particle v x, tÌ‚ 1 and its velocity at time t 0 which is zero in this case multiplied by the density of the medium Ï x and then subtracting the force acting on the particle at time t 0 f 0, x . It represents the balance of forces and momentum of the system at the initial time. \"\"\" syms Î´â‚“â»Â¹ Î´â‚œâ»Â¹ dPdx diff P, dims 2 Î´â‚“â»Â¹ md\"\"\" We will now construct a vector that represents the time derivative of the velocity field. The first few elements can be computed using the `diff ` function applied to the `V` array. The last element is the time derivative of `v x, t ` evaluated at the final time `T`, which is computed as the difference between `v x, T ` and `v x, last tÌ‚ `. \"\"\" dVdt diff V, dims 1 Î´â‚œâ»Â¹ Ït repeat reshape Ï, 1, , 4, 1 compute value of Ï on the velocity grid function avx Ït hcat 0.5 Ït , i 1 . Ït , i for i in 1 size Ït, 2 1 ... end Meqs dVdt , 2 end 1 . avx Ït dPdx F , 2 end 1 avx Ït Meqs ~ 0 md\" Constitutive Relations In linear elasticity, for example, the constitutive relation is given by Hooke's law, which states that stress is proportional to strain. \" âˆ‚Vâˆ‚x diff V, dims 2 Î´â‚“â»Â¹ md\"Similar to velocity, we will construct a vector that represents the time derivative of the stress field.\" âˆ‚Pâˆ‚t diff P, dims 1 Î´â‚œâ»Â¹ Kâ»Â¹t repeat reshape Kâ»Â¹, 1, , 3, 1 md\"This equation states that the time derivative of stress minus the gradient of the stress scaled by the shear modulus is equal to zero. This is a simplified form of the constitutive relation.\" Ceqs âˆ‚Pâˆ‚t . Kâ»Â¹t âˆ‚Vâˆ‚x 2 end 1, Ceqs ~ 0 md\" Leap frog Scheme\" md\"The leap frog scheme updates the values of the velocity and stress components at half integer time steps, staggered in time and space. The first two steps stress and velocity updates of this scheme are marked here.\" md\" Objective Function\" md\"Variable to define an observed velocity field, which is a function of space and time.\" syms vâ‚€ x, t md\"This defines a simple quadratic objective function that measures the difference between the model predicted velocity field v and the observed velocity field vâ‚€. Squaring the difference ensures that all differences are positive and also gives more weight to larger differences. The goal is to minimize this objective function to find the velocity field that best matches the observed data.\" Vâ‚€ hcat collect broadcast x collect map t vâ‚€ x, t , vcat t , x ... obj v, vâ‚€ v vâ‚€ ^2 md\"The final value of the objective function.\" J sum map obj, V 2 end 1, , Vâ‚€ md\" Adjoint State Variables Adjoint state variables are introduced in the context of optimization problems. In this case, these variables are used to find gradients of an objective function with respect to the parameters mass density and shear modulus.\" syms u x, t Ï„ x, t size Meqs md\"One multiplier for each of Meqsâ‹¯\" U hcat collect broadcast x collect map t u x, t , vcat tÌ‚, TÌ‚ , x 2 end 1 ... size Ceqs md\"One multiplier for each Ceqsâ‹¯\" ğ›• hcat collect broadcast x collect map t Ï„ x, t , vcat t end 1 , t end , T , xÌ‚ ... md\" Lagrangian\" md\"The Lagrangian component, for momentum equations `Meqs`, is given by\" Lâ‚ sum U . Meqs md\"The Lagrangian component, for constitutive equations `Ceqs`, is given by\" Lâ‚‚ sum ğ›• . Ceqs md\"Adding all the components of the Lagrangian together gives\" L Lâ‚ Lâ‚‚ J md\" Adjoint State Equations\" md\" Final Condition Time Reversal To obtain the final condition, we shall compute the gradient of the Lagrangian with respect to `v x, T `.\" md\"The solution of these adjoint equations is often obtained by using a time reversed version of the original numerical solver, known as the backpropagation.\" md\" Parameter Gradients Lets compute the gradient of L with respect to Ï and Î¼.\" bind iÏd Select 1 3 gradient w.r.t. mass density âˆ‡Ï Differential Ï iÏd L | expand derivatives , u x, TÌ‚ 0, v x, 0 0 gradient w.r.t. shear modulus âˆ‡Kâ»Â¹ Differential Kâ»Â¹ 2 L | expand derivatives , Ïƒ x, 0 0, Ï„ x, T 0 md\" Appendix\" md\" Variables\" md\"These commands create three symbolic time variables `t`, and staggered time variables `tÌ‚` and space variable `x`. We will consider three time steps for the leap frog scheme. The ` syms` macro is used in the `Symbolics.jl` package to declare symbolic variables.\" variables t 1 3 tÌ‚ 1 3 tÌ‚ is staggered collect t , collect tÌ‚ syms T TÌ‚ final time syms tâ‚€ variables x 1 4 xÌ‚ 1 3 space md\" Lagrangian\" md\"This code computes the gradient of the Lagrangian with respect to the velocity field to obtain adjoint equations.\" âˆ‚vL broadcast V 2 end, 2 end 1 do v Differential v L | expand derivatives end âˆ‚vL ~ 0 md\"This code computes the gradient of the Lagrangian with respect to the stress field to obtain adjoint equations.\" âˆ‚ÏƒL broadcast P 2 end, do Ïƒ Differential Ïƒ L | expand derivatives end âˆ‚ÏƒL ~ 0 md\" Final Condition\" âˆ‚Lâˆ‚VT broadcast V end, do v Differential v L | expand derivatives end âˆ‚Lâˆ‚VT ~ 0 md\" Gradient Expressions\" nt 3 Vs1 V , Vs2 reverse Vs1, dims 1 Us1 hcat fill 0, 4 , U , , fill 0, 4 Us2 reverse Us1, dims 1 begin âˆ‡Ï1 0.0 for it in 2 5 âˆ‡Ï1 0.5 Î´â‚œ Us2 it 1, 2 Vs2 it 1, 2 Vs2 it, 2 0.5 Î´â‚œ Us2 it 1, 3 Vs2 it 1, 3 Vs2 it, 3 end end âˆ‡Ï âˆ‡Ï1 âˆ‡Ï âˆ‡Ï1 Ps1 P ğ›•s1 ğ›• , Ps2 reverse Ps1, dims 1 ğ›•s2 reverse ğ›•s1, dims 1 begin âˆ‡Kâ»Â¹1 0.0 for it in 2 4 global âˆ‡Kâ»Â¹1 Î´â‚œ ğ›•s2 it 1, 2 Ps2 it 1, 2 Ps2 it, 2 end end âˆ‡Kâ»Â¹ âˆ‡Kâ»Â¹1 âˆ‡Kâ»Â¹ âˆ‡Kâ»Â¹1 let âˆ‡Kâ»Â¹2 0.0 pp 0 pap 0 p 0 pa 0 for it in 1 3 pp p pap pa p Ps2 it, 2 pa ğ›•s2 it, 2 show p, pa global âˆ‡Kâ»Â¹1 Î´â‚œ ğ›•s2 it 1, 2 Ps2 it 1, 2 Ps2 it, 2 end end md\" Tikz\" tikz default options raw\"\"\" background rectangle .style fill white , show background rectangle, \"\"\" tikz preamble raw\"\"\" \\usepackage tikz \\usepackage tikz \\usetikzlibrary fit, matrix, shapes.geometric \\tikzset % use tikzset, not tikzstyle cell .style rectangle, rounded corners 5pt, draw, \\tikzset % use tikzset, not tikzstyle cellv .style rectangle, rounded corners 5pt, draw, rotate 90, \\usepackage xifthen \\usetikzlibrary hobby \\usepackage pgfplots \\usepackage fontawesome \\usepackage bm,amsfonts,amsmath \\usetikzlibrary backgrounds,pgfplots.groupplots,snakes \\usepgfplotslibrary patchplots \\pgfplotsset try min ticks 2 \\usepackage pgfplotstable \\usetikzlibrary plotmarks,positioning,spy \\usetikzlibrary shapes.geometric, arrows, fadings \\usepgfplotslibrary groupplots, polar \\usepackage space grffile \\usetikzlibrary % decorations.pathreplacing,% decorations.pathmorphing% \\usetikzlibrary positioning,fit,backgrounds \\usetikzlibrary shapes,arrows \\usetikzlibrary decorations.markings \\usetikzlibrary patterns \\usetikzlibrary plotmarks \\usetikzlibrary fit \\usetikzlibrary intersections \\usepgfplotslibrary fillbetween \\pgfplotsset axis line style black 10 , every axis label .append style black 10 , every axis title .append style black 10 , every tick label .append style black 10 % need for pgfplots \\newcommand \\axisz 0cm \\newcommand \\axisx 0cm \\usetikzlibrary positioning \\usetikzlibrary shapes.geometric \\usetikzlibrary backgrounds \"\"\" t1, t2, t3, tv are texts s1 and s2 are labels with sizes plot state tikz TikzPicture L\"\"\" \\tikzstyle vertex circle,minimum size 20pt,inner sep 0pt \\foreach \\name \\x in v 0 1, v t 1 5, v t 2 9, v t 3 13, v T 17 \\node vertex,fill black 25, v \\x at \\x,0 \\name \\foreach \\name \\x in \\sigma 0 3, \\sigma \\hat t 1 7, \\sigma \\hat t 2 11, \\sigma \\hat t 3 15 \\node vertex,fill red 25 s \\x at \\x, 1 \\name \\foreach \\name \\x in f 0 3, f \\hat t 1 7, f \\hat t 2 11, f \\hat t 3 15 \\node vertex,fill blue 25 f \\x at \\x,1 \\name \\draw ,thick, red s 3 s 7 node above, midway, red 1 \\draw ,thick, red v 5 s 7 node above, midway, red 1 \\draw ,thick, blue s 7 v 9 node below, midway, blue 2 \\draw ,thick, blue v 5 v 9 node above, midway, blue 2 \\node above right 2mm of s 3 0 \\node above right 2mm of v 1 0 \"\"\", options tikz default options, preamble tikz preamble, width \"20cm\" plot state tikz t1, t2, t3, tv are texts s1 and s2 are labels with sizes plot adjstate tikz TikzPicture L\"\"\" \\tikzstyle vertex circle,minimum size 20pt,inner sep 0pt \\foreach \\name \\x in u 0 1, u \\hat t 1 5, u \\hat t 2 9, u \\hat t 3 13, u \\hat T 17 \\node vertex,fill black 25, v \\x at \\x,0 \\name \\foreach \\name \\x in \\tau t 1 3, \\tau t 2 7, \\tau t 3 11, \\tau T 15 \\node vertex,fill red 25 s \\x at \\x, 1 \\name \\foreach \\name \\x in g t 1 7, g t 2 11, g t 3 15 \\node vertex,fill blue 25 f \\x at \\x,1 \\name \\draw ,thick, red s 15 s 11 node above, midway, red 1 \\draw ,thick, red v 13 s 11 node above, midway, red 1 \\draw ,thick, blue s 11 v 9 node below, midway, blue 2 \\draw ,thick, blue v 13 v 9 node above, midway, blue 2 \\node above right 2mm of s 15 0 \\node above right 2mm of v 17 0 \"\"\", options tikz default options, preamble tikz preamble, width \"20cm\" plot adjstate tikz md\"\"\" References ^plessix R. E. Plessix, A review of the adjoint state method for computing the gradient of a functional with geophysical applications, Geophysical Journal International, Volume 167, Issue 2, November 2006, Pages 495â€“503, https doi.org 10.1111 j.1365 246X.2006.02978.x \"\"\" "},{"url":"imaging/full-waveform-inversion/","title":"Seismic Full Waveform Inversion","tags":["imaging"],"text":" A Pluto.jl notebook v0.19.46 frontmatter title \"Seismic Full Waveform Inversion\" tags \"imaging\" layout \"layout.jlhtml\" description \"A notebook that demonstrates how interactivity makes seismic full waveform inversion more accessible and intuitive.\" using Markdown using InteractiveUtils This Pluto notebook uses bind for interactivity. When running this notebook outside of Pluto, the following 'mock version' of bind gives bound variables a default value instead of an error . macro bind def, element quote local iv try Base.loaded modules Base.PkgId Base.UUID \"6e696c72 6542 2067 7265 42206c756150\" , \"AbstractPlutoDingetjes\" .Bonds.initial value catch b missing end local el esc element global esc def Core.applicable Base.get, el ? Base.get el iv el el end end begin using FFTW using LinearAlgebra using LaTeXStrings using PlutoUI using Statistics using ProgressLogging using SparseArrays using DSP using PlutoPlotly using LossFunctions using MLUtils using FiniteDifferences using ForwardDiff using PlutoTeachingTools end TableOfContents md\"\"\" Full Waveform Inversion Seismic full waveform inversion FWI is a powerful technique for imaging the Earth's subsurface using seismic waves. However, FWI can be computationally intensive and require a deep understanding of numerical methods and algorithms. This notebook demonstrates how interactivity makes FWI more accessible and intuitive. Pseudo spectral methods are used to solve the 2 D SH stress velocity system. The particle velocity and stress fields are staggered in time and we use a simple explicit time stepping approach. Interactive Seismology Notebooks https pawbz.github.io Interactive Seismology.jl Instructor Pawan Bharadwaj , Indian Institute of Science, Bengaluru, India \"\"\" md\"\"\" Earth Medium Consider a mantle like medium that has density of 3.22 g cc and shear wave velocity of 5 km s^ 1 . Suppose it has a reflector such that the medium has a higher density below the reflector compared to above. You can specify the location and density of the reflector below. \"\"\" md\"\"\" A Priori Information bind apriori flag Select a \"Accurate Background Velocity Unknown Reflector\", b \"Inaccurate Background Velocity Known Reflector\", c \"Inaccurate Background Velocity Unknown Reflector\" \"\"\" md\"\"\" Measured Displacement Field Pseudo spectral method is applied for solving the seismic equation given the true medium parameters. Wavefields at the receivers are recorded and observed data is generated. \"\"\" md\" Gradients\" md\" Wave Equation\" md\"\"\" We shall first consider the equation of motion and simplify it to derive the 2 D SH system ```math \\rho \\ddot u \\mathbf \\nabla \\cdot \\mathbf \\sigma f . \\ ``` Lets assume that the \\ 1 particles are constrained to move only along y direction, i.e., u x u z 0 ```math \\rho \\ddot u y \\partial x \\sigma yx \\partial z \\sigma yz f y , ```\\ 2 stresses don't change along y direction to result in ```math \\partial y \\sigma \\cdot 0. ``` The constitutive equations are ```math \\sigma yx 2\\mu\\epsilon yx \\mu\\partial x u y, ``` ```math \\sigma yz 2\\mu\\epsilon yz \\mu\\partial z u y. ``` \"\"\" md\"\"\" Forward Experiment \"\"\" md\"\"\" Spatial Grids Let us set up the spatial parameters of the simulation. We define a 2 D spatial grid of extents xâˆˆ 40,40 km and zâˆˆ 0,40 km. \"\"\" DSP.nextfastfft 106 input number of wavelengths, then roughly get the length, then use nextfast fft begin domain extends zgrid range 0, stop 40, length 107 xgrid range 40, stop 40, length 221 Numerics nx, nz length xgrid , length zgrid Derived numerics dx, dz step xgrid , step zgrid cell sizes end md\"\"\" Acquistion Geometry Choose the number of sources and receivers to be used in the simulation. \"\"\" md\"\"\" Medium This will also serve as an initial model during inversion. Medium without the reflector is considered. \"\"\" md\"\"\" Time Grid In order to study the propagation of the wave front, we need to choose a time step that satisfies the Courant condition. Here, we have chosen the Courant number to be 0.2 . \"\"\" md\" Body Forces\" md\" Inversion\" md\" Generate Data\" md\" Bundle Parameters \" md\" Loss Function\" loss L2DistLoss function Jdata dobs, d, loss loss return mapreduce , dobs, d do d1, d2 value loss, d1, d2 end end md\" Adjoint Simulation\" md\"Deviation between the observed and modelled data is referred to as the data error and it acts as the forcing in the case of adjoint simulation.\" function get adj source dobs, d adj source deriv. loss, dobs, d reverse adj source, dims 1 end md\"\"\" Gradients \"\"\" md\"\"\" Finite Difference Tests Tick to perform these tests bind do fd tests CheckBox \"\"\" do fd tests && time JsÏ xs do fd tests && time JsinvÎ¼ xs do fd tests && xs zeros Float32, 3 md\"\"\" Appendix \"\"\" md\" UI\" md\"\"\" Function to choose the number of sources and receivers \"\"\" function src rec ip return PlutoUI.combine do Child src md\"\"\"Number of sources Child \"ns\", Slider range start 1,stop 10,step 1 , default 1, show value true \"\"\", rec md\"\"\"Number of receivers Child \"nr\", Slider range start 5, stop 15, step 1 , default 50, show value true \"\"\", md\"\"\" src rec \"\"\" end end bind acq src rec ip md\"\"\" Function to choose the parameters of the true medium. Z location of the reflector as the well as the density of the medium below the reflector can be chosen. \"\"\" function choose param truemed return PlutoUI.combine do Child zloc md\"\"\"Z location km Child \"z\", Slider zgrid floor Int,0.3 nz end , default zgrid floor Int,0.5 nz , show value true \"\"\", dens md\"\"\"Density g cc Child \"Ï\", Slider range start 4, stop 6, step 0.1 , default 5, show value true \"\"\", md\"\"\" zloc dens \"\"\" end end bind param true med choose param truemed md\"\"\" Fourier Derivatives We now define methods to compute a 2 D Fourier transform. ```math \\hat u \\mathbf k , t \\frac 1 2\\pi \\sum \\mathbf x u \\mathbf x , t \\, e^ i \\mathbf k \\cdot \\mathbf x \\ , ``` The derivative property of Fourier Transform First order differentiation of a function along the x dimension is equivalent to multiplying its Fourier Transform by \\imath k x in the wavenumber domain.\\ ```math \\partial xu \\mathbf x , t \\leftrightarrow ik x \\hat u \\mathbf k , t . ``` In the following cell, the derivatives are calculated using the functions `Dx ` and `Dz `. Simply put, these functions compute the Fourier transform, apply the derivative property, and take the inverse Fourier Transform to generate the spatial derivative. \"\"\" begin Fz plan rfft zeros Float32, nz, nx , 1 Fx plan rfft zeros Float32, nz, nx , 2 kx reshape collect rfftfreq nx, inv step xgrid , 1, 2 pi kz reshape collect rfftfreq nz, inv step zgrid , , 1 2 pi storagex zero Fx zeros Float32, nz, nx storagez zero Fz zeros Float32, nz, nx fp Fx, Fz, kx, kz, storagex, storagez function Dx dPdx, P, fp mul fp.storagex, fp.Fx, P broadcast , fp.storagex, fp.storagex, fp.kx rmul fp.storagex, im ldiv dPdx, fp.Fx, fp.storagex end Dx dP, P Dx dP, P, fp Dx P dPdx zero P Dx dPdx, P, fp dPdx function Dz dPdz, P, fp mul fp.storagez, fp.Fz, P broadcast , fp.storagez, fp.storagez, fp.kz rmul fp.storagez, im ldiv dPdz, fp.Fz, fp.storagez end Dz dP, P Dz dP, P, fp Dz P dPdz zero P Dz dPdz, P, fp dPdz end test transpose of Dx begin x1 rand Float32, nz, nx y1 rand Float32, nz, nx dot Dx x1 , y1 , dot x1, Dx y1 end md\" Acquisition\" function get ageom xgrid, zgrid, ns, nr zs quantile zgrid, 0.25 , zr quantile zgrid, 0.25 A ns, nr, zs fill zs, ns , zr fill zr, nr , xr nr 1 ? quantile xgrid, 0.25 range quantile xgrid, 0.25 , stop quantile xgrid, 0.75 , length nr , xs ns 1 ? quantile xgrid, 0.25 range quantile xgrid, 0.25 , stop quantile xgrid, 0.75 , length ns return A end ageom get ageom xgrid, zgrid, acq.ns, acq.nr get adj ageom ageom nr ageom.ns, ns ageom.nr, xs ageom.xr, zs ageom.zr, xr ageom.xs, zr ageom.zs adj ageom get adj ageom ageom m are the medium properties that will be used function get projection matrix xpos, zpos, xgrid, zgrid transpose flag false, m ones Float32, length zgrid , length xgrid l LinearIndices length zgrid , length xgrid assert length xpos length zpos n length xpos N length xgrid length zgrid I broadcast zpos, xpos do z, x iz argmin abs. zgrid . z 1 ix argmin abs. xgrid . x 1 return l iz, ix end J collect 1 n V m I return transpose flag ? sparse J, I, V, n, N sparse I, J, V, N, n end md\" Data\" function initialize data grid param, ageom zeros Float32, length grid param.tgrid , length ageom.xr end md\" Medium\" function bundle medium Î¼, Ï return Î¼ Î¼, Ï Ï, invÏ inv. Ï end function update xsÏ x, xs xÏ, xinvÎ¼ chunk x, 2 N length xÏ N2 div N, 2 X view xÏ, N2 N2 length xs 1 copyto X, xs return xs end function update xsinvÎ¼ x, xs xÏ, xinvÎ¼ chunk x, 2 N length xÏ N2 div N, 2 X view xinvÎ¼, N2 N2 length xs 1 copyto X, xs return xs end function get xs x, xs xÏ, xinvÎ¼ chunk x, 2 N length xÏ N2 div N, 2 return vcat xÏ N2 N2 length xs 1 , xinvÎ¼ N2 N2 length xs 1 end â• â•â•¡ begin e.g., get vs mean, medium get vs op, medium op sqrt. medium.Î¼ . medium.Ï get vs medium sqrt. medium.Î¼ . medium.Ï end â• â•â•¡ Ï‡ m, m0 log m m0 invÏ‡ x, m0 exp x m0 Ï0 Float32 3.22 10^ 3 10^15 density in kg km3 Ï1 Float32 5.00 10^ 3 10^15 density in kg km3 Î¼0 Float32 82 10^9 10^3 Î¼1 Float32 50 10^9 10^3 invÏ0 inv Ï0 invÎ¼0 inv Î¼0 medium ref values Î¼0, invÎ¼0, Ï0, invÏ0, Ï1, Î¼1 medium ref values begin lets add density perturbation olivine Î¼true ones Float32, nz, nx . medium ref values.Î¼0 Ïtrue ones Float32, nz, nx . medium ref values.Ï0 reflect index findall zgrid . param true med.z 1 Ïtrue reflect index end, . medium ref values.Ï1 medium true bundle medium Î¼true, Ïtrue end â• â•â•¡ begin courant number 0.2 lets calculate the min distance from the center to the edge of the domain r min xgrid end xgrid 1 , zgrid end zgrid 1 0.5 choose time stepping dt to satisfy Courant condition dt courant number step xgrid inv get vs minimum, medium true nt Int floor r mean sqrt. medium true.Î¼ . medium true.Ï dt 2 tgrid range 0, length nt, step dt nothing end â• â•â•¡ â• â•â•¡ md\"\"\" Reduce the time window bind t grad RangeSlider tgrid left first tgrid , right last tgrid , show value true \"\"\" â• â•â•¡ â• â•â•¡ bind t forw Slider 1 length tgrid 1, show value true â• â•â•¡ â• â•â•¡ length tgrid â• â•â•¡ begin Unperturbed medium Î¼ref apriori flag â‰  a ? fill medium ref values.Î¼1, nz, nx fill medium ref values.Î¼0, nz, nx shear modulus in kg km s^2 Ïref ones Float32, nz, nx medium ref values.Ï0 density in kg km3 if apriori flag b Ïref reflect index end, . medium ref values.Ï1 end medium ref bundle medium Î¼ref, Ïref end function get x medium, ref medium ref values return vcat vec Ï‡. medium.Ï, ref.Ï0 , vec Ï‡. inv. medium.Î¼ , ref.invÎ¼0 end x0 get x medium ref function update medium medium, x, ref medium ref values xÏ, xinvÎ¼ chunk x, 2 map medium.Î¼, xinvÎ¼ do xm inv invÏ‡ xm, ref.invÎ¼0 end map medium.Ï, xÏ do xm invÏ‡ xm, ref.Ï0 end map medium.invÏ, medium.Ï do Ï inv Ï end return medium end function update x x, medium, ref medium ref values xÏ, xinvÎ¼ chunk x, 2 map xinvÎ¼, medium.Î¼ do m Ï‡ inv m , ref.invÎ¼0 end map xÏ, medium.Ï do m Ï‡ m, ref.Ï0 end return x end md\" Absorbing Boundaries\" function get taper array nx, nz np 50, tapfact 0.20 tarray ones Float32, nz, nx for ix in 1 np tarray , ix . tarray , ix abs2 exp tapfact abs np ix 1 np tarray , nx ix 1 . tarray , nx ix 1 abs2 exp tapfact abs np ix 1 np end for iz in 1 np tarray iz, . tarray iz, abs2 exp tapfact abs np iz 1 np tarray nz iz 1, . tarray nz iz 1, abs2 exp tapfact abs np iz 1 np end return tarray end function clip edges m, grid param xgrid, zgrid grid param I findall x isequal x, 1 , grid param.tarray xs extrema unique getindex. I, 2 zs extrema unique getindex. I, 1 return xgrid range xs... , zgrid range zs... , m range zs... , range xs... end md\"\"\" Fields \"\"\" function initialize fields pa, nt snap store false nz, nx pa.nz, pa.nx f vy zeros Float32, nz, nx , dvydx zeros Float32, nz, nx , dvydz zeros Float32, nz, nx , Ïƒyx zeros Float32, nz, nx , dÏƒyxdx zeros Float32, nz, nx , Ïƒyz zeros Float32, nz, nx , dÏƒyzdz zeros Float32, nz, nx if snap store fs vys zeros Float32, nz, nx for i in 1 nt , Ïƒyxs zeros Float32, nz, nx for i in 1 nt , Ïƒyzs zeros Float32, nz, nx for i in 1 nt return merge f, fs else return f end end function reset fields fields fill fields.vy, zero Float32 fill fields.dvydx, zero Float32 fill fields.dvydz, zero Float32 fill fields.Ïƒyx, zero Float32 fill fields.Ïƒyz, zero Float32 fill fields.dÏƒyxdx, zero Float32 fill fields.dÏƒyzdz, zero Float32 end md\" Gradients\" function initialize grad pa, nt nz, nx pa.nz, pa.nx return g zeros Float32, 2 nz nx , gÏ zeros Float32, nz, nx , ginvÎ¼ zeros Float32, nz, nx end a zeros 100 function update gx gx, g, x, ref medium ref values xÏ, xinvÎ¼ chunk x, 2 gÏ, ginvÎ¼ chunk g, 2 gxÏ, gxinvÎ¼ chunk gx, 2 map gxinvÎ¼, ginvÎ¼, xinvÎ¼ do g, m ref.invÎ¼0 exp m g end map gxÏ, gÏ, xÏ do g, m ref.Ï0 exp m g end return x end create a function to compute grad phi and grad mu choosing t grad as tgrid will give an accurate gradient of the least squares objective function function reduce gradients grad, x, forwfields, adjfields, pa, t grad pa.tgrid g, gÏ, ginvÎ¼ grad fill g, zero Float32 fill gÏ, zero Float32 fill ginvÎ¼, zero Float32 nx, nz, tarray, dt, tgrid pa nt1 argmin abs. tgrid . first t grad nt2 argmin abs. tgrid . last t grad term u nt v 1 . gÏ gÏ adjfields.vys nt2 forwfields.vys nt2 term Ï„ nt 1 Ïƒ 1 . ginvÎ¼ ginvÎ¼ adjfields.Ïƒyxs nt2 1 forwfields.Ïƒyxs nt2 adjfields.Ïƒyzs nt2 1 forwfields.Ïƒyzs nt2 for gradÏ for it nt1 nt2 1 . gÏ gÏ adjfields.vys it forwfields.vys it 1 forwfields.vys it . gÏ gÏ pa.tarray for gradÎ¼ for it nt1 1 nt2 1 . ginvÎ¼ ginvÎ¼ adjfields.Ïƒyxs it 1 forwfields.Ïƒyxs it 1 forwfields.Ïƒyxs it adjfields.Ïƒyzs it 1 forwfields.Ïƒyzs it 1 forwfields.Ïƒyzs it . gÎ¼ gÎ¼ pa.tarray end end multiply with dt rmul ginvÎ¼, inv dt rmul gÏ, inv dt gÏ1, ginvÎ¼1 chunk g, 2 copyto gÏ1, gÏ copyto ginvÎ¼1, ginvÎ¼ parameterization update gx g, g, x end md\" Wavelets\" md\"\"\" Generate a Ricker Wavelet. Reference Frequencies of the Ricker wavelet, Yanghua Wang, GEOPHYSICS, VOL. 80, NO. 2. Its bandwidth is roughly 1.2 fpeak. `fqdom Float32` dominant frequency `tgrid` time domain grid `tpeak Float32 tgrid 1 1.5 fqdom` the peak of the ricker in time has a default \"\"\" function ricker fqdom, tgrid tpeak is the location of the peak amplitude tpeak tgrid 1 1.5 fqdom, using approximate half width of ricker trim tol 0.0, maxamp 1.0 tpeak tgrid 1 1.5 fqdom && error \"cannot output Ricker for given tgrid and tpeak\" tpeak tgrid end 1.5 fqdom && error \"cannot output Ricker for given tgrid and tpeak\" isapprox fqdom, 0.0 && error \"dominant frequency cannot be zero\" some constants pf Ï€ Ï€ fqdom^2.0 nt length tgrid Î´t step tgrid initialize wav zero tgrid ricker wavelet for it 1 nt tsquare tgrid it tpeak tgrid it tpeak wav it 1.0 2.0 pf tsquare exp 1.0e0 pf tsquare maxamp end isapprox maximum abs. wav , 0.0 && warn \"wavelet is zeros\" return Float32. wav end â• â•â•¡ begin source fpeak 2.0 in Hz source wavelet ricker source fpeak, tgrid, maxamp 1e15 source repeat source wavelet, 1, ageom.ns end â• â•â•¡ â• â•â•¡ begin Choosing the extent of taper for absorbing boundaries true medium lambda get vs mean,medium true source fpeak taper points floor Int, 2 true medium lambda dz NamedTuple for grid related parameters grid param xgrid, zgrid, tgrid, dt step tgrid , nt length tgrid , nx length xgrid , nz length zgrid , tarray get taper array nx, nz, np taper points, tapfact 0.1 end â• â•â•¡ â• â•â•¡ true medium lambda step xgrid â• â•â•¡ â• â•â•¡ true medium lambda step zgrid â• â•â•¡ â• â•â•¡ taper points â• â•â•¡ â• â•â•¡ begin Initialisation of fields and data fields true initialize fields grid param, grid param.nt dobs initialize data grid param, ageom Running the simulation to generate observed data time propagate dobs, fields true, grid param, medium true, ageom, source end â• â•â•¡ â• â•â•¡ dobs â• â•â•¡ â• â•â•¡ gradient initialize grad grid param, grid param.nt â• â•â•¡ â• â•â•¡ do fd tests && g2Ï get xs gradient.g, xs 1 length xs Gradients wrt Ï computed via adjoint state method â• â•â•¡ â• â•â•¡ do fd tests && g2invÎ¼ get xs gradient.g, xs length xs 1 end Gradients wrt Î¼â»Â¹ computed via adjoint state method â• â•â•¡ â• â•â•¡ plot heatmap x xgrid, y zgrid, z grid param.tarray â• â•â•¡ â• â•â•¡ function propagate data, fields, pa, medium, ageom, source source spray and receiver projection matrix Rs get projection matrix ageom.xs, ageom.zs, grid param.xgrid, grid param.zgrid, transpose flag false, m medium.invÏ Rr get projection matrix ageom.xr, ageom.zr, grid param.xgrid, grid param.zgrid, transpose flag true reset fields fields vy, dvydx, dvydz, Ïƒyx, Ïƒyz, dÏƒyxdx, dÏƒyzdz fields nx, nz, tarray, tgrid, dt, nt pa Î¼, Ï, invÏ medium time loop progress for it 1 nt update vy Dx dÏƒyxdx, Ïƒyx Dz dÏƒyzdz, Ïƒyz . vy vy invÏ dÏƒyxdx dÏƒyzdz dt body force need to view vy as a vector for source recording operations vyv view vy, f view source, it, mul vyv, Rs, f, dt, 1.0 update Ïƒ Dx dvydx, vy Dz dvydz, vy . Ïƒyx Ïƒyx Î¼ dvydx dt . Ïƒyx Ïƒyx pa.tarray . Ïƒyz Ïƒyz Î¼ dvydz dt . Ïƒyz Ïƒyz pa.tarray record fields d view data, it, mul d, Rr, vyv vys âˆˆ keys fields && copyto fields.vys it , vy Ïƒyxs âˆˆ keys fields && copyto fields.Ïƒyxs it , Ïƒyx Ïƒyzs âˆˆ keys fields && copyto fields.Ïƒyzs it , Ïƒyz end return nothing end â• â•â•¡ â• â•â•¡ plot tgrid, source wavelet, size 500, 200 , w 2, label \"Source Wavelet\", Layout width 500, height 250 â• â•â•¡ â• â•â•¡ source wavelet | typeof â• â•â•¡ â• â•â•¡ begin Initialisation of fields and data fields forw initialize fields grid param, grid param.nt, snap store true dref initialize data grid param, ageom Simulation to compute wavefields propagate dref, fields forw, grid param, medium ref, ageom, source reverse the time order of fields stored reverse fields forw.vys reverse fields forw.Ïƒyxs reverse fields forw.Ïƒyzs end â• â•â•¡ â• â•â•¡ adj source get adj source dobs, dref â• â•â•¡ â• â•â•¡ begin Initialisation of fields and data fields adj initialize fields grid param, nt, snap store true dadj initialize data grid param, adj ageom Simulating the adjoint field propagate dadj, fields adj, grid param, medium ref, adj ageom, adj source end â• â•â•¡ â• â•â•¡ reduce gradients gradient, x0, fields forw, fields adj, grid param, t grad â• â•â•¡ â• â•â•¡ fwi param fields forw initialize fields grid param, nt, snap store true , fields adj initialize fields grid param, nt, snap store true , medium deepcopy medium ref , dref, ageom, adj ageom, source, adj source, dobs, grid param, xbuffer get x medium ref , gradient initialize grad grid param, grid param.nt â• â•â•¡ â• â•â•¡ function J x fwi param fwi param dref, fields forw, grid param, medium, ageom, source fwi param update medium medium, x propagate dref, fields forw, grid param, medium, ageom, source return Jdata dref, dobs end â• â•â•¡ â• â•â•¡ function JsÏ xs fwi param fwi param Function to check gradients wrt Ï update xsÏ fwi param.xbuffer, xs return J fwi param.xbuffer, fwi param fwi param end â• â•â•¡ â• â•â•¡ do fd tests && g1Ï grad central fdm 2, 1 , JsÏ, xs Gradients wrt Ï using central difference â• â•â•¡ â• â•â•¡ do fd tests && g1Ï 1 . g2Ï â• â•â•¡ â• â•â•¡ function JsinvÎ¼ xs fwi param fwi param Function to check gradients wrt invÎ¼ update xsinvÎ¼ fwi param.xbuffer, xs return J fwi param.xbuffer, fwi param fwi param end â• â•â•¡ â• â•â•¡ do fd tests && g1invÎ¼ grad central fdm 2, 1 , JsinvÎ¼, xs Gradients wrt Î¼â»Â¹ using central difference â• â•â•¡ â• â•â•¡ do fd tests && g1invÎ¼ 1 . g2invÎ¼ â• â•â•¡ md\"\"\" Plots \"\"\" md\"This function plots the wavefield after clipping the edges.\" function add ageom fig, ageom, row, col if ageom nothing add trace fig, scatter x ageom.xr, y ageom.zr, mode \"markers\", marker color \"black\", marker symbol \"triangle down\", showlegend false , row row, col col add trace fig, scatter x ageom.xs, y ageom.zs, mode \"markers\", marker color \"black\", marker size 10, marker symbol \"star\", showlegend false , row row, col col end end function fieldheat fields, titles, grid param, ageom nothing assert length fields length titles 4 fig Plot Layout yaxis autorange \"reversed\", title attr font size 12, , font attr size 10 , yaxis attr scaleanchor \"x\", scaleratio 1 , Subplots shared xaxes true, shared yaxes true, horizontal spacing 0.04, vertical spacing 0.04, rows div length fields 1, 2 1, cols 2, subplot titles titles i 0 for f in fields i i 1 ic 2 mod i, 2 ir div i 1, 2 1 x, y, z clip edges f, grid param dmax maximum abs, f add trace fig, heatmap xmin 30, xmax 30, x x, y y, z z, zmin dmax, zmax dmax, colorscale \"seismic\", showscale false , row ir, col ic add ageom fig, ageom, ir, ic end return PlutoPlotly.plot fig end â• â•â•¡ let t mod t forw, grid param.nt 1 t grad fieldheat fields forw.vys t , fields adj.vys nt t , gradient.gÏ, gradient.ginvÎ¼ , \"Forward Field\" \"Adjoint Field\" \"Gradient w.r.t. Ï\" \"Gradient w.r.t. Î¼â»Â¹\" , grid param, ageom end â• â•â•¡ â• â•â•¡ function mediumheat medium, ageom nothing Î¼, Ï medium c get vs medium fig Plot Layout yaxis autorange \"reversed\", height 300, width 650, title attr font size 12, , font attr size 10 , yaxis attr scaleanchor \"x\" , Subplots shared xaxes true, shared yaxes true, horizontal spacing 0.3, rows 1, cols 2, subplot titles \"Velocity km s \" \"Density g cc \" add trace fig, heatmap x xgrid, y zgrid, z c, colorscale \"Portland\", colorbar x 0.35 , row 1, col 1 add trace fig, heatmap x xgrid, y zgrid, z Ï 1e 12, colorscale \"Portland\", colorbar x 1.0 , row 1, col 2 if ageom nothing for ic in 1 2 add ageom fig, ageom, 1, ic end end return PlutoPlotly.plot fig end â• â•â•¡ â• â•â•¡ mediumheat medium true, ageom â• â•â•¡ â• â•â•¡ mediumheat medium ref, ageom â• â•â•¡ function dataheat d, tgrid title \"Data\" data d dmax maximum abs, data trace heatmap z data, x 1 size data, 2 , y tgrid, colorscale \"RdBu\", reversescale true, zmin dmax, zmax dmax, layout Layout title title, width 225, height 225, xaxis range 0, size data, 2 1 , yaxis scaleanchor \"x\", yaxis scaleratio 2.5, yaxis autorange \"reversed\", xaxis title \"Receiver \", yaxis title \"Time s \", return plot trace, layout end â• â•â•¡ ThreeColumn md\"\"\" dataheat dobs, tgrid, title \"Observed Data\" \"\"\", md\"\"\" dataheat dref, tgrid, title \"Modelled Data\" \"\"\", md\"\"\" dataheat adj source, tgrid, title \"Adjoint Sources\" \"\"\" â• â•â•¡ md\"\"\" We now know how to calculate the derivatives using functions `Dx` and `Dz`. Let's now discretize the time dimension and formulate an explicit time stepping leap frog scheme and alternatively update the velocity and stress fields. We will start with the velocity field ```math \\rho \\dot v y \\mathrm Dx \\sigma yx it \\tfrac 1 2 \\mathrm Dz \\sigma yz it \\tfrac 1 2 , ``` where the finite difference approximation for the time derivative for timestep dt is ```math \\frac \\rho v y it v y it 1 dt \\mathrm Dx \\sigma yx it \\tfrac 1 2 \\mathrm Dz \\sigma yz it \\tfrac 1 2 , ``` ```math v y it v y it 1 \\frac dt \\rho \\left \\mathrm Dx \\sigma yx it \\tfrac 1 2 \\mathrm Dz \\sigma yz it \\tfrac 1 2 \\right , ``` ```math v y it v y it 1 \\frac dt \\rho \\mathrm Dx \\sigma yx it \\tfrac 1 2 \\mathrm Dz \\sigma yz it \\tfrac 1 2 . ``` Similarly, for updating the stresses, ```math \\dot \\sigma 21 \\mu\\frac dv y dx , ``` ```math \\dot \\sigma 23 \\mu\\frac dv y dz , ``` we can write ```math \\sigma 21 it \\tfrac 1 2 \\sigma 21 it \\tfrac 1 2 \\mu\\mathrm Dx v y dt, ``` ```math \\sigma 23 it \\tfrac 1 2 \\sigma 23 it \\tfrac 1 2 \\mu\\mathrm Dz v y dt. ``` Notice that the temporal grid of stress and velocity are staggered. Finally, let's write a function now that leaps by a given number of steps. \"\"\" "},{"url":"introduction/history/","title":"Historical Review","tags":["introduction"],"text":" A Pluto.jl notebook v0.19.43 frontmatter title \"Historical Review\" layout \"layout.jlhtml\" tags \"introduction\" description \"Some notes on the historical review and introductory material\" using Markdown using InteractiveUtils using PlutoUI, PlutoTeachingTools ChooseDisplayMode TableOfContents md\"\"\" Seismology \"\"\" Markdown.MD Markdown.Admonition \"warning\", \"\", md\"\"\" the study of mechanical vibrations of the Earth The science of seismology has double feature, it aims simultaneously to obtain the infrastructure of the Earth's interior with the aid of seismic wave phenomena nature of earthquake sources with an ultimate goal of mitigating them \"\"\" md\" Seismology Unique Characteristics\" Markdown.MD Markdown.Admonition \"warning\", \"\", md\"\"\" 1 concerned only with the mechanical properties and dynamics of the Earth 2 seismic waves allow investigation of Earth's interior out to the greatest depths than any other branch of geophysics they have least distortion compared to any other wave that can be observed after propogating through the Earth 3 contributes to our knowledge of only the present state of the Earth's interior \"\"\" md\" Seismology Interdisciplinary Science\" Markdown.MD Markdown.Admonition \"warning\", \"\", md\"\"\" medicine knowledge of anatomy, chemistry of drugs, physics of lasers, mathematics of tomography seismology geology , engineering , physics , mathematics , and computation \"\"\" Markdown.MD Markdown.Admonition \"note\", \"\", md\"\"\" most of the theory needed to interpret seismograms through efforts of physicists and mathematicians prior to 1922 its history is inseparable from the history of great achievements in continuum mechanics , applied mathematics , and general wave theory \"\"\" md\" Seismology\" Markdown.MD Markdown.Admonition \"warning\", \"Principal Components\", md\"\"\" seismometry and experimental seismology theory of seismic fields in the earth rays, waves, modes, beams seismic sources Earth's internal structure \"\"\" md\" Scales in Seismology\" Markdown.MD Markdown.Admonition \"warning\", \"\", md\"\"\" seismic sources , a factor of 10^ 18 in equivalent seismic moment smallest detectable micro earthquake to 1960 Chile earthquake seismograph networks , a factor of 10^6 in linear dimension 10 meter in engineering surveys to 10000 km global array observatories ground displacement , a factor of 10^ 11 smallest detectable ground displacement of 10^ 10 m compare with diameter of the hydrogen atom to â‰ˆ 10 m of slip on a major fault during the earthquake \"\"\" md\"\"\" Seesaws in Seismology \"\"\" Markdown.MD Markdown.Admonition \"warning\", \"\", md\"\"\" effects of sources and medium are strongly coupled in seismology our knowledge of the seismic sources and the Earth medium have advanced in a see saw fashion, i.e., if sources are better understood at a given stage, they are constrained to better understand the medium, and then the improved knowledge of the medium is used to revise our knowledge of the source \"\"\" md\" Seismology\" Markdown.MD Markdown.Admonition \"warning\", \"Stimuli of Rapid Growth\", md\"\"\" occurrence of major devastating earthquakes exploration oil and gas, minerals advances in mathematics and theoretical physics breakthroughs in sensing or computation technology planetary exploration \"\"\" md\" Seismology and Big Data\" Markdown.MD Markdown.Admonition \"warning\", \"\", md\"\"\" exponential growth in better quality data 1901 25 seismic stations 1940 250 seismic stations around the globe 2023 10000 seismic stations around the globe \"\"\" Markdown.MD Markdown.Admonition \"warning\", \"Current Holistic Statge\", md\"\"\" imaging the Earth's interior and seismic sources will all available data \"\"\" md\"\"\" Seismologists are Handicapped \"\"\" Markdown.MD Markdown.Admonition \"danger\", \"\", md\"\"\" meteorologists can put their sensors in the eye of a hurricane, we cannot put a sensor in the focal region of an earthquake heavy dependency on the far field measurements physical theory as to what happens at the earthquake source is missing \"\"\" Markdown.MD Markdown.Admonition \"danger\", \"\", md\"\"\" most of the current graduate students engaged in computer simulation games and or seismic data processing challenges, with insufficient efforts to construct new theoretical physical models we need endeavors to come up with new mathematical weapons to understand the nonlinear dynamics \"\"\" md\"\"\" Some Technical Remarks \"\"\" Markdown.MD Markdown.Admonition \"danger\", \"\", md\"\"\" A more technical definition mostly a study where the spatial fluctuations in particle displacements, strains, and stresses have wavelengths much larger than the amplitudes of the particle displacements in the Earth's medium in other words, we don't use the equation of motion in its strict form Aki and Richards, Ch.2 \"\"\" md\" Historical Review\" md\"\"\" Seismometry \"\"\" Markdown.MD Markdown.Admonition \"warning\", \"\", md\"\"\" a seismograph for an earth scientist what the telescope is to the astronomer a tool for peering into inaccessible regions Ari Ben Menahem \"\"\" md\"\"\" 1819 Observations of faulting associated with Kutch earthquake in India \"\"\" Markdown.MD Markdown.Admonition \"warning\", \"\", md\"\"\" major earthquakes continue to serve as milestones on the road of progress in seismology \"\"\" md\"\"\" 1841 James David Forbes the first seismometer \"\"\" md\"\"\" 1857 Robert Mallet an engineer who laid the foundation of instrumental seismology first systematic attempt to apply physical principles to earthquake effects first world seismicity map \"\"\" Markdown.MD Markdown.Admonition \"warning\", \"\", md\"\"\" Mallet, the first true seismologist, used bowls of mercury at varying distances from sources to measure the propogation of waves \"\"\" md\"\"\" 1884 Rossi Forel, J. F. J Schmidt a scale for earthquake effects \"\"\" md\"\"\" 1889 Ernst von Rebeur Paschwitz first measurement of teleseismic Japanese earthquake \"\"\" Markdown.MD Markdown.Admonition \"warning\", \"\", md\"\"\" birth of teleseismic seismograms earthquakes are no longer a local affair of cities but became a global phenomenon this was the first revolution \"\"\" Markdown.MD Markdown.Admonition \"tems\", \"\", md\"\"\" When first seismogram was measured in early 1880s, seismologists were puzzled why it lasted long and why there are oscillations after the arrivals or P and S waves \"\"\" md\"\"\" 1894 Milne and his associates compact seismograph system, and seismology emerged as a quantitative science \"\"\" md\"\"\" 1895 F. Omori a law for aftershock time series \"\"\" md\"\"\" 1897 R. D. Oldham identification of three types of waves P, S and R in seismograms \"\"\" md\"\"\" 1900 Emil Wiechert three component mechanical seismograph system \"\"\" md\"\"\" 1906 observed faulting and slip for California earthquake \"\"\" md\"\"\" 1910 Boris Borisovich Golitzin first electromagnetic seismograph \"\"\" md\"\"\" 1935 Hugo Benioff measure a component of ground strain a strain seismograph measures variation in displacement between two points in space \"\"\" md\"\"\" 1942 B. Gutenberg, C. Richter first empirical observations between earthquake magnitude, intensity, energy, and frequency of occurrence \"\"\" md\"\"\" 1946 age of nuclear testing the use of nuclear explosions greatly enhanced the capabilities of seismic studies of the Earth's interior \"\"\" md\"\"\" 1964 1969 large seismometer arrays came into vogue \"\"\" md\"\"\" 1969 Apollo passive seismic experiment beginning of planetary seismology \"\"\" Markdown.MD Markdown.Admonition \"warning\", \"\", md\"\"\" When the first seismogram for the Moon was obtained in 1969, seismologists were again puzzled by the great length of time for which oscillations continued \"\"\" md\"\"\" 1978 ocean bottom seismographs \"\"\" md\"\"\" 1982 Global Digital Seismograph Network a worldwide network of more than 100 stations \"\"\" md\"\"\" 2011 Distributed Acoustic Sensing DAS Rayleigh scattering based DAS systems use fiber optic cables to provide distributed strain sensing \"\"\" md\"\"\" Theory of Seismic Fields in the Earth \"\"\" md\"\"\" 1660 Robert Hooke stated one dimensional linear stress strain relationship, thus laying the foundation for theory of elasticity \"\"\" md\"\"\" 1807 Thomas Young recognize shear as elastic strain and defined modulus of elasticity \"\"\" md\"\"\" 1821 to 1831 C. Navier, A. Cauchy, S. D. Poisson fundamental equations of linear elastodynamics Cauchy's stress strain relations existence of compressional and shear waves in elastic solids created confusion in the wave theory of light if two types of light waves should be visible \"\"\" Markdown.MD Markdown.Admonition \"warning\", \"\", md\"\"\" Navier was a disciple of Fourier and a professor of mechanics he was the first one to derive elastodynamic displacement equations \"\"\" md\"\"\" 1829 to 1850 S. D. Poisson, G. G. Stokes, Lord Kelvin, H. Lamb, G. Lame theoretical studies on the vibrations of elastic bodies Stokes fundemental equation on viscous fluids \"\"\" Markdown.MD Markdown.Admonition \"warning\", \"\", md\"\"\" even though Poisson discovered longitudinal and transverse waves in 1828, they were only first observed in seismograms by Oldham in 1897 \"\"\" md\"\"\" 1872 E. Betti Reciprocity relations leading later to the representation theorem of elastodynamics \"\"\" md\"\"\" 1877 E. B. Christoffel plane wave phase velocities in general anisotropic media \"\"\" md\"\"\" 1885 Lord Rayleigh a homogeneous elastic substance can accommodate a third wave at its boundary Rayleigh waves are inhomogeneous waves \"\"\" md\"\"\" 1898 T. Bromwich studied the influence of gravity on elastic waves \"\"\" md\"\"\" 1899 C. G. Knott refraction and reflection coefficients of plane seismic waves at planar discontinuities \"\"\" md\"\"\" 1904 H. Lamb first synthetic seismogram a mathematical model of an earthquake in a half space configuration, known as Lamb's problem \"\"\" md\"\"\" 1904 A. E. H. Love 3 D elastodynamic representation theorem \"\"\" md\"\"\" 1905 R. Becker theory of standard linear solids with relaxation, as a physical model for anelasticity \"\"\" md\"\"\" 1910 H. Benndrof, K. Zoppritz ray theory for seismic signal propagation in spherically symmetric Earth models \"\"\" md\"\"\" 1910 M. R. Frechet functional calculus the \"Frechet\" derivative \"\"\" md\"\"\" 1911 A. E. H. Love Love waves are transversely polarized waves, which are not included in the theories of Rayleigh and Lamb \"\"\" md\"\"\" 1912 H. Lamb group and phase velocity of surface waves and the interpretation of seismograms \"\"\" md\"\"\" 1920 Harold Jeffreys advanced mathematical and statistical methods into seismic data analysis \"\"\" md\"\"\" 1920 L. M. Hoskins studied free oscillations of gravitating radially inhomogeneous spheres \"\"\" md\"\"\" 1926 M. Born the Born approximation of wavefields \"\"\" md\"\"\" 1930 N. Wiener tools for computerized signal analysis \"\"\" md\"\"\" 1949 R. Stoneley effect of anisotropy on elastic surface waves \"\"\" md\"\"\" 1953 P. M. Morse, H. Feshbach elastodynamic integral representation theorem \"\"\" md\"\"\" 1955 Fourier transform methods into analysis of surface wave dispersion and attenuation \"\"\" md\"\"\" 1960 1975 age of digital computers computer generated synthetic seismograms huge amounts of seismological data can be processed in a relatively short time asymptotic wave theories in vertically in homogeneous media \"\"\" md\"\"\" 1970 1985 asymptotic ray theory, ray tracing in complex media, shadow zones finite difference and finite element methods theory of inversion and resolution of gross Earth data imaging in inhomogeneous elastic media Kirchoff Helmholtz integral formulation Kirchoff migration \"\"\" md\"\"\" 1984 back projection of travel time delays along ray paths seismic wave tomographic inversion diffraction tomography in exploration seismology full waveform inversion \"\"\" md\"\"\" Earth's Internal Structure \"\"\" md\"\"\" 1798 Henry Cavendish determined mean density of the Earth using Newton's law of universal gravitation \"\"\" md\"\"\" 1863 Lord Kelvin used tidal observations to estimate that the mean rigidity of the Earth exceeds that of steel \"\"\" md\"\"\" 1888 A. Schmidt argues in general that wave velocity increases with depth, and raypaths will be curved and convave upward toward the Earth surface \"\"\" md\"\"\" 1897 Emil Wiechert numerical details of an Earth model consisting of a core of radius almost 5000 km conjecture that the inner core is mettalic \"\"\" md\"\"\" 1910 R. D. Oldham presence of central core with a radius of 1600 km after observing substantially delayed P waves inferred that the Earth contains a central region with lower wave velocity than the surrounding shell the mantle no S waves were observed below the mantle \"\"\" md\"\"\" 1909 K. Zoppritz first traveltime inversion calculation of travel time tables for seismic phases and analytical solutions for Abel type integral equations to determine wave velocity as a function of depth \"\"\" md\"\"\" 1909 Andrija Mohorovicic evidence of a sharp increase in the P wave velocity 54 km below the Earth's surface \"\"\" md\"\"\" 1914 Beno Gutenberg found a low velocity zone at a depth of 2900 km \"\"\" md\"\"\" 1921 E. Meissner observed dispersion of surface waves in the Earth crust \"\"\" md\"\"\" 1923 E. D. Williamson and L. H. Adams use seismological data, values of Earth's mass and moment of inertia to estimate density gradients of the Earth \"\"\" md\"\"\" 1930 V. Conard H. Jeffreys three layer crustal models using near field headwaves P g , S g , P^ , S^ \"\"\" md\"\"\" 1936 Inge Lehmann existence of an inner core by observing amplitudes of P waves between angular distances of 105Â° to 142Â° \"\"\" md\"\"\" 1939 H. Jeffreys apply Airy theory of diffraction near a caustic to understand wave diffraction by the Earth's core \"\"\" md\"\"\" 1942 K. E. Bullen classification of Earth's interior into a number of shells \"\"\" Markdown.MD Markdown.Admonition \"warning\", \"\", md\"\"\" computers enabled sophisticated forward and inverse computational schemes this was the second revolution 1950 1955 \"\"\" md\"\"\" 1969 1977 rays in anisotropic media evidence of anisotropy in crust and mantle \"\"\" md\"\"\" 1980 ever increasing quantity and quality of seismic data, deviations from isotropy, spherical symmetry, and pure elasticity were observed with more precision 3 D images of seismic velocities and anisotropy with detailed velocity structure near major internal boundaries \"\"\" md\"\"\" Seismic Sources \"\"\" md\"\"\" 1761 John Michell explosive theory of earthquakes earthquakes originate within the Earth, and wave spread out from the source throughout the Earth's interior \"\"\" md\"\"\" 1906 H. F. Reid studied geodetic measurements before and after an earthquakee rupture, and developed elastic rebound theory \"\"\" md\"\"\" 1907 Vito Volterra integral representation of seismic sources using Betti's reciprocity theorem \"\"\" md\"\"\" 1917 J. Shida observed regularities in the distribution of polarities of the initial P wave motion epicentral region is divided into four parts by two perpendicular lines intersecting at the epicenter \"\"\" md\"\"\" 1922 H. H. Turner existance of deep earthquakes \"\"\" md\"\"\" 1923 Hiroshi Nakano double couple model observed patterns of initial motions are explainable using classical Stokes Love solution \"\"\" md\"\"\" 1926 H. Jeffreys first use of wave amplitudes from seismograms to estimate earthquake energy release \"\"\" md\"\"\" 1952 B. Gutenberg, C. Richter surface wave magnitude maxiumum amplitude of the crustal surface waves having a specific period \"\"\" md\"\"\" 1958 J. A. Steketee equivalence theorem, stating that the displacement field produced by dislocation sources in an elastic body equals that produced by double couple forces \"\"\" md\"\"\" 1960 Chile earthquake was studied comprehensively \"\"\" md\"\"\" 1960 1980 propagating rupture over a causative fault is revealed kinematic dislocation model energy budget for major earthquakes \"\"\" md\"\"\" 1989 detailed study of the geometry of the rupture using diversified set of data near field and far field seismograms, GPS measurements, surface ruptures, aftershock spatial distribution, and focal mechanism results obtained so far point to complexity of seismic sources \"\"\" md\"\"\" Resources ^Paper Ari Ben Menahem A concise history of mainstream seismology Origins, legacy, and perspectives. Bulletin of the Seismological Society of America \"\"\" "},{"url":"introduction/oscillations/","title":"Oscillations","tags":["introduction"],"text":" A Pluto.jl notebook v0.19.46 frontmatter title \"Oscillations\" tags \"introduction\" layout \"layout.jlhtml\" description \"Environment for exploring oscillations\" using Markdown using InteractiveUtils This Pluto notebook uses bind for interactivity. When running this notebook outside of Pluto, the following 'mock version' of bind gives bound variables a default value instead of an error . macro bind def, element quote local iv try Base.loaded modules Base.PkgId Base.UUID \"6e696c72 6542 2067 7265 42206c756150\" , \"AbstractPlutoDingetjes\" .Bonds.initial value catch b missing end local el esc element global esc def Core.applicable Base.get, el ? Base.get el iv el el end end begin using LinearAlgebra using Plots using PlutoUI using LaTeXStrings using PlutoTeachingTools using PlutoUI using Symbolics using SymbolicUtils using Einsum using TikzPictures using Roots end TableOfContents md\"\"\" Oscillations This notebook creates an interactive environment to explore the oscillations of `N` particles attached to springs. We write the equation of motion for each of the particles and then solve for the modes of the system. The user can select a particular mode to visualize the oscillations. Notice that all the particles oscillate in phase given a particular mode. This exercise will help us transition from the oscillations of one particle to the oscillations of a continuous object, that is, seismic waves. Interactive Seismology Notebooks https pawbz.github.io Interactive Seismology.jl Instructor Pawan Bharadwaj , Indian Institute of Science, Bengaluru, India \"\"\" md\"Number of particles bind N Slider 2 10, show value true \" bind tplot Clock 0.1 md\"\"\" ```math \\omega 0 \\sqrt\\frac k m ``` Each spring is assumed to have a constant k and each particle has mass m . \"\"\" variables t Ï‰â‚€ Ï‰ variables x 1 N A 1 N Dt Differential t md\" Determinant Method\" md\"\"\" `fma` constructs the equations of motion for a system of N particles connected by springs. Here's a breakdown of how it works First particle Boundary Condition This represents the equation of motion for the first particle, considering the spring force from the boundary and the second particle. Intermediate Masses This represents the equations of motion for the intermediate masses, considering the spring forces from both the previous and the next particles. Last Mass Boundary Condition This represents the equation of motion for the last mass, considering the spring force from the second to last particle and the boundary. \"\"\" fma vcat Dt Dt x 1 Ï‰â‚€^2 x 1 Ï‰â‚€^2 x 1 x 2 , Dt Dt x i Ï‰â‚€^2 x i x i 1 Ï‰â‚€^2 x i x i 1 for i in 2 N 1 , Dt Dt x N Ï‰â‚€^2 x N Ï‰â‚€^2 x N x N 1 md\"\"\" Now we create a dictionary that substitutes each `x i ` with `A i cos Ï‰ t `. This is used to apply the ansatz a trial solution for the oscillatory motion of the masses. This substitution assumes that each mass oscillates with a cosine function, where `A i ` gives the amplitude and Ï‰ is the angular frequency. \"\"\" subs ansatz Dict x i A i cos Ï‰ t for i in 1 N fma2 map fma do f f1 simplify expand derivatives substitute f, subs ansatz cos Ï‰ t end md\"\"\" Lets find \\Omega such that ```math \\Omega A 0. ``` \"\"\" subs A i Dict A j i j ? 1.0 0.0 for j in 1 N Î© hcat map 1 N do i substitute f, subs A i for f in fma2 end... Symbolics.scalarize collect Î© Î©det det collect Î© Î©det fn build function substitute Î©det, Ï‰â‚€ 1 , Ï‰, expression Val false roots filter x x 0, find zeros Î©det fn, 100,100 md\"Select the model to visualize bind imode Slider 1 length roots , show value true \" Î©1 map x getfield x, val , collect map Î© do om substitute om, Ï‰â‚€ 1.0, Ï‰ roots imode end A1 nullspace Î©1 points 0.2 A1 i cos roots imode tplot x, 0 for i,x in zip 1 N, range 1, stop 1, length N md\" Appendix\" md\"\"\" Plotting \"\"\" function plotmasses a, t \"\" p scatter first. a , last. a , c red, xlim 3,3 , ylim 2,2 , yaxis nothing, xlabel L\"x\", label nothing, size 500,200 , title t return p end plotmasses points, \"N N particles Mode imode t tplot\" tikz default options raw\"\"\" background rectangle .style fill white , show background rectangle, \"\"\" tikz preamble raw\"\"\" \\usepackage tikz \\usepackage tikz 3dplot \\usetikzlibrary fit, matrix, shapes.geometric \\tikzset % use tikzset, not tikzstyle cell .style rectangle, rounded corners 5pt, draw, \\tikzset % use tikzset, not tikzstyle cellv .style rectangle, rounded corners 5pt, draw, rotate 90, \\tikzstyle spring thick,decorate,decoration aspect 0.5, segment length 1mm, amplitude 2mm,coil \\usepackage xifthen \\usetikzlibrary hobby \\usepackage pgfplots \\usepackage fontawesome \\usepackage bm,amsfonts,amsmath \\usetikzlibrary backgrounds,pgfplots.groupplots,snakes \\usepgfplotslibrary patchplots \\pgfplotsset try min ticks 2 \\usepackage pgfplotstable \\usetikzlibrary plotmarks,positioning,spy \\usetikzlibrary shapes.geometric, arrows, fadings \\usepgfplotslibrary groupplots, polar \\usepackage space grffile \\usetikzlibrary % decorations.pathreplacing,% decorations.pathmorphing% \\usetikzlibrary positioning,fit,backgrounds \\usetikzlibrary shapes,arrows \\usetikzlibrary decorations.markings \\usetikzlibrary patterns \\usetikzlibrary plotmarks \\usetikzlibrary fit \\usetikzlibrary intersections \\usepgfplotslibrary fillbetween \\pgfplotsset axis line style black 10 , every axis label .append style black 10 , every axis title .append style black 10 , every tick label .append style black 10 % need for pgfplots \\newcommand \\axisz 0cm \\newcommand \\axisx 0cm \\usetikzlibrary positioning \\usetikzlibrary shapes.geometric \\usetikzlibrary backgrounds \"\"\" t1, t2, t3, tv are texts s1 and s2 are labels with sizes plot spring block x TikzPicture L\"\"\" \\draw thick 0,0 0,1 \\draw thick 0,0 3,0 node draw none,xshift 5pt \\tiny x \\node at 0,0.25 a draw none \\node at % x , 0.25 b minimum size 0.5cm,label \\rightarrow m \\draw spring a b node draw none,pos .5,right .25cm \\node at 2, 1 c draw none,yshift 5pt \\tiny x 0 \\draw dashed b.south c.north \"\"\", options tikz default options, preamble tikz preamble, width \"12cm\" plot spring block 2 "},{"url":"introduction/strain-tensor/","title":"Strain Tensor","tags":["introduction"],"text":" A Pluto.jl notebook v0.19.46 frontmatter order \"3\" title \"Strain Tensor\" tags \"introduction\" layout \"layout.jlhtml\" description \"Deformation of a 2 D square element\" using Markdown using InteractiveUtils This Pluto notebook uses bind for interactivity. When running this notebook outside of Pluto, the following 'mock version' of bind gives bound variables a default value instead of an error . macro bind def, element quote local iv try Base.loaded modules Base.PkgId Base.UUID \"6e696c72 6542 2067 7265 42206c756150\" , \"AbstractPlutoDingetjes\" .Bonds.initial value catch b missing end local el esc element global esc def Core.applicable Base.get, el ? Base.get el iv el el end end begin using LinearAlgebra using Plots using PlutoUI using LaTeXStrings using PlutoTeachingTools using PlutoUI using Symbolics using SymbolicUtils using Einsum using TikzPictures end TableOfContents md\"\"\" Strain Tensor This notebook demonstrates how a 2 D square element gets deformed by an input strain or spin tensor. Interactive Seismology Notebooks https pawbz.github.io Interactive Seismology.jl Instructor Pawan Bharadwaj , Indian Institute of Science, Bengaluru, India \"\"\" md\"\"\" The Jacobian matrix in two dimensions is given by ```math J \\begin bmatrix \\frac \\partial u x \\partial x & \\frac \\partial u x \\partial y \\\\ \\frac \\partial u y \\partial x & \\frac \\partial u y \\partial y \\end bmatrix ``` | | | | | | | \\frac \\partial u x \\partial x bind u11 Scrubbable 1 0.1 1, default 0.9 | \\frac \\partial u x \\partial y bind u12 Scrubbable 1 0.1 1 | | \\frac \\partial u y \\partial x bind u21 Scrubbable 1 0.1 1, default 0.4 | \\frac \\partial u y \\partial y bind u22 Scrubbable 1 0.1 1 | where u x and u y are components of displacements. Change the elements of the Jacobian matrix to deform an infinitesimal square element below. Furthermore, by Toeplitz decomposition, we can decompose the Jacobian as a sum of symmetric strain and skew symmetric rotation matrices. \"\"\" Jinput u11 u12 u21 u22 md\"\"\" Displacement Particle displacement is a function of space and time ```math ğ® ğ® ğ±, t . ``` Here, ğ± denotes the position the particle occupies at a reference time t 0, which means, a particle at position ğ± will be moved to position ğ® ğ±, t at time t. The particle velocity and particle acceleration are given by âˆ‚â‚œğ® and âˆ‚â‚œÂ²ğ®, respectively. \"\"\" variables xâ‚, xâ‚‚, xâ‚ƒ ğ± xâ‚, xâ‚‚, xâ‚ƒ syms uâ‚ xâ‚, xâ‚‚, xâ‚ƒ uâ‚‚ xâ‚, xâ‚‚, xâ‚ƒ uâ‚ƒ xâ‚, xâ‚‚, xâ‚ƒ ğ® uâ‚ xâ‚, xâ‚‚, xâ‚ƒ , uâ‚‚ xâ‚, xâ‚‚, xâ‚ƒ , uâ‚ƒ xâ‚, xâ‚‚, xâ‚ƒ md\"\"\" Distortion Distortion of the medium is liable to change in the relative position of the particles. In other words, they are related to the gradients of ğ®. \"\"\" âˆ‡ Symbolics.Differential. ğ± variables Î´xâ‚, Î´xâ‚‚, Î´xâ‚ƒ Î´ğ± Î´xâ‚, Î´xâ‚‚, Î´xâ‚ƒ einsum Î´ğ® i âˆ‡ j ğ® i Î´ğ± j ğ® Î´ğ® md\"\"\" Strain Tensor We use a strain tensor to analyze the distortion of the medium, whether it is solid or fluid, elastic or inelastic. \"\"\" Markdown.MD Markdown.Admonition \"warning\", \"Strain Rates\", md\"\"\" Geodetic measurements in Southern California indicate a relative plate motion is 2 to 7 cm per year. This translates to a strain rate of approximately 3\\times10^ 7 per year, compared to strain accumulation in the plate interiors that is less than 3\\times 10^ 8 per year an order of magnitude less . During large earthquakes, the shear strain change coseismic strain drop is in the order of 3\\times 10^ 4 . \"\"\" Markdown.MD Markdown.Admonition \"wg\", \"Basic Long term Earthquake Prediction\", md\"\"\" Division of coseismic strain drop by strain rate gives roughly the repeat times of major earthquakes, i.e., 100 1000 years on plate boundaries, and 1000 10000 years within plates. \"\"\" J âˆ‡ j ğ® i for i in 1 3, j in 1 3 Jt âˆ‡ i ğ® j for i in 1 3, j in 1 3 md\"Let's construct the strain tensor symmetric part via Teoplitz decomposition \" e 0.5 J Jt md\"residual spin tensor anti symmetric \" Î© J e e Î´ğ± Î© Î´ğ± md\" Principal Strains\" md\" Dilatation\" syms je1 je2 je Je je1 je je je2 syms jom Jom 0 jom jom 0 corners 0, 0 , 1, 0 , 1, 1 , 0, 1 new corners1 map corners do c Je c c end new corners2 map corners do c Jom c c end function calculate area corner vectors A corner vectors 1 B corner vectors 2 C corner vectors 3 D corner vectors 4 area 0.5 abs B 1 A 1 C 2 A 2 C 1 A 1 B 2 A 2 C 1 A 1 D 2 A 2 D 1 A 1 C 2 A 2 D 1 A 1 B 2 A 2 B 1 A 1 D 2 A 2 end calculate area new corners1 | simplify calculate area new corners2 | simplify md\" UI and Plotting\" einput 0.5 . Jinput transpose Jinput eeig eigen einput Î©input Jinput . einput md\"\"\" We shall now define the locations of a bunch of points on the square element xâˆˆ 0,1 , yâˆˆ 0,1 at the reference time t t 0 . Our objective is to understand how this square element is deformed by the action of the Jacobian. We do that by looking at the displacements of these reference locations. \"\"\" points x, y for x in range 0, stop 1, length 10 , y in range 0, stop 1, length 10 begin Jinput plot1 plotpoints points, \"Before Deformation\" plot2 plotpoints displace points, Jinput , \"Total Deformation\" plot3 plotpoints displace points, einput , \"Strain Deformation\" plot plot3, eeig.values 1 vcat 0.0 , first selectdim eeig.vectors, 2, 1 , eeig.values 1 vcat 0.0 , last selectdim eeig.vectors, 2, 1 , c blue, w 2, label nothing plot plot3, eeig.values 2 vcat 0.0 , first selectdim eeig.vectors, 2, 2 , vcat 0.0 , eeig.values 2 last selectdim eeig.vectors, 2, 2 , c blue, w 2, label \"Principal Strains\" p scatter first. a , last. a , c red, xlim 2,4 , ylim 2,4 , label nothing, size 500,500 , title t plot4 plotpoints displace points, Î©input , \"Spin Deformation\" plot plot1, plot2, plot3, plot4, layout 2, 2 end md\"\"\" Let us define the functions that we will be using in this notebook. \"\"\" \"\"\" Function to visualize the node points. Inputs are the locations of the points a and title t, optional \"\"\" function plotpoints a, t \"\" p scatter first. a , last. a , c red, xlim 2, 4 , ylim 2, 4 , label nothing, size 500, 500 , title t return p end \"\"\" Function to compute new locations by calculating the displacements given the reference locations a and the Jacobian J . \"\"\" function displace a, J return aa . J aa for aa in a end md\"\"\" Appendix \"\"\" md\" Tikz\" tikz default options raw\"\"\" background rectangle .style fill white , show background rectangle, \"\"\" tikz preamble raw\"\"\" \\usepackage tikz \\usepackage tikz 3dplot \\usetikzlibrary fit, matrix, shapes.geometric \\tikzset % use tikzset, not tikzstyle cell .style rectangle, rounded corners 5pt, draw, \\tikzset % use tikzset, not tikzstyle cellv .style rectangle, rounded corners 5pt, draw, rotate 90, \\usepackage xifthen \\usetikzlibrary hobby \\usepackage pgfplots \\usepackage fontawesome \\usepackage bm,amsfonts,amsmath \\usetikzlibrary backgrounds,pgfplots.groupplots,snakes \\usepgfplotslibrary patchplots \\pgfplotsset try min ticks 2 \\usepackage pgfplotstable \\usetikzlibrary plotmarks,positioning,spy \\usetikzlibrary shapes.geometric, arrows, fadings \\usepgfplotslibrary groupplots, polar \\usepackage space grffile \\usetikzlibrary % decorations.pathreplacing,% decorations.pathmorphing% \\usetikzlibrary positioning,fit,backgrounds \\usetikzlibrary shapes,arrows \\usetikzlibrary decorations.markings \\usetikzlibrary patterns \\usetikzlibrary plotmarks \\usetikzlibrary fit \\usetikzlibrary intersections \\usepgfplotslibrary fillbetween \\pgfplotsset axis line style black 10 , every axis label .append style black 10 , every axis title .append style black 10 , every tick label .append style black 10 % need for pgfplots \\newcommand \\axisz 0cm \\newcommand \\axisx 0cm \\usetikzlibrary positioning \\usetikzlibrary shapes.geometric \\usetikzlibrary backgrounds \"\"\" t1, t2, t3, tv are texts s1 and s2 are labels with sizes plot plane normal TikzPicture L\"\"\" \\tdplotsetmaincoords 105 30 \\tdplotsetrotatedcoords 00 30 0 \\begin scope tdplot rotated coords \\begin scope canvas is xy plane at z 0 \\fill gray,fill opacity 0.3 2, 3 rectangle 2,3 \\draw very thick 2,0 2,0 \\path 150 2 coordinate H 1.5,0 coordinate X \\pgflowlevelsynccm \\draw very thick, stealth,gray 0,0 30 1.5 \\end scope \\draw stealth H 1,0,0.2 node pos 1.3 H \\draw stealth X 0,1,0.2 node pos 1.3 X \\draw very thick, stealth 0,0,0 coordinate O 0,0,3 node right p \\end scope \\pgfmathsetmacro \\Radius 1.5 \\draw stealth O 2.5 \\Radius,0,0 node pos 1.15 spot 0 \\draw stealth O 0,3.5 \\Radius,0 node pos 1.15 spot 2 \\draw stealth O 0,0,2.5 \\Radius node pos 1.05 spot 1 \"\"\", options tikz default options, preamble tikz preamble, width \"12cm\" plot plane normal TikzPicture L\"\"\" \\tdplotsetmaincoords 60 125 \\tikzset cube .style very thick,black , grid .style very thin,gray , axis .style ,blue,thick , %draw a grid in the x y plane \\foreach \\x in 0.5,0,...,2.5 \\foreach \\y in 0.5,0,...,2.5 \\draw grid \\x, 0.5 \\x,2.5 \\draw grid 0.5,\\y 2.5,\\y %draw the axes \\draw axis 0,0,0 3,0,0 node anchor west x 1 \\draw axis 0,0,0 0,3,0 node anchor west x 2 \\draw axis 0,0,0 0,0,3 node anchor west x 3 %draw the top and bottom of the cube \\draw cube 0,0,0 0,2,0 2,2,0 2,0,0 cycle \\draw cube 0,0,2 0,2,2 2,2,2 2,0,2 cycle %draw the edges of the cube \\draw cube 0,0,0 0,0,2 \\draw cube 0,2,0 0,2,2 \\draw cube 2,0,0 2,0,2 \\draw cube 2,2,0 2,2,2 \"\"\", options tikz default options, preamble tikz preamble, width \"12cm\" "},{"url":"introduction/stress-tensor/","title":"Stress Tensor","tags":["introduction"],"text":" A Pluto.jl notebook v0.19.46 frontmatter order \"4\" title \"Stress Tensor\" tags \"introduction\" layout \"layout.jlhtml\" using Markdown using InteractiveUtils This Pluto notebook uses bind for interactivity. When running this notebook outside of Pluto, the following 'mock version' of bind gives bound variables a default value instead of an error . macro bind def, element quote local iv try Base.loaded modules Base.PkgId Base.UUID \"6e696c72 6542 2067 7265 42206c756150\" , \"AbstractPlutoDingetjes\" .Bonds.initial value catch b missing end local el esc element global esc def Core.applicable Base.get, el ? Base.get el iv el el end end begin using LinearAlgebra using PlutoUI using LaTeXStrings using PlutoTeachingTools using PlutoUI using Symbolics using SymbolicUtils using Einsum using PlutoPlotly using TikzPictures end ChooseDisplayMode TableOfContents md\"\"\" Stress Tensor Interactive Seismology Notebooks https pawbz.github.io Interactive Seismology.jl Instructor Pawan Bharadwaj , Indian Institute of Science, Bengaluru, India \"\"\" md\"\"\" The stress tensor three dimensions is given by ```math \\sigma \\begin bmatrix \\sigma 11 & \\sigma 12 & \\sigma 13 \\\\ \\sigma 12 & \\sigma 22 & \\sigma 23 \\\\ \\sigma 13 & \\sigma 23 & \\sigma 33 \\\\ \\end bmatrix ``` | | | | | | | | | Ïƒ 11 bind Ïƒ11 Scrubbable 1 0.01 1, default 1 | Ïƒ 22 bind Ïƒ22 Scrubbable 1 0.1 1, default 0 | Ïƒ 33 bind Ïƒ33 Scrubbable 1 0.1 1, default 0.5 | | Ïƒ 12 bind Ïƒ12 Scrubbable 1 0.1 1, default 0.5 | Ïƒ 23 bind Ïƒ23 Scrubbable 1 0.1 1, default 0 | Ïƒ 13 bind Ïƒ13 Scrubbable 1 0.1 1, default 0 | which is symmetric. \"\"\" bind resample normal CounterButton \"Resample Imaginary Plane\" md\" UI and Plotting\" md\"\"\" Let us define the functions that we will be using in this notebook. \"\"\" Ïƒinput let Ïƒ11 Ïƒ12 Ïƒ13 Ïƒ12 Ïƒ22 Ïƒ23 Ïƒ13 Ïƒ23 Ïƒ33 end eigsigma eigen Ïƒinput nsample let resample normal n randn 3 n n . sqrt sum abs2, n end Tinput Ïƒinput nsample function plot3lines 1 v, color, name p1 scatter3d x 0, v 1 , y 0, 0 , z 0, 0 , mode \"lines\", name name, line attr color color , p2 scatter3d x 0, 0 , y 0, v 2 , z 0, 0 , mode \"lines\", name name, line attr color color , p3 scatter3d x 0, 0 , y 0, 0 , z 0, v 3 , mode \"lines\", name name, line attr color color , return p1, p2, p3 end function plot3lines 2 v1,v2,v3, color, name p1 scatter3d x 0, v1 1 , y 0, v1 2 , z 0, v1 3 , mode \"lines\", name name, line attr color color , p2 scatter3d x 0, v2 1 , y 0, v2 2 , z 0, v2 3 , mode \"lines\", name name, line attr color color , p3 scatter3d x 0, v3 1 , y 0, v3 2 , z 0, v3 3 , mode \"lines\", name name, line attr color color , return p1, p2, p3 end function stress plot p1 cone x 0 , y 0 , z 0 , u nsample 1 , v nsample 2 , w nsample 3 , name \"Surface Normal\", hoverinfo \"name\", showscale false, opacity 0.5, anchor \"tail\", color \"black\", colorscale colors.Blues 8, sizeref 0.5 p2 scatter3d x 0, nsample 1 , y 0, nsample 2 , z 0, nsample 3 , mode \"lines\", name \"Normal Vector\", line attr color \"gray\" , p3 plot3lines 1 Tinput, \"red\", \"Traction\" p4 plot3lines 2 collect eachcol eigsigma.vectors . eigsigma.values ..., \"blue\", \"Principal\" layout Layout scene camera eye attr x 0, y 0, z 0 , width 600, height 500, uirevision 1, scene attr xaxis attr nticks 10, range 1,1 , yaxis attr nticks 10, range 1,1 , zaxis attr nticks 10, range 1,1 , , return plot p1, p2, p3..., p4... , layout end stress plot variables Ïƒ 1 3, 1 3 Ïƒ 3 Symbolics.scalarize Ïƒ 0,0,1 variables n 1 3 einsum aa i Ïƒ i, j f j md\"\"\" Appendix \"\"\" md\" Tikz\" tikz default options raw\"\"\" background rectangle .style fill white , show background rectangle, \"\"\" tikz preamble raw\"\"\" \\usepackage tikz \\usepackage tikz 3dplot \\usetikzlibrary fit, matrix, shapes.geometric \\tikzset % use tikzset, not tikzstyle cell .style rectangle, rounded corners 5pt, draw, \\tikzset % use tikzset, not tikzstyle cellv .style rectangle, rounded corners 5pt, draw, rotate 90, \\usepackage xifthen \\usetikzlibrary hobby \\usepackage pgfplots \\usepackage fontawesome \\usepackage bm,amsfonts,amsmath \\usetikzlibrary backgrounds,pgfplots.groupplots,snakes \\usepgfplotslibrary patchplots \\pgfplotsset try min ticks 2 \\usepackage pgfplotstable \\usetikzlibrary plotmarks,positioning,spy \\usetikzlibrary shapes.geometric, arrows, fadings \\usepgfplotslibrary groupplots, polar \\usepackage space grffile \\usetikzlibrary % decorations.pathreplacing,% decorations.pathmorphing% \\usetikzlibrary positioning,fit,backgrounds \\usetikzlibrary shapes,arrows \\usetikzlibrary decorations.markings \\usetikzlibrary patterns \\usetikzlibrary plotmarks \\usetikzlibrary fit \\usetikzlibrary intersections \\usepgfplotslibrary fillbetween \\pgfplotsset axis line style black 10 , every axis label .append style black 10 , every axis title .append style black 10 , every tick label .append style black 10 % need for pgfplots \\newcommand \\axisz 0cm \\newcommand \\axisx 0cm \\usetikzlibrary positioning \\usetikzlibrary shapes.geometric \\usetikzlibrary backgrounds \"\"\" t1, t2, t3, tv are texts s1 and s2 are labels with sizes plot plane normal TikzPicture L\"\"\" \\tdplotsetmaincoords 105 30 \\tdplotsetrotatedcoords 00 30 0 \\begin scope tdplot rotated coords \\begin scope canvas is xy plane at z 0 \\fill gray,fill opacity 0.3 2, 3 rectangle 2,3 \\draw very thick 2,0 2,0 \\path 150 2 coordinate H 1.5,0 coordinate X \\pgflowlevelsynccm \\draw very thick, stealth,gray 0,0 30 1.5 \\end scope \\draw stealth H 1,0,0.2 node pos 1.3 H \\draw stealth X 0,1,0.2 node pos 1.3 X \\draw very thick, stealth 0,0,0 coordinate O 0,0,3 node right p \\end scope \\pgfmathsetmacro \\Radius 1.5 \\draw stealth O 2.5 \\Radius,0,0 node pos 1.15 spot 0 \\draw stealth O 0,3.5 \\Radius,0 node pos 1.15 spot 2 \\draw stealth O 0,0,2.5 \\Radius node pos 1.05 spot 1 \"\"\", options tikz default options, preamble tikz preamble, width \"12cm\" plot plane normal TikzPicture L\"\"\" \\tdplotsetmaincoords 60 125 \\tikzset cube .style very thick,black , grid .style very thin,gray , axis .style ,blue,thick , %draw a grid in the x y plane \\foreach \\x in 0.5,0,...,2.5 \\foreach \\y in 0.5,0,...,2.5 \\draw grid \\x, 0.5 \\x,2.5 \\draw grid 0.5,\\y 2.5,\\y %draw the axes \\draw axis 0,0,0 3,0,0 node anchor west x 1 \\draw axis 0,0,0 0,3,0 node anchor west x 2 \\draw axis 0,0,0 0,0,3 node anchor west x 3 %draw the top and bottom of the cube \\draw cube 0,0,0 0,2,0 2,2,0 2,0,0 cycle \\draw cube 0,0,2 0,2,2 2,2,2 2,0,2 cycle %draw the edges of the cube \\draw cube 0,0,0 0,0,2 \\draw cube 0,2,0 0,2,2 \\draw cube 2,0,0 2,0,2 \\draw cube 2,2,0 2,2,2 \"\"\", options tikz default options, preamble tikz preamble, width \"12cm\" begin Define the normal vector normal vector 0.0, 0.577, 0.07 Calculate two vectors perpendicular to the normal vector using Gram Schmidt process u normal vector 2 , normal vector 1 , 0 v cross normal vector, u Normalize the perpendicular vectors u u norm u v v norm v Define the plane points a 1.0 Half the side length of the plane plane points a u a v, a u a v, a u a v, a u a v Create a grid of points for the surface x range a 0.1 a y range a 0.1 a z plane x, y normal vector 1 x normal vector 2 y normal vector 3 x grid, y grid x for x in x range, y in y range , y for x in x range, y in y range z grid z plane x, y for x in x range, y in y range end plot scatter3d x x, y y, z z, mode \"lines\", name \"Plane\" , scatter3d x 0, normal vector 1 , y 0, normal vector 2 , z 0, normal vector 3 , mode \"lines markers\", name \"Normal Vector\", line attr color \"red\" plot scatter3d x x, y y, z z, mode \"lines\", name \"Plane\" TikzPicture L\"\"\" % Define the unit normal vector \\def\\nx 0.5 % x component of the normal vector \\def\\ny 0.5 % y component of the normal vector \\def\\nz 0.5 % z component of the normal vector % Define the plane equation ax by cz d \\def\\d 1 % Distance from the origin % Calculate the vertices of the small plane \\pgfmathsetmacro \\a 0.5 % Half the side length of the small plane % Calculate two vectors perpendicular to the normal vector using Gram Schmidt process \\pgfmathsetmacro \\ux \\ny \\pgfmathsetmacro \\uy \\nx \\pgfmathsetmacro \\uz 0 \\pgfmathsetmacro \\vx \\nx \\nz \\pgfmathsetmacro \\vy \\ny \\nz \\pgfmathsetmacro \\vz \\nx^2 \\ny^2 % Normalize the perpendicular vectors \\pgfmathsetmacro \\ulen sqrt \\ux \\ux \\uy \\uy \\uz \\uz \\pgfmathsetmacro \\vlen sqrt \\vx \\vx \\vy \\vy \\vz \\vz \\pgfmathsetmacro \\ux \\ux \\ulen \\pgfmathsetmacro \\uy \\uy \\ulen \\pgfmathsetmacro \\uz \\uz \\ulen \\pgfmathsetmacro \\vx \\vx \\vlen \\pgfmathsetmacro \\vy \\vy \\vlen \\pgfmathsetmacro \\vz \\vz \\vlen % Draw the coordinate axes \\draw 0,0,0 3,0,0 node anchor north east x \\draw 0,0,0 0,3,0 node anchor north west y \\draw 0,0,0 0,0,3 node anchor south z % Draw the small plane \\filldraw opacity 0.5 \\a \\ux , \\a \\uy , \\a \\uz \\a \\vx , \\a \\vy , \\a \\vz \\a \\ux , \\a \\uy , \\a \\uz \\a \\vx , \\a \\vy , \\a \\vz cycle % Draw the normal vector \\draw , thick, color red 0,0,0 \\nx,\\ny,\\nz \\node at \\nx,\\ny,\\nz anchor south west \\vec n \"\"\", options tikz default options, preamble tikz preamble, width \"12cm\" "},{"url":"introduction/waves-on-string/","title":"Waves On A String","tags":["introduction"],"text":" A Pluto.jl notebook v0.19.46 frontmatter title \"Waves On A String\" tags \"introduction\" layout \"layout.jlhtml\" description \"Simulates wave propagation on a string\" using Markdown using InteractiveUtils This Pluto notebook uses bind for interactivity. When running this notebook outside of Pluto, the following 'mock version' of bind gives bound variables a default value instead of an error . macro bind def, element quote local iv try Base.loaded modules Base.PkgId Base.UUID \"6e696c72 6542 2067 7265 42206c756150\" , \"AbstractPlutoDingetjes\" .Bonds.initial value catch b missing end local el esc element global esc def Core.applicable Base.get, el ? Base.get el iv el el end end begin using FFTW, PlutoPlotly, PlutoUI, LinearAlgebra using ParallelStencil using ParallelStencil.FiniteDifferences1D using Printf, Statistics end TableOfContents md\"\"\" Waves On A String This notebook simulates wave propagation on a string using parallel computing techniques. The core function, `model string`, initializes the simulation environment and defines two parallel functions `compute vy ` and `compute Ïƒ `, which update the velocity and stress fields, respectively. The simulation parameters include the shear modulus `Î¼0` , density `Ï0` , spatial grid `xgrid` , and temporal grid tgrid . The notebook sets up the numerical grid, allocates arrays for stress `Ïƒ` and velocity `vy` , and initializes the velocity field with a Gaussian distribution. The medium's properties are heterogeneous, with boundary marked by the red line. Interactive Seismology Notebooks https pawbz.github.io Interactive Seismology.jl Instructor Pawan Bharadwaj , Indian Institute of Science, Bengaluru, India \"\"\" md\" Medium\" begin nx 1000 xgrid range 100, 100, length nx end Ï0 Float32 3.22 10^ 3 10^15 density in kg km3 Î¼0 Float32 82 10^9 10^3 invÏ0 inv Ï0 invÎ¼0 inv Î¼0 medium ref values Î¼0, invÎ¼0, Ï0, invÏ0 vs0 sqrt. Î¼0 . Ï0 begin courant number 0.1 lets calculate the min distance from the center to the edge of the domain r min xgrid end xgrid 1 0.5 choose time stepping dt to satisfy Courant condition dt courant number step xgrid inv vs0 nt Int floor r vs0 dt 2 tgrid range 0, length nt, step dt nothing end md\"\"\"Time bind T Slider tgrid, show value true Interface Position bind X Slider xgrid, show value true, default 0 \"\"\" md\" Governing Equations\" md\"\"\" Velocity v y and Stress \\sigma ```math \\rho\\,\\partial t v y \\partial x \\sigma \\quad 1 ``` and ```math \\partial t \\sigma \\mu\\partial x v y \\quad 2 ``` \"\"\" md\"\"\" Simulation \"\"\" views function model string Î¼0, Ï0, xgrid, tgrid, X init parallel stencil Threads, Float32, 1 parallel function compute vy vy Data.Array, Ïƒ Data.Array, dt Data.Number, Ï Data.Array, dx Data.Number inn vy inn vy dt all Ï d Ïƒ dx return end parallel function compute Ïƒ Ïƒ Data.Array, vy Data.Array, dt Data.Number, Î¼ Data.Array, dx Data.Number all Ïƒ all Ïƒ dt all Î¼ d vy dx return end Derived numerics nx length xgrid numerical grid resolution should be a mulitple of 32 1 for optimal GPU perf nt length tgrid number of timesteps dx Float32 step xgrid cell size dt Float32 step tgrid Array allocations Ïƒ zeros nx 1 vy zeros nx Initial conditions vy initial exp. 0.11 . xgrid . 50 .^ 2 copyto vy, vy initial Medium Î¼ zeros nx 1 fill Î¼, Float32 Î¼0 Ï zeros nx fill Ï, Float32 Ï0 perturb density of the string iX argmin abs. xgrid . X Ï1 view Ï, 1 iX rmul Ï1, 4.0f0 vysave zeros nx 1, nt Time loop for it 1 nt parallel compute Ïƒ Ïƒ, vy, dt, Î¼, dx parallel compute vy vy, Ïƒ, dt, Ï, dx save vy vys view vysave, , it copyto vys, vy end return vysave end vy save model string Î¼0, Ï0, xgrid, tgrid, X md\" Appendix\" md\" Plot\" default plotly template plotly dark function plot string vy save, X, T iT argmin abs. tgrid . T fig Plot scatter x xgrid, y vy save , iT , Layout title \"String's vertical displacement at round T, digits 2 s, with interface at round X, digits 2 km\", width 700, height 300, xaxis attr title \"Distance\" , yaxis attr title \"Amplitude\", range 1.2, 1.2 add vline fig, X, line color \"red\", opacity 1, layer \"below\", line width 2, add vline fig, xgrid 1 , line color \"white\", opacity 1, layer \"below\", line width 2, add vline fig, xgrid end , line color \"white\", opacity 1, layer \"below\", line width 2, plot fig end plot string vy save, X, T "},{"url":"planewaves/boundary-conditions/","title":"Boundary Conditions","tags":[],"text":" A Pluto.jl notebook v0.19.46 frontmatter layout \"layout.jlhtml\" title \"Boundary Conditions\" description \"Boundary conditions at an interface between two different media\" using Markdown using InteractiveUtils This Pluto notebook uses bind for interactivity. When running this notebook outside of Pluto, the following 'mock version' of bind gives bound variables a default value instead of an error . macro bind def, element quote local iv try Base.loaded modules Base.PkgId Base.UUID \"6e696c72 6542 2067 7265 42206c756150\" , \"AbstractPlutoDingetjes\" .Bonds.initial value catch b missing end local el esc element global esc def Core.applicable Base.get, el ? Base.get el iv el el end end begin using PlutoUI using PlutoTeachingTools using Symbolics using SymbolicUtils using LinearAlgebra end TableOfContents md\"\"\" Boundary Conditions These conditions determine the relationship between the displacements and tractions across an interface between two media. Here, we consider different interfaces, whose unit normal vector is denoted using `n`. For a given location on the interface, we use `ÏƒÂ¹` to denote the stress tensor just above the interface and `ÏƒÂ²` to denote the stress tensor just below the interface. Similarly, we use `uÂ¹` and `uÂ²` to denote displacements above and below the interface, respectively. In seismology, we often encounter three types of interfaces. Solid Solid Welded Interface Solid Liquid Solid Vaccum Free Interface Interactive Seismology Notebooks https pawbz.github.io Interactive Seismology.jl Instructor Pawan Bharadwaj , Indian Institute of Science, Bengaluru, India \"\"\" variables uÂ¹ 1 3 uÂ² 1 3 displacement vectors variables ÏƒÂ¹ 1 3,1 3 ÏƒÂ² 1 3,1 3 stress tensors md\"Select `n` for the rest of the notebook bind n Select 1,0, 0 , 0, 1, 0 , 1 sqrt 2 , 1 sqrt 2 , 0 , 0, 0, 1 , default 0,0,1 \" md\"\"\" Solid Solid Consider a welded interface between two media, where none of the springs connecting particles of one medium to another medium are \"broken\". \"\"\" md\"\"\" Kinematic conditions A welded interface means that all components of the displacement field are continuous across the boundary. \"\"\" collect uÂ¹ ~ collect uÂ² md\"\"\" Dynamic conditions These are derived considering a Gaussian pillbox intersecting the interface with negligible volume. It can be shown that this pillbox can have zero acceleration only when the traction on the interface is continuous across the interface. \"\"\" collect ÏƒÂ¹ n ~ collect ÏƒÂ² n md\"\"\" Solid Fluid Unlike the welded interface, some of the springs are \"broken\". This means that particles can slide tangentially to the interface, and fluid particles cannot apply shear forces on the solid particles. Assume medium with index `1` to be fluid. \"\"\" md\"\"\" Kinematic conditions The normal components of the displacement field are continuous, while the rest of the components can be discontinuous due to sliding. \"\"\" dot uÂ¹, n ~ dot uÂ², n md\"\"\" Dynamic conditions The components of the traction tangential to the interface are zero, whereas the normal components of the traction are continuous. \"\"\" dot collect ÏƒÂ¹ n , n ~ dot collect ÏƒÂ² n , n collect ÏƒÂ² n dot collect ÏƒÂ² n , n n ~ 0 vector rejection dot n, collect ÏƒÂ² n dot collect ÏƒÂ² n , n n md\"\"\" Solid Vacuum The vacuum has no particles to apply forces on the solid particles. The solid particle displacement is unconstrained. Taking medium with index `2` to be solid, dynamic conditions require the traction vector corresponding to interface to be zero. \"\"\" md\"\"\" Dynamic conditions \"\"\" collect ÏƒÂ² n ~ 0 "},{"url":"planewaves/reflection-P-SV-free-surface/","title":"P-SV Free-surface Reflection","tags":[],"text":" A Pluto.jl notebook v0.19.46 frontmatter title \"P SV Free surface Reflection\" layout \"layout.jlhtml\" description \"In this notebook, we shall investigate the interaction of plane P waves with Earth's free surface. \" using Markdown using InteractiveUtils This Pluto notebook uses bind for interactivity. When running this notebook outside of Pluto, the following 'mock version' of bind gives bound variables a default value instead of an error . macro bind def, element quote local iv try Base.loaded modules Base.PkgId Base.UUID \"6e696c72 6542 2067 7265 42206c756150\" , \"AbstractPlutoDingetjes\" .Bonds.initial value catch b missing end local el esc element global esc def Core.applicable Base.get, el ? Base.get el iv el el end end begin using Symbolics using PlutoPlotly using SymbolicUtils using LinearAlgebra using Latexify using LaTeXStrings using PlutoUI using PlutoTeachingTools end ChooseDisplayMode TableOfContents md\"\"\" P SV Free surface Reflection In this notebook, we will delve into the analysis of the reflection coefficients of P and S waves at a free surface, which is a solid vacuum boundary. By assuming a free surface at \\ z 0 \\ , we will apply stress free boundary conditions to derive the expressions for the reflection coefficients of both P and S waves. This analysis is crucial for understanding the behavior of seismic waves as they interact with the Earth's surface. Interactive Seismology Notebooks https pawbz.github.io Interactive Seismology.jl Instructor Pawan Bharadwaj , Indian Institute of Science, Bengaluru, India \"\"\" md\"\"\" bind tplot Clock 0.1 \"\"\" Markdown.MD Markdown.Admonition \"observe\", \"Observations\", md\"\"\" The angle of reflection of the S wave is always less than that of the P reflected wave. This is because the vertical slowness of the S reflected wave Î· Î² is always greater than that of the P reflected wave. The wavenumber of the S reflected wave is higher than that of the P wave. The wavenumber of the S reflected wave increases as Î² becomes smaller compared to Î± . When Î² is very small, the amplitude of the S reflected wave is negligible. A negative reflection coefficient indicates a phase change of the reflected wave by Ï€. The P reflection coefficient and S reflection coefficient follow the conservation of energy. The P reflection coefficient is maximum when the S reflection coefficient is minimum. \"\"\" md\"Spatial coordinates, time, and angular frequency.\" syms x Real z Real Ï‰ Real t Real syms Ä± Complex Real imaginary unit, going to substitute with im later md\"Differential operators.\" begin Dx Differential x Dz Differential z end md\"In 2D, a harmonic plane wave with an frequency `Ï‰`, amplitude `A`, horizontal slowness `p` and vertical slowness `Î·` is defined below.\" plane p, Î·, A A exp Ä± Ï‰ t p x Î· z md\"The horizontal slowness i.e., the ray parameter is denoted using p .\" md\"The vertical component of the slowness vector in the first and second layer are denoted using \\eta and \\eta t . These plane waves satisfy the scalar wave equation only if the dispersion relation ```math p^2 Î·^2 \\frac 1 Î²^2 ``` is satisfied.\" syms A Aâ‚ Aâ‚‚ syms p Real syms Î·â‚ Î·â‚‚ md\"\"\" Potentials Incident P wave, Reflected P wave and Reflected SV wave For the P SV system on a free surface, all the waves are traveling in the same medium. The velocity of the P wave is denoted by Î± and the velocity of the S wave is denoted by Î² . The plane waves representing potentials share the same horizontal slowness p . Now, we create an incident wave using the `plane` function with parameters `p`, `Î·â‚`, and `A`, representing the horizontal slowness, verticle slowness, and amplitude, respectively. Then, two reflected waves, `reflect1` and `reflect2`, are also defined using the `plane` function. The first reflected wave, `reflect1`, uses the parameters `p`, ` Î·â‚`, and `Aâ‚`, indicating a reflection with opposite vertical slowness and a different amplitude. Similarly, the second reflected wave, `reflect2`, is defined with `p`, ` Î·â‚‚`, and `Aâ‚‚`, representing another reflection with a different vertical slowness and amplitude. This setup models the behavior of P and S incident and reflected waves at a free surface. \"\"\" incident plane p, Î·â‚, A reflect1 plane p, Î·â‚, Aâ‚ reflect2 plane p, Î·â‚‚, Aâ‚‚ md\"\"\" Particle Displacements We now write expressions for particle displacements given plane wave potentials. Depending on whether the incident wave is P or S, these expressions change. \"\"\" md\"\"\" Free surface Condition At the free surface i.e. z 0 , kinematic boundary condition does not exist. We have two dynamic boundary conditions Ïƒ zz 0 and Ïƒ xz 0 and two unknowns A 1 , A 2 to estimate when assuming A 1 . \"\"\" syms Î» Real Î¼ Real md\" Example\" md\"\"\" We shall begin defining a function that computes the ray parameter, given the angle of incidence Î¸ . \"\"\" syms Î¸ Real md\"We now compute the vertical component of the slowness vector for both the reflected waves using the dispersion relation.\" md\"\"\" We can finally update the expressions of reflection coefficients using input parameters and plot them. \"\"\" md\" Appendix\" md\"\"\" Lets print the expression of the wavefield, plotted in the previous example. \"\"\" warning box md\"\"\" The sign of the vertical slowness in the transmitted field above is chosen to prevent the exponential growth of the wavefield away from the boundary. \"\"\" default plotly template plotly dark Î¸grid range 0, stop pi 2, length 100 need for reflectance plots md\"\"\" It is evident that the reflection coefficients depend on the velocities of the P and S waves. By selecting whether the incident wave is a P or S wave, the reflection coefficients will vary accordingly. Î± km sec bind Î±in NumberField range 2.0, stop 6.0, step 0.1 , default 3.9 Î² km sec bind Î²in NumberField range 2.0, stop 6.0, step 0.1 , default 2.0 Ï gm cmÂ³ bind Ïin NumberField range 2.0, stop 6.0, step 0.1 , default 2.9 Incident Wavefield bind incident waves Select \"P\", \"S\" , default \"P\" with Angle of incidence âˆˆ 0, Ï€ 2 bind Î¸p Slider Î¸grid, default 1.4 and Angular frequency bind Ï‰p Slider range 0.1, stop 2, length 10 , show value true, default 0.3 \"\"\" begin if incident waves \"P\" UxInc expand derivatives. Dx. incident UzInc expand derivatives. Dz. incident else UxInc expand derivatives. Dz. incident UzInc expand derivatives. Dz. incident end end Ïƒzz incident expand derivatives. Î» . Dx. UxInc . Î» . Dz. UzInc expand derivatives. 2 . Î¼ . Dz. UzInc Ïƒxz incident expand derivatives. Î¼ . Dx. UzInc . Î¼ . Dz. UxInc begin if incident waves \"P\" UxRef1 expand derivatives. Dx. reflect1 UzRef1 expand derivatives. Dz. reflect1 else UxRef1 expand derivatives. Dz. reflect1 UzRef1 expand derivatives. Dx. reflect1 end end Ïƒzz reflect1 expand derivatives. Î» . Dx. UxRef1 . Î» . Dz. UzRef1 expand derivatives. 2 . Î¼ . Dz. UzRef1 Ïƒxz reflect1 expand derivatives. Î¼ . Dx. UzRef1 . Î¼ . Dz. UxRef1 begin if incident waves \"P\" UxRef2 expand derivatives. Dz. reflect2 UzRef2 expand derivatives. Dx. reflect2 else UxRef2 expand derivatives. Dx. reflect2 UzRef2 expand derivatives. Dz. reflect2 end end Ïƒzz reflect2 expand derivatives. Î» . Dx. UxRef2 . Î» . Dz. UzRef2 expand derivatives. 2 . Î¼ . Dz. UzRef2 Ïƒzz z0 substitute. Ïƒzz incident . Ïƒzz reflect1 . Ïƒzz reflect2, z 0 .~ 0 Ïƒzz simplify substitute Ïƒzz z0, Dict A 1, t 0, x 0 Ïƒxz reflect2 expand derivatives. Î¼ . Dx. UzRef2 . Î¼ . Dz. UxRef2 Ïƒxz z0 substitute. Ïƒxz incident . Ïƒxz reflect1 . Ïƒxz reflect2, z 0 .~ 0 Ïƒxz simplify substitute Ïƒxz z0, Dict A 1, t 0, x 0 sol simplify. Symbolics.symbolic linear solve Ïƒzz, Ïƒxz , Aâ‚, Aâ‚‚ begin reflected waves1 incident waves reflected waves2 filter x x â‰  incident waves, \"P\", \"S\" 1 end md\"\"\" bind plot waves MultiCheckBox \"i\" \"Incident incident waves \", \"r1\" \"Reflected reflected waves1 \", \"r2\" \"Reflected reflected waves2 \" , default \"i\", \"r1\", \"r2\" \"\"\" rp Î¸ incident waves \"P\" ? sin Î¸ Î±in sin Î¸ Î²in Î·z1 Î¸ incident waves \"P\" ? sqrt inv Î±in ^2 rp Î¸ ^2 0im sqrt inv Î²in ^2 rp Î¸ ^2 0im Î·z1 45 Î·z2 Î¸ incident waves \"S\" ? sqrt inv Î±in ^2 rp Î¸ ^2 0im sqrt inv Î²in ^2 rp Î¸ ^2 0im Î·z2 45 begin Avec broadcast sol 1 , sol 2 do x Î¸ simplify substitute x, Î·â‚ Î·z1 Î¸ , Î·â‚‚ Î·z2 Î¸ , p rp Î¸ , Î» Ïin Î±in^2 2 Î²in^2 , Î¼ Î²in^2 Ïin end if incident waves \"S\" Avec reverse Avec end end u incident ex substitute plane rp Î¸p , Î·z1 Î¸p , 1.0 , Ï‰ Ï‰p, Ä± im u reflected1 ex substitute plane rp Î¸p , Î·z1 Î¸p , Avec 1 Î¸p , Ï‰ Ï‰p, Ä± im u reflected2 ex substitute plane rp Î¸p , isequal imag Î·z2 Î¸p , 0.0 ? Î·z2 Î¸p Î·z2 Î¸p , Avec 2 Î¸p , Ï‰ Ï‰p, Ä± im md\" Plots\" function plot reflectivity A, Î¸grid, title \"\" degÎ¸ rad2deg. Î¸grid fig Plot Layout title title, polar attr angularaxis direction \"clockwise\", sector 0, 90 , radialaxis range 2, 2 , add trace fig, scatterpolar r abs. A. Î¸grid , theta degÎ¸, mode \"lines\", name \"Abs\" add trace fig, scatterpolar r real. A. Î¸grid , theta degÎ¸, mode \"lines\", name \"Real\" add trace fig, scatterpolar r imag. A. Î¸grid , theta degÎ¸, mode \"lines\", name \"Imag\" add trace fig, barpolar r 3.5, , theta rad2deg Î¸p , width 2 , name \"Animation\", marker color \" E4FF87\" , marker line color \"black\", marker line width 1, opacity 0.5 , relayout fig, height 300, width 350, PlutoPlotly.plot fig end TwoColumn md\"\"\" plot reflectivity Avec 1 , Î¸grid, \"P Reflection Coefficient\" \"\"\", md\"\"\" plot reflectivity Avec 2 , Î¸grid, \"S Reflection Coefficient\" \"\"\" function plot planewave ui, ur1, ur2, t1 0 we need to discretize space before plotting xgrid range 200, stop 200, length 200 zgrid bottom range 0, stop 200, length 100 zgrid top range 200, stop 0, length 100 substitute imaginary unit ui, ur1, ur2 map ui, ur1, ur2 do â‹… substitute â‹…, Ä± im end build functions reflected and incident uip, ur1p, ur2p map ui, ur1, ur2 do â‹… fn build function â‹…, x, z, t, expression Val false real fn x, z, t1 for z in zgrid top, x in xgrid end utp let fn build function ut, x, z, t, expression Val false real fn x, z, t1 for z in zgrid top, x in xgrid end \"r2\" âˆ‰ plot waves && fill ur2p, 0.0 \"i\" âˆ‰ plot waves && fill uip, 0.0 \"r1\" âˆ‰ plot waves && fill ur1p, 0.0 U cat ur1p uip ur2p, dims 1 cmax max maximum abs, U , maximum abs, U fig Plot Layout yaxis attr scaleanchor \"x\" , width 350, height 350, uirevison 1, dragmode \"drawopenpath\", newshape line color \"black\", title \"P SV Wavefield\", shapes line xref \"x\", yref \"y\", x0 200, y0 0, x1 200, y1 0, line attr color \"yellow\", width 3, , , , config PlotConfig displayModeBar false add trace fig, PlutoPlotly.heatmap z U, x xgrid, y vcat zgrid top, zgrid bottom , colorscale \"seismic\", zmin cmax, zmax cmax, add trace fig, scatter x 100 , y 20 , text \"Free surface\" , mode \"text\", showlegend false, textfont attr color \"yellow\", size 15, family \"Arail\", add trace fig, scatter x 150, 150 , y 150, 150 , text \" Î²â‚,Ïâ‚ \", \" Î²â‚‚,Ïâ‚‚ \" , mode \"text\", showlegend false, textfont attr color \"yellow\", size 15, family \"Arail\", plot fig end plot planewave u incident ex, u reflected1 ex, u reflected2 ex, mod tplot, 10 "},{"url":"planewaves/reflection-transmission-SH/","title":"Reflected and Transmitted SH Waves","tags":["planewaves"],"text":" A Pluto.jl notebook v0.19.46 frontmatter title \"Reflected and Transmitted SH Waves\" tags \"planewaves\" layout \"layout.jlhtml\" description \"In this notebook, we shall investigate the behavior of waves that love to hop between two geological layers like kids in a bouncy castle.\" using Markdown using InteractiveUtils This Pluto notebook uses bind for interactivity. When running this notebook outside of Pluto, the following 'mock version' of bind gives bound variables a default value instead of an error . macro bind def, element quote local iv try Base.loaded modules Base.PkgId Base.UUID \"6e696c72 6542 2067 7265 42206c756150\" , \"AbstractPlutoDingetjes\" .Bonds.initial value catch b missing end local el esc element global esc def Core.applicable Base.get, el ? Base.get el iv el el end end begin using Symbolics using PlutoPlotly using SymbolicUtils using LinearAlgebra using Latexify using LaTeXStrings using PlutoUI using PlutoTeachingTools end TableOfContents md\"\"\" SH Reflection & Transmission Coefficients In this notebook, we analyze the amplitudes of reflected and transmitted plane waves at the interface between two geological layers. Assuming a horizontal interface at z 0 , we use boundary conditions to derive expressions for the reflected and transmitted amplitudes. For simplicity, we focus on shear horizontal SH waves. Interactive Seismology Notebooks https pawbz.github.io Interactive Seismology.jl Instructor Pawan Bharadwaj , Indian Institute of Science, Bengaluru, India \"\"\" md\"\"\" bind tplot Clock 0.1 \"\"\" md\"Spatial coordinates, time, and angular frequency.\" syms x Real z Real Ï‰ Real t Real syms Ä± Complex Real imaginary unit, going to substitute with im later md\"Differential operators.\" begin Dx Differential x Dz Differential z end md\"In 2D, a harmonic plane wave with an frequency `Ï‰`, amplitude `A`, horizontal slowness `p` and vertical slowness `Î·` is defined below.\" plane p, Î·, A A exp Ä± Ï‰ t p x Î· z md\"The horizontal slowness i.e., the ray parameter is denoted using p .\" md\"The vertical component of the slowness vector in the first and second layer are denoted using \\eta and \\eta t . These plane waves satisfy the scalar wave equation only if the dispersion relation ```math p^2 Î·^2 \\frac 1 Î²^2 ``` is satisfied.\" syms A Aâ‚œ Aáµ£ syms p Real syms Î· Î·â‚œ md\"\"\" Setup The key steps involved in this analysis are 1. Defining the Plane Waves We define the mathematical expressions for the incident, reflected, and transmitted SH waves using their amplitudes, horizontal slowness `p`, and vertical slowness `Î·`. 2. Applying Boundary Conditions We impose the kinematic boundary condition continuity of displacement and the dynamic boundary condition continuity of traction at the interface to derive equations relating the amplitudes of the waves. 3. Solving for Coefficients We solve the derived equations to obtain the reflection and transmission coefficients, which describe the amplitudes of the reflected and transmitted waves relative to the incident wave. This analysis helps in understanding how SH waves interact with geological layers, which is crucial for interpreting seismic data and exploring subsurface structures. \"\"\" md\"\"\" Continuity in Displacement Kinematic Boundary Conditions For two solids welded in contact, the kinematic boundary condition is that all three components of the displacement have to be continuous across the boundary. We begin with expressions of the incident, transmitted and reflected plane waves. Note that all these plane waves share the same horizontal slowness p . \"\"\" u incident plane p, Î·, A u reflected plane p, Î·, Aáµ£ u transmitted plane p, Î·â‚œ, Aâ‚œ md\"As the displacement is continuous across the boundary, we shall now substitute z 0 in the plane waves defined above, and impose a condition that the displacement due to the incident and the reflected waves in the first layer should be equal to the displacement due to the transmitted wave.\" u z0 substitute u incident u reflected u transmitted, z 0 ~ 0 md\"Lets assume the amplitude of the incident planewave to be 1 for simplicity. In other words, A r and A t now denote the amplitude relative to the incident wave.\" eq displacement simplify Symbolics.symbolic linear solve u z0, A ~ 1 u z0 md\"\"\" Continuity in Traction Dynamic Boundary Conditions Apparently, a continuity in displacement is not sufficient for us to uniquely determine both Aâ‚œ and Aáµ£, given A. We should also employ the dynamic boundary condition, i.e., a constraint that traction on the surface z 0 is continuous. Specifically, here the component `Ïƒyz` of the stress tensor has to be continuous. \"\"\" variables Î¼â‚ Real Î¼â‚‚ Real Ïƒyz incident expand derivatives. Î¼â‚ . Dz. u incident Ïƒyz transmitted expand derivatives. Î¼â‚‚ . Dz. u transmitted Ïƒyz reflected expand derivatives. Î¼â‚ . Dz. u reflected md\"Similar to the displacement case, we now impose the continuity in `Ïƒyz`.\" Ïƒyz z0 substitute. Ïƒyz incident . Ïƒyz reflected . Ïƒyz transmitted, z 0 .~ 0 eq traction Î· Î¼â‚ simplify Symbolics.symbolic linear solve Ïƒyz z0, A ~ Î· Î¼â‚ Markdown.MD Markdown.Admonition \"danger\", \"Note\", md\"\"\" The remaining element Ïƒyx doesn't have to be continuous as it doesn't determine the traction on the interface z 0 . \"\"\" md\"\"\" Finally, we can solve for the reflection and transmission amplitudes, A r and A t , for the 2 D SH problem. \"\"\" SHAâ‚œ, SHAáµ£ simplify. Symbolics.symbolic linear solve eq displacement, eq traction , Aâ‚œ, Aáµ£ plane p, Î·â‚œ, SHAâ‚œ plane p, Î·, SHAâ‚œ md\" MOHO Example\" md\"\"\" We shall begin defining a function that computes the ray parameter, given the the angle of incidence Î¸ . \"\"\" syms Î¸ Real md\"We can then compute the vertical component of the slowness vector using the dispersion relation.\" md\"Similarly, the vertical component of the slowness vector in the second layer can be computed.\" md\"We can finally, update the expression of `SHAáµ£` and `SHAâ‚œ` using the MOHO parameters and plot them\" md\" Appendix\" md\"\"\" Lets print the expression of the wavefield, plotted in the previous example. \"\"\" warning box md\"\"\" The sign of the vertical slowness in the transmitted field above is chosen to prevent the exponential growth of the wavefield away from the boundary. \"\"\" default plotly template plotly dark Î¸grid range 0, stop pi 2, length 100 need for reflectance plots md\"\"\" It is evident that the reflection and transmission coefficients are dependent on the wave velocity and density values of the layers. In this section, we will choose these parameters to analyze waves. By default, we take the PREM Preliminary Earth Reference Model shear wave velocity and density values at the MOHO. This example is discussed in Chapter 6 of \"Introduction to Seismology\" by Peter Shearer. Î²â‚ km sec bind Î²â‚MOHO NumberField range 2.0, stop 6.0, step 0.1 , default 3.9 Î²â‚‚ km sec bind Î²â‚‚MOHO NumberField range 2.0, stop 6.0, step 0.1 , default 4.49 Ïâ‚ gm cmÂ³ bind Ïâ‚MOHO NumberField range 2.0, stop 6.0, step 0.1 , default 2.9 Ïâ‚‚ gm cmÂ³ bind Ïâ‚‚MOHO NumberField range 2.0, stop 6.0, step 0.1 , default 3.38 bind plot waves MultiCheckBox \"Incident\", \"Reflected\", \"Transmitted\" , default \"Incident\", \"Reflected\", \"Transmitted\" Angle of incidence âˆˆ 0, Ï€ 2 bind Î¸p Slider Î¸grid, default 1.4 Angular frequency bind Ï‰p Slider range 0.1, stop 2, length 10 , default 0.3 \"\"\" pMOHO Î¸ sin Î¸ Î²â‚MOHO Î·MOHO Î¸ sqrt inv Î²â‚MOHO ^2 pMOHO Î¸ ^2 0im Î·â‚œMOHO Î¸ sqrt inv Î²â‚‚MOHO ^2 pMOHO Î¸ ^2 0im SHAâ‚œ ex, SHAáµ£ ex broadcast SHAâ‚œ, SHAáµ£ do x Î¸ simplify substitute x, Î· Î·MOHO Î¸ , Î·â‚œ Î·â‚œMOHO Î¸ , Î¼â‚ Î²â‚MOHO^2 Ïâ‚MOHO, Î¼â‚‚ Î²â‚‚MOHO^2 Ïâ‚‚MOHO end u incident ex substitute plane pMOHO Î¸p , Î·MOHO Î¸p , 1.0 , Ï‰ Ï‰p, Ä± im u reflected ex substitute plane pMOHO Î¸p , Î·MOHO Î¸p , SHAáµ£ ex Î¸p , Ï‰ Ï‰p, Ä± im u transmitted ex substitute plane pMOHO Î¸p , isequal imag Î·â‚œMOHO Î¸p , 0.0 ? Î·â‚œMOHO Î¸p Î·â‚œMOHO Î¸p , SHAâ‚œ ex Î¸p , Ï‰ Ï‰p, Ä± im md\" Plots\" function plot reflectivity A, Î¸grid, title \"\" degÎ¸ rad2deg. Î¸grid fig Plot Layout title title, polar attr angularaxis direction \"clockwise\", sector 0, 90 , radialaxis range 2, 2 , add trace fig, scatterpolar r abs. A. Î¸grid , theta degÎ¸, mode \"lines\", name \"Abs\" add trace fig, scatterpolar r real. A. Î¸grid , theta degÎ¸, mode \"lines\", name \"Real\" add trace fig, scatterpolar r imag. A. Î¸grid , theta degÎ¸, mode \"lines\", name \"Imag\" add trace fig, barpolar r 3.5, , theta rad2deg Î¸p , width 2 , name \"Animation\", marker color \" E4FF87\" , marker line color \"black\", marker line width 1, opacity 0.5 , relayout fig, height 300, width 350, PlutoPlotly.plot fig end TwoColumn md\"\"\" plot reflectivity SHAáµ£ ex, Î¸grid, \"Reflection Coefficient\" \"\"\", md\"\"\" plot reflectivity SHAâ‚œ ex, Î¸grid, \"Transmission Coefficient\" \"\"\" function plot planewave ui, ur, ut, t1 0 we need to discretize space before plotting xgrid range 200, stop 200, length 200 zgrid bottom range 0, stop 200, length 100 zgrid top range 200, stop 0, length 100 substitute imaginary unit ui, ur, ut map ui, ur, ut do â‹… substitute â‹…, Ä± im end build functions reflected and incident uip, urp map ui, ur do â‹… fn build function â‹…, x, z, t, expression Val false real fn x, z, t1 for z in zgrid top, x in xgrid end utp let fn build function ut, x, z, t, expression Val false real fn x, z, t1 for z in zgrid bottom, x in xgrid end \"Transmitted\" âˆ‰ plot waves && fill utp, 0.0 \"Incident\" âˆ‰ plot waves && fill uip, 0.0 \"Reflected\" âˆ‰ plot waves && fill urp, 0.0 U cat urp uip, utp, dims 1 cmax max maximum abs, U , maximum abs, U fig Plot Layout yaxis autorange \"reversed\", yaxis attr scaleanchor \"x\" , width 350, height 350, uirevison 1, dragmode \"drawopenpath\", newshape line color \"black\", title \"SH Wavefield\", shapes line xref \"x\", yref \"y\", x0 200, y0 0, x1 200, y1 0, line attr color \"yellow\", width 3, , , , config PlotConfig displayModeBar false add trace fig, PlutoPlotly.heatmap z U, x xgrid, y vcat zgrid top, zgrid bottom , colorscale \"seismic\", zmin cmax, zmax cmax, add trace fig, scatter x 100 , y 20 , text \"Boundary\" , mode \"text\", showlegend false, textfont attr color \"yellow\", size 15, family \"Arail\", add trace fig, scatter x 150, 150 , y 150, 150 , text L\" Î²â‚,Ïâ‚ \", L\" Î²â‚‚,Ïâ‚‚ \" , mode \"text\", showlegend false, textfont attr color \"yellow\", size 15, family \"Arail\", plot fig end TwoColumn md\"\"\" plot planewave u incident ex, u reflected ex, u transmitted ex, mod tplot, 10 \"\"\", Markdown.MD Markdown.Admonition \"observe\", \"Observations\", md\"\"\" The angle of incidence is greater than the critical angle. The amplitude of the inhomogeneous waves exponentially decays as they move away from the boundary. There is a phase change in the reflected waves. The exponential decay is a function of the angular frequency. \"\"\" md\"\"\" TODO Phase Vs. Angle Plots \"\"\" "},{"url":"planewaves/tbu/","title":"To be updated","tags":["mod1"],"text":"COMING SOON"},{"url":"pointsource/Lamb_problem/","title":"Lamb's Problem","tags":["pointsource"],"text":" A Pluto.jl notebook v0.19.46 frontmatter title \"Lamb's Problem\" layout \"layout.jlhtml\" tags \"pointsource\" description \"Superposition of planewaves\" using Markdown using InteractiveUtils This Pluto notebook uses bind for interactivity. When running this notebook outside of Pluto, the following 'mock version' of bind gives bound variables a default value instead of an error . macro bind def, element quote local iv try Base.loaded modules Base.PkgId Base.UUID \"6e696c72 6542 2067 7265 42206c756150\" , \"AbstractPlutoDingetjes\" .Bonds.initial value catch b missing end local el esc element global esc def Core.applicable Base.get, el ? Base.get el iv el el end end using QuadGK, Bessels, PlutoPlotly, FFTW, Symbolics, SpecialFunctions, PlutoUI, ProgressLogging using Groebner, Nemo, Statistics TableOfContents md\"\"\" Lamb's Problem â€” Reflectivity Method Lamb's Problem is a classical problem in seismology and geophysics that involves understanding the response of an elastic half space to a point source, such as an earthquake or an explosion. The notebook leverages `QuadGK` package to perform numerical integration. The Reflectivity Method is a powerful technique used in seismology to model the propagation of seismic waves in layered media. It involves calculating the reflection and transmission coefficients of seismic waves at each interface between different layers. By superimposing these plane waves, the method can simulate the wavefield generated by a point source in a stratified medium. Interactive Seismology Notebooks https pawbz.github.io Interactive Seismology.jl Instructor Pawan Bharadwaj , Indian Institute of Science, Bengaluru, India \"\"\" md\" Conical Wave\" function get vertical wavenumber c, p c2 abs2 c Î¾ if inv c2 abs2 p sqrt inv c2 abs2 p else im sqrt abs2 p inv c2 end return Î¾ end begin function conical wave p, Ï‰grid, x, y, z, c, h r sqrt. abs2. x abs2. y Î¾ get vertical wavenumber c, p return Bessels.besselj0. Ï‰grid . p . r . exp. im . Ï‰grid . Î¾ . h . z . p Î¾ end function conical wave p, Ï‰grid, x, y, z, c1, c2, h r sqrt. abs2. x abs2. y Î¾ get vertical wavenumber c1, p Î· get vertical wavenumber c2, p return Bessels.besselj0. Ï‰grid . p . r . exp. im . Ï‰grid . Î¾ . h . Î· . z . p Î¾ end end md\" Medium\" media Î±â‚ 5.0, Î±â‚‚ 7.0, Î²â‚ 3.0, Î²â‚‚ 5.0, Ïâ‚ 3.0, Ïâ‚‚ 7.0 md\" Derive Reflection Coefficients\" variables Ï‰ Real Î¾â‚ Î½â‚ Î¾â‚‚ Î½â‚‚ x Real y Real z Real p r Real Î»â‚ Real Î¼â‚ Real Î»â‚‚ Real Î¼â‚‚ Real t Real syms Î±â‚ Î²â‚ Ïâ‚ Î±â‚‚ Î²â‚‚ Ïâ‚‚ variables Aâ‚š Aâ‚› Bâ‚š Bâ‚› variables Ä± plane wave p, Î·, A A exp Ä± Ï‰ t p x Î· z incident potential plane wave p, Î¾â‚, 1.0 reflected P potential plane wave p, Î¾â‚, Aâ‚š reflected S potential plane wave p, Î½â‚, Aâ‚› transmitted P potential plane wave p, Î¾â‚‚, Bâ‚š transmitted S potential plane wave p, Î½â‚‚, Bâ‚› begin Dx Differential x Dz Differential z end begin uxInc expand derivatives. Dx incident potential uzInc expand derivatives. Dz incident potential end begin uxRefP expand derivatives. Dx. reflected P potential uzRefP expand derivatives. Dz. reflected P potential uxRefS expand derivatives. Dz. reflected S potential uzRefS expand derivatives. Dx. reflected S potential end begin uxTransP expand derivatives. Dx. transmitted P potential uzTransP expand derivatives. Dz. transmitted P potential uxTransS expand derivatives. Dz. transmitted S potential uzTransS expand derivatives. Dx. transmitted S potential end Ïƒzz1 expand derivatives Î»â‚ . Dx. uxInc uxRefP uxRefS . Î»â‚ 2 Î¼â‚ . Dz. uzInc uzRefP uzRefS Ïƒzz2 expand derivatives Î»â‚‚ . Dx. uxTransP uxTransS . Î»â‚‚ 2 Î¼â‚‚ . Dz. uzTransP uzTransS Ïƒxz1 expand derivatives. Î¼â‚ . Dx. uzInc uzRefP uzRefS . Î¼â‚ . Dz. uxInc uxRefP uxRefS Ïƒxz2 expand derivatives. Î¼â‚‚ . Dx. uzTransP uzTransS . Î¼â‚‚ . Dz. uxTransP uxTransS Ux constraint uxInc uxRefP uxRefS uxTransP uxTransS Uz constraint uzInc uzRefP uzRefS uzTransP uzTransS Ux z0 simplify substitute Ux constraint, z 0 Ï‰ Ä± exp Ä± Ï‰ t p x Uz z0 simplify substitute Uz constraint, z 0 Ï‰ Ä± exp Ä± Ï‰ t p x Ïƒzz constraint Ïƒzz1 Ïƒzz2 Ïƒzz z0 simplify substitute Ïƒzz constraint, z 0, Ä±^2 1 Ï‰^2 exp Ä± Ï‰ t p x Ïƒxz constraint Ïƒxz1 Ïƒxz2 Ïƒxz z0 simplify substitute Ïƒxz constraint, Ä±^2 1, z 0 Ï‰^2 exp Ä± Ï‰ t p x function subs ex, media Î±â‚, Î±â‚‚, Î²â‚, Î²â‚‚, Ïâ‚, Ïâ‚‚ media ex simplify substitute ex, Ä±^2 1, Î»â‚ Ïâ‚ Î±â‚^2 2 Î²â‚^2 , Î¼â‚ Î²â‚^2 Ïâ‚, Î»â‚‚ Ïâ‚‚ Î±â‚‚^2 2 Î²â‚‚^2 , Î¼â‚‚ Î²â‚‚^2 Ïâ‚‚, Î¾â‚^2 1 Î±â‚^2 p^2 , Î¾â‚‚^2 1 Î±â‚‚^2 p^2 , Î½â‚^2 1 Î²â‚^2 p^2 , Î½â‚‚^2 1 Î²â‚‚^2 p^2 ex simplify substitute ex, Î±â‚ Î±â‚, Î±â‚‚ Î±â‚‚, Î²â‚ Î²â‚, Î²â‚‚ Î²â‚‚, Ïâ‚ Ïâ‚, Ïâ‚‚ Ïâ‚‚ return ex end function get A f, p1, media Î±â‚, Î±â‚‚, Î²â‚, Î²â‚‚, Ïâ‚, Ïâ‚‚ media Î¾â‚p get vertical wavenumber Î±â‚, p1 Î¾â‚‚p get vertical wavenumber Î±â‚‚, p1 Î½â‚p get vertical wavenumber Î²â‚, p1 Î½â‚‚p get vertical wavenumber Î²â‚‚, p1 return Complex Float64 f p1, Î¾â‚p, Î¾â‚‚p, Î½â‚p, Î½â‚‚p ex simplify substitute ex, p end function solve linear AB media constraints Ïƒzz z0, Ïƒxz z0, Ux z0, Uz z0 Avec Symbolics.symbolic linear solve constraints, Aâ‚š, Bâ‚š, Aâ‚›, Bâ‚› Avec Symbolics.symbolic solve constraints, Aâ‚š, Bâ‚š, Aâ‚›, Bâ‚› Avec subs Dict string key subs Avec 1 key , media for key in keys Avec 1 end begin Avec solve linear AB media Afunctions vec Dict string key build function Avec key , p, Î¾â‚, Î¾â‚‚, Î½â‚, Î½â‚‚, expression Val false for key in keys Avec end md\" Sommerfeld Integral\" struct Direct end struct Preflect end struct Sreflect end md\"\"\"Select the term bind plot phase confirm Select Direct \"Direct\", Preflect \"Reflected P\", Sreflect \"Reflected S\" \"\"\" begin function get phase Direct, p, param, media, h return conical wave p, param.Î©, param.X, param.Y, param.Z, media.Î±â‚ 1e 3, 0.0 end function get phase Preflect, p, param, media, h A get A Afunctions vec \"Aâ‚š\" , p, media return A conical wave p, param.Î©, param.X, param.Y, param.Z, media.Î±â‚ 1e 3, h end function get phase Sreflect, p, param, media, h A get A Afunctions vec \"Aâ‚›\" , p, media return A conical wave p, param.Î©, param.X, param.Y, param.Z, media.Î±â‚ 1e 3, media.Î²â‚ 1e 3, h end end function get wavefield param, H1, media, phase U im param.Î© . param.W . quadgk 0, 3 do p return get phase phase, p, param, media, H1 end 1 return U end md\" Seismograms\" seismograms param let Nt 1024 freq snapshot 1.0 tgrid range 0, 200, length Nt Ï‰grid collect rfftfreq Nt, inv step tgrid 2 pi f0 freq snapshot Ï‰0 2 pi f0 xgrid collect range 100, 500, length 10 Î©X collect Iterators.product Ï‰grid, xgrid Î© vec first. Î©X X vec last. Î©X Y fill 0.0, length X Z fill 0, length X W . exp 0.1 Î© Ï‰0 ^2 Nt, Î©, X, Y, Z, W, xgrid, tgrid, Ï‰grid, Ï‰0, f0 end time conical wave 0.0, seismograms param.Î©, seismograms param.X, seismograms param.Y, seismograms param.Z, media.Î±â‚ 1e 3, 0.0 H1 100.0 seismograms irfft reshape get wavefield seismograms param, H1, media, plot phase , length seismograms param.Ï‰grid , , seismograms param.Nt, 1 let U seismograms Umaxclip maximum abs, U 0.1 plot heatmap y seismograms param.tgrid, x seismograms param.xgrid, z U, zmin Umaxclip, zmax Umaxclip, colorscale seismic, , Layout title \"Seismograms\", width 300, yaxis autorange \"reversed\", xaxis attr title \"distance to receiver\" , yaxis attr title \"time s \" end md\" Snapshot\" snapshot param let N 101 freq snapshot 1.0 zgrid range 5, stop 99, length N xgrid range 200, stop 200, length N ZX collect Iterators.product zgrid, xgrid Z vec first. ZX X vec last. ZX Y fill 0.0, length X Î© fill 2 pi freq snapshot, length X W fill 1.0, length X X, Y, Z, Î©, W, N, xgrid, zgrid end snapshot reshape get wavefield snapshot param, H1, media, plot phase , snapshot param.N, snapshot param.N plot contour x snapshot param.xgrid, y snapshot param.zgrid, z log. abs. snapshot , Layout title \"Radiation\", yaxis autorange \"reversed\", height 300, width 650 md\" Appendix\" md\"\"\" To Do Use in place functions while performing numerical integration for speedup Better snapshots time dependent to visualize generation of e.g., headwaves Plot displacement field, instead of potentials Add free surface to get Rayleigh waves? Response from a stack of layers... \"\"\" md\"\"\" References Fuchs, K., and Gerhard MÃ¼ller. \"Computation of synthetic seismograms with the reflectivity method and comparison with observations.\" Geophysical Journal International 23.4 1971 417 433. \"\"\" "},{"url":"pointsource/lame-theorem/","title":"LamÃ©'s Theorem","tags":["pointsource"],"text":" A Pluto.jl notebook v0.19.46 frontmatter title \"LamÃ©'s Theorem\" layout \"layout.jlhtml\" tags \"pointsource\" description \"Are you in the near field with P and S wave radiation? Don't worry, the response at your station has a higher order discontinuity than in the far field.\" using Markdown using InteractiveUtils This Pluto notebook uses bind for interactivity. When running this notebook outside of Pluto, the following 'mock version' of bind gives bound variables a default value instead of an error . macro bind def, element quote local iv try Base.loaded modules Base.PkgId Base.UUID \"6e696c72 6542 2067 7265 42206c756150\" , \"AbstractPlutoDingetjes\" .Bonds.initial value catch b missing end local el esc element global esc def Core.applicable Base.get, el ? Base.get el iv el el end end begin using Symbolics using SpecialFunctions using SymbolicUtils using LinearAlgebra using PlutoTeachingTools using PlutoPlotly using PlutoTest using Latexify using PlutoUI using StatsBase using Distributions using Meshes end ChooseDisplayMode TableOfContents md\"\"\" LamÃ©'s Theorem The elastic wave equation turns into simpler equations for potentials in the case of an unbounded, isotropic and homogeneous medium. This interactive notebook delves into the fundamental concepts of near field and far field elastic wave radiation that emerge from seismic sources. Interactive Seismology Notebooks https pawbz.github.io Interactive Seismology.jl Instructor Pawan Bharadwaj , Indian Institute of Science, Bengaluru, India \"\"\" Markdown.MD Markdown.Admonition \"warning\", \"Theorem\", TwoColumnWideLeft md\"\"\" If the displacement field \\bf u \\bf u \\bf x , t satisfies, \\rho\\ddot \\bf u \\bf f \\lambda 2\\mu \\nabla \\nabla\\cdot\\bf u \\mu\\nabla \\times \\nabla \\times \\bf u , then âˆƒ potentials \\phi and \\psi for \\bf u with properties \\bf u \\nabla\\phi \\nabla \\times \\psi \\nabla\\cdot\\psi 0 \\rho\\ddot \\phi f 1 \\lambda 2\\mu \\nabla^2\\phi \\rho\\ddot \\psi \\mathbf f 2 \\mu \\nabla^2\\psi \"\"\", md\"\"\" Helmholtz potentials the body force and initial values of \\bf u and \\dot \\bf u satisfy \\bf f âˆ‡f 1 âˆ‡ Ã— \\bf f 2 , \\nabla\\cdot\\bf f 2 0 \\bf u \\bf x , 0 âˆ‡ u 1 âˆ‡ Ã— \\bf u 2 \\bf \\dot u \\bf x , 0 âˆ‡ \\dot u 1 âˆ‡ Ã— \\bf \\dot u 2 \\nabla\\cdot\\bf f 2 0 , \\nabla\\cdot\\bf u 2 0 , \\nabla\\cdot\\bf \\dot u 2 0 \"\"\" md\"The wavefield's analytical expression which dynamically adjusts based on the chosen parameters above is\" md\"\"\" Notation To begin, we will introduce the variables that will be utilized throughout this notebook, and we will construct spatial and temporal differential operators. \"\"\" syms x Real y Real z Real spatial coordinates ğ± x, y, z spatial coordinate vector syms t Real Ï‰ Real time and angular frequency syms Î± Î² Ï P and S wave velocities, mass density r sqrt sum ğ± .^ 2 distance from the origin, where the source is placed begin Dx Differential x Dy Differential y Dz Differential z Dt Differential t Dr Differential r end âˆ‡ Dx, Dy, Dz md\"\"\" P Radiation We shall now study P far field radiation due to body force, e.g., an impulsive force in the x direction. We now recall that one of the components of the displacement field is \\nabla \\phi , \\phi is the P potential. \"\"\" Markdown.MD Markdown.Admonition \"warning\", \"\", md\"\"\" The curl of the P component of the displacement field is zero only when \\frac 1 r^2 terms can be ignored, i.e., far away from the source. \"\"\" md\"\"\" Now, let's check if this component of the displacement field is like \"P waves\" with particle motion along the radial direction. When the source is at the origin, ğ± is a vector in the direction from the source. \"\"\" Markdown.MD Markdown.Admonition \"warning\", \"Longitudinal Waves\", md\"\"\" The far field P displacement field at any given location ğ± has a direction parallel to the direction from the source. \"\"\" md\"\"\" S Radiation We shall now study S far field radiation due to body force. \"\"\" Markdown.MD Markdown.Admonition \"warning\", \"\", md\"\"\" The divergence of the S component of the displacement field is zero only when \\frac 1 r^2 terms can be ignored, i.e., far away from the source. \"\"\" Markdown.MD Markdown.Admonition \"warning\", \"Transverse Waves\", md\"\"\" The far field S displacement field at any given location ğ± has a direction perpendicular to the direction from the source. \"\"\" function curl v vx v 1 vy v 2 vz v 3 curl field Dy vz Dz vy , Dz vx Dx vz , Dx vy Dy vx return Symbolics.simplify. expand derivatives. curl field end function divergence v vx v 1 vy v 2 vz v 3 div field Dx vx Dz vz Dy vy return Symbolics.simplify. expand derivatives. div field end md\"\"\" Understanding Nearfield Radiation We shall now look at the derivative w.r.t. the radial distance r of the monochromatic potential field. \"\"\" Ï• 1 r sin Ï‰ t r Î± Dx Ï• | expand derivatives md\"\"\" Notice that the far field term contains a time derivative of the forcing term. Lets plot the time series. \"\"\" md\"\"\" Appendix \"\"\" default plotly template plotly dark md\"Need some structs for multiple dispatch\" begin struct X end struct Y end struct Z end struct Pfar end struct Sfar end struct Near end struct Gaussian end struct Monochromatic end SourceType Union Gaussian,Monochromatic end begin derivative X, ex expand derivatives Dx ex derivative Y, ex expand derivatives Dy ex derivative Z, ex expand derivatives Dz ex end md\"\"\" Displacement Field The displacement due to, for example, a body force X 0 t applied in the x 1 direction at the origin is composed of 3 terms the first term is the near field term which is composed of both P and S wave motions, the second term is the P wave far field term and the third term is the S wave far field term. The i th component of the field is given by ```math u i \\mathbf x ,t \\frac 1 4\\pi\\rho \\left \\frac \\partial^2 \\partial x i \\partial x 1 \\frac 1 r \\right \\int r \\alpha ^ r \\beta \\tau X 0 t \\tau \\,d\\tau \\frac 1 4\\pi\\rho\\alpha^2r \\left \\frac \\partial r \\partial x i \\frac \\partial r \\partial x 1 \\right X 0\\left t \\frac r \\alpha \\right ``` ```math \\frac 1 4\\pi\\rho\\beta^2r \\left \\delta i1 \\frac \\partial r \\partial x i \\frac \\partial r \\partial x 1 \\right X 0\\left t \\frac r \\beta \\right , ``` where, \\rho is the density of the medium, \\alpha is the P wave velocity, \\beta is the S wave velocity, r is the distance between the source and receiver, \\tau is the convolution variable for time and \\delta i1 is the Kronecker Delta function. \"\"\" begin compute distance r, given receiver at xr, yr, zr and source at xs, ys, zs rad xr, yr, zr, xs, ys, zs sqrt xr xs ^2 yr ys ^2 zr zs ^2 invrad xr, yr, zr, xs, ys, zs inv rad xr, yr, zr, xs, ys, zs derivative of r w.r.t. x drad X, xr, yr, zr, xs, ys, zs, xr xs rad xr, yr, zr, xs, ys, zs, derivative of r w.r.t. y drad Y, xr, yr, zr, xs, ys, zs, yr ys rad xr, yr, zr, xs, ys, zs, derivative of r w.r.t. z drad Z, xr, yr, zr, xs, ys, zs, zr zs rad xr, yr, zr, xs, ys, zs, far field P wave function get displacement Nothing, Pfar, xr, yr, zr, xs, ys, zs, rc Union X,Y,Z , sc Union X,Y,Z , Ï, strength 1.0 return drad rc, xr, yr, zr, xs, ys, zs, drad sc, xr, yr, zr, xs, ys, zs, invrad xr, yr, zr, xs, ys, zs, strength inv 4 pi Ï Î± Î± end far field S wave function get displacement Nothing, Sfar, xr, yr, zr, xs, ys, zs, rc Union X,Y,Z , sc Union X,Y,Z , Ï, strength 1.0 return isequal rc, sc drad rc, xr, yr, zr, xs, ys, zs, drad sc, xr, yr, zr, xs, ys, zs, invrad xr, yr, zr, xs, ys, zs, strength inv 4.0 pi Ï Î² Î² end dc is derivative component of Pfar and Sfar useful for moment tensor solutions get displacement dc Union X,Y,Z , ps Union Pfar,Sfar , xr, yr, zr, xs, ys, zs, rc, sc, Ï, c, strength get displacement nothing, ps, xr, yr, zr, xs, ys, zs, rc, sc, Ï, c, strength drad dc, xr, yr, zr, xs, ys, zs, near field function get displacement Nothing, Near, xr, yr, zr, xs, ys, zs, rc Union X,Y,Z , sc Union X,Y,Z , Ï, strength 1.0 return derivative rc, derivative sc, invrad xr, yr, zr, xs, ys, zs strength inv 4 pi Ï end end md\"\"\" Forcing We consider two types of sources in this notebook 1 monochromatic source 2 Gaussian pulse. \"\"\" begin Ïƒ2 5 control std for Gaussian source f Gaussian, t exp t^2 Ïƒ2 work with retarded time later f Monochromatic, t sin Ï‰ t f1 Monochromatic, t cos Ï‰ t function f st Gaussian, Near, t, xr, yr, zr, xs, ys, zs computes retarded times for P and S internally, using Î± and Î² tp rad xr, yr, zr, xs, ys, zs Î± ts rad xr, yr, zr, xs, ys, zs Î² return 0.5 sqrt Ïƒ2 pi erf t tp sqrt Ïƒ2 erf t tp sqrt Ïƒ2 0.5 Ïƒ2 f st, t tp f st, t ts end function f st Monochromatic, Near, t, xr, yr, zr, xs, ys, zs computes retarded times for P and S internally, using Î± and Î² tp rad xr, yr, zr, xs, ys, zs Î± ts rad xr, yr, zr, xs, ys, zs Î² return f st, t tp tp Ï‰ f1 st, t tp f st, t ts ts Ï‰ f1 st, t ts inv Ï‰ inv Ï‰ end function f st SourceType, Pfar, t, xr, yr, zr, xs, ys, zs tp rad xr, yr, zr, xs, ys, zs Î± f st, t tp end function f st SourceType, Sfar, t, xr, yr, zr, xs, ys, zs ts rad xr, yr, zr, xs, ys, zs Î² f st, t ts end include the sourcing in g function get displacement sourcetype, dc, ps Union Pfar,Sfar,Near , xr, yr, zr, xs, ys, zs, rc Union X,Y,Z , sc Union X,Y,Z , Ï, strength return get displacement dc, ps, xr, yr, zr, xs, ys, zs, rc, sc, Ï, strength f sourcetype, ps, t, xr, yr, zr, xs, ys, zs end end upx get displacement nothing, Pfar , x, y, z, 0, 0, 0, X , Y , Ï, 1.0 upy get displacement nothing, Pfar , x, y, z, 0, 0, 0, Y , Y , Ï, 1.0 upz get displacement nothing, Pfar , x, y, z, 0, 0, 0, Z , Y , Ï, 1.0 up upx, upy, upz curl up cross ğ±, up pradiation sqrt sum abs2. upx, upy, upz usx get displacement nothing, Sfar , x, y, z, 0, 0, 0, X , X , Ï, 1.0 Dx usx | expand derivatives usy get displacement nothing, Sfar , x, y, z, 0, 0, 0, Y , X , Ï, 1.0 usz get displacement nothing, Sfar , x, y, z, 0, 0, 0, Z , X , Ï, 1.0 sradiation sqrt sum abs2. usx, usy, usz us usx, usy, usz divergence us | Symbolics.simplify dot ğ±, us | Symbolics.simplify substitute dot ğ±, us , sqrt x^2 y^2 z^2 ^2 x^2 y^2 z^2 | Symbolics.simplify md\" Seismogram\" md\" UI\" md\"Some constants which are not in the main UI\" Î±1 4 in km s Î²1 2 in km s Ï1 5e12 kg km3 md\" Discretize\" md\"Before plotting, we should discretize the space time and ensure a small length to render 3D plots faster, especially when making changes.\" begin distances are in km Don't choose an odd number of grid points here, due to nan values at 0,0,0 xgrid range 100, stop 100, length 26 zgrid xgrid ygrid xgrid end ThreeColumn md\"\"\" bind sample receiver Button \"Sample a receiver\" within radius \"\"\", md\"\"\" bind rmax plot Slider round. range 0, stop maximum abs, xgrid , length 100 , digits 2 , show value true, default maximum xgrid 2 and plot \"\"\", md\"\"\" bind plot seismogram field type MultiCheckBox Pfar \"P\", Sfar \"S\", Near \"Near\" , default Pfar , Sfar , Near , select all true \"\"\" begin sample receiver rx plot rand Uniform rmax plot, rmax plot ry plot rand Uniform rmax plot, rmax plot rz plot rand Uniform rmax plot, rmax plot end rz plot plot seismogram field type begin Xgrid3D first. Iterators.product xgrid, ygrid, zgrid Ygrid3D map x x 2 , Iterators.product xgrid, ygrid, zgrid Zgrid3D last. Iterators.product xgrid, ygrid, zgrid xgrid2 range 100, stop 100, length 100 Xgrid2D first. Iterators.product xgrid2, xgrid2 Zgrid2D last. Iterators.product xgrid2, xgrid2 end vertices boundary Meshes.Box Meshes.Point 1, 1, 1 , Meshes.Point 1,1,1 begin define a cube in R^3 points cube Meshes.Point3. coordinates. vertices boundary Meshes.Box Meshes.Point 1, 1, 1 , Meshes.Point 1,1,1 connec cube connect. 1,4,3,2 , 5,6,7,8 , 1,2,6,5 , 3,4,8,7 , 1,5,8,4 , 2,3,7,6 sphmesh refine refine SimpleMesh points cube, connec cube , CatmullClark , CatmullClark sphpts broadcast coordinates âˆ˜ centroid, collect elements sphmesh n3 length sphpts end sphpts 1 1 tgrid range 0, stop 100.0 inv Î±1 , length 10 md\"\"\" Customize Radiation Visualization Adjust the visualization by modifying these parameters Choose the component of the displacement field with bind plot rc Select X \"X\", Y \"Y\", Z \"Z\" , select the force density component using bind plot sc Select X \"X\", Y \"Y\", Z \"Z\" , set the forcing source type via bind plot source type Select Monochromatic \"Monochromatic\", Gaussian \"Gaussian\" , default Gaussian , pick the field type with bind plot field type Select Pfar \"P\", Sfar \"S\", Near \"Near Field\" , adjust angular frequency for monochromatic sources with bind Ï‰1 Slider range 0.2, stop 1, length 9 , show value true, default 0.5 , and modify the time instance using bind t forw Slider 5 length tgrid , default 7, show value true . These controls allow you to explore different radiation patterns below. \"\"\" wavefield get displacement plot source type, nothing, plot field type, x, y, z, 0, 0, 0, plot rc, plot sc, Ï, 1e20 get displacement plot source type, nothing, Near , x, y, z, 0, 0, 0, X , plot sc, Ï, 1 | Symbolics.simplify function get seismogram tgrid, sourcetype, dc, xr, yr, zr, xs, ys, zs, sc Union X,Y,Z , strength, plot seismogram field type ex map X , Y , Z do rc mapreduce , plot seismogram field type do ps get displacement sourcetype, nothing, ps, x, y, z, xs, ys, zs, rc, sc, Ï, strength end end return map ex do exp map tgrid do t1 substitute exp, t t1,Ï Ï1,Î± Î±1,Î² Î²1, Ï‰ Ï‰1, x xr, y yr, z zr end end end md\"\"\" Customize Radiation Visualization Adjust the visualization by modifying these parameters Choose the forcing source type via bind plot source type2 Select Monochromatic \"Monochromatic\", Gaussian \"Gaussian\" , adjust angular frequency for monochromatic sources with bind Ï‰2 Slider range 0.2, stop 1, length 9 , show value true, default 0.5 , and modify the time instance using bind t forw2 Slider 5 length tgrid , default 7, show value true . These controls allow you to explore the differences between near field and far field terms. \"\"\" example field expand derivatives Dr f plot source type2, t r Î± r md\"\"\" Notice that `example field`, has two terms one that decays as \\frac 1 r^2 near field term and the far field term that decays as \\frac 1 r . ...at a distance of r 100 , the far field term is stronger by a factor of round Ï‰2 Î±1 100 , digits 3 , which is 2Ï€ Ã— number of wavelengths between the source and the receiver . Weak enough? Let's plot the near field and far field terms separately after building the necessary functions. \"\"\" tgrid seismogram range 50.0 inv Î²1 , stop 300.0 inv Î²1 , length 1000 seismogram get seismogram tgrid seismogram, plot source type, nothing, rx plot, ry plot, rz plot, 0, 0, 0, plot sc, 1e20, plot seismogram field type choosing ry 1, rz 1 to avoid source location 0,0,0 md\"These functions build and discretize a given expression over spatial and temporal grids. Arguments `ex` A symbolic expression representing the function to be discretized. Returns A 3D array representing the discretized field of the provided expression over spatial and temporal grids. P and S wave velocities and angular frequency will be substituted before discretizing.\" function build and discretize3D ex test plot build function ex, x, y, z, t, Î±, Î², Ï, Ï‰, expression Val false field map tgrid do t1 map Xgrid3D, Ygrid3D, Zgrid3D do x, y, z test plot x, y, z, t1, Î±1, Î²1, Ï1, Ï‰1 Ï‰1 is used for 3D end end return field end function build and discretize2D ex fix y 0 test plot build function ex, x, y, z, t, Î±, Î², Ï, Ï‰, expression Val false field map tgrid do t1 map Xgrid2D, Zgrid2D do x, z test plot x, 0.0, z, t1, Î±1, Î²1, Ï1, Ï‰2 Ï‰2 is used for 2D end end return field end md\" Plots\" md\"This is a function that creates a 3D volume plot after discretizing the wavefield expression at a given time instance global variable `t forw`.\" cone plot let r div maximum xgrid , 2 c plot field type Pfar ? Î±1 Î²1 t r c sphpts1 r sphpts seismograms map sphpts1 do sphpt get seismogram t , Monochromatic , nothing, sphpt 1 , sphpt 2 , sphpt 3 , 0, 0, 0, plot sc, 1e20, plot field type end u map seismograms do s s 1 1 end v map seismograms do s s 2 1 end w map seismograms do s s 3 1 end x getindex. sphpts1, 1 y getindex. sphpts1, 2 z getindex. sphpts1, 3 x, y, z, u, v, w end plot cone x cone plot.x, y cone plot.y, z cone plot.z, u cone plot.u, v cone plot.v, w cone plot.w, sizeref 2, showscale false, colorscale colors.Blues 8, , Layout scene attr domain x 0, 1 , camera eye attr x 1.57, y 1.36, z 0.58 function add field fig, field, t forw colorbar axis lims are chosen keeping all the time steps in mind, so that the attenuation can be observed cmax maximum map field do f return maximum abs, f end 0.1 select time instance values field t forw add trace fig, PlutoPlotly.volume x Xgrid3D , y Ygrid3D , z Zgrid3D , value values , isomin cmax, isomax cmax, colorscale \"RdBu\", opacity 0.1, needs to be small to see through all surfaces surface count 30, needs to be a large number for good volume rendering caps attr x show false, y show false, z show false, x fill 1 , opacityscale \"extremes\" end function plot ex wavefronts3D ex, title \"Elastic wave Radiation\" field build and discretize3D ex layout Layout uirevision 1, scene attr xaxis attr nticks 3, range 100, 100 , yaxis attr nticks 3, range 100, 100 , zaxis attr nticks 3, range 100, 100 , , width 650, margin attr r 20, l 10, b 10, t 10 , title attr text title, y 0.9, x 0.15, fig Plot layout add field fig, field, t forw N 10 add trace fig, scatter3d x rx plot , y ry plot , z rz plot , mode \"markers text\", marker color \"black\", marker size 3, text \"receiver\" add trace fig, scatter3d x 0 , y 0 , z 0 , mode \"markers text\", marker color \"black\", marker size 3, text \"source\" return fig end plot plot ex wavefronts3D wavefield function plot ex wavefronts2D nearex, farex nearfield build and discretize2D nearex farfield build and discretize2D farex cmax near maximum map nearfield do f return maximum abs, f end 0.006 cmax far maximum map farfield do f return maximum abs, f end 0.1 fig Plot Layout yaxis autorange \"reversed\", height 300, width 650, title attr font size 12, , font attr size 10 , yaxis attr scaleanchor \"x\" , Subplots horizontal spacing 0.3, rows 1, cols 2, subplot titles \"Near Field\" \"Far Field\" add trace fig, heatmap x xgrid2, y xgrid2, z nearfield t forw2 , zmin cmax far, zmax cmax far, colorscale \"seismic\", showscale true, colorbar x 0.35 , row 1, col 1 add trace fig, heatmap x xgrid2, y xgrid2, z farfield t forw2 , zmin cmax far, zmax cmax far, colorscale \"seismic\", showscale true, colorbar x 1.0 , row 1, col 2 return PlutoPlotly.plot fig end plot ex wavefronts2D first arguments example field , last arguments example field function plot seismogram seismogram fig PlutoPlotly.Plot Layout height 200, width 500, title \"Displacement at x, y, z round rx plot, digits 3 , round ry plot, digits 3 , round rz plot, digits 3 \", show legend true, font attr size 10 tgrid tgrid seismogram add trace fig,PlutoPlotly.scatter x tgrid,y seismogram 1 ,line width 2,mode \"lines\",line color \"red\",name \"X\" add trace fig,PlutoPlotly.scatter x tgrid,y seismogram 2 ,line width 2,mode \"lines\",line color \"blue\",name \"Y\" add trace fig,PlutoPlotly.scatter x tgrid,y seismogram 3 ,line width 2,mode \"lines\",line color \"yellow\",name \"Z\" PlutoPlotly.plot fig end plot seismogram seismogram md\"\"\" Inhomogeneous wave equation We can now define the wave operator of a scalar wave equation in three dimensions. \"\"\" L Ï•, Î± Dt Dt Ï• Î±^2 Dx Dx Ï• Dy Dy Ï• Dz Dz Ï• print the scalar wave equation latexify L u, Î± ~ Î´ x Î´ y Î´ z f t md\"\"\" Spherical waves We will now consider a monochromatic source sin function of space and time with amplitude A and parameters \\omega and K . \"\"\" Dt sin Ï‰ t | expand derivatives sphwav build function Ï•, r, t, Î±, Ï‰, expression Val false gif Ppotential plot ex wavefronts3D Ï•, \"Ï•\" md\"\"\" Similarly, along y and z . \"\"\" bind body forces confirm PlutoUI.combine do Child components \"x\", \"y\", \"z\" s2 md\"\"\" \"x\" Child NumberField range 1, step 0.1, stop 1 , default 1 \"y\" Child NumberField range 1, step 0.1, stop 1 , default 0 \"z\" Child NumberField range 1, step 0.1, stop 1 , default 0 \"\"\" for is in 1 2 md\"\"\" Input Body Force Until now, we have considered a spherically symmetric field Ï• as P potential. According to Lame's theorem, the P potential should be generated using a curl free component of the forcing field. We refer the reader to Eq. 4.23 Aki Richards for a detailed derivation. Here we will just write down the final expressions. s2 1 \"\"\" end "},{"url":"pointsource/seismic-sources/","title":"Seismic Source Theory","tags":["pointsource"],"text":" A Pluto.jl notebook v0.19.46 frontmatter title \"Seismic Source Theory\" tags \"pointsource\" layout \"layout.jlhtml\" description \"Representation of the displacement field due to slip across fault planes in the source region.\" using Markdown using InteractiveUtils This Pluto notebook uses bind for interactivity. When running this notebook outside of Pluto, the following 'mock version' of bind gives bound variables a default value instead of an error . macro bind def, element quote local iv try Base.loaded modules Base.PkgId Base.UUID \"6e696c72 6542 2067 7265 42206c756150\" , \"AbstractPlutoDingetjes\" .Bonds.initial value catch b missing end local el esc element global esc def Core.applicable Base.get, el ? Base.get el iv el el end end begin using PlutoUI using PlutoTeachingTools using Symbolics using SymbolicUtils using LinearAlgebra using Einsum using PlutoHooks using PlutoPlotly using TikzPictures end ChooseDisplayMode TableOfContents md\"\"\" Seismic Source Theory This notebook provides a simple demonstration of the representation theorem and its use in seismic source theory. For internal sources, it derives expressions for seismic moment density tensor in the case of an isotropic elastic media, where a displacement discontinuity is assumed across two adjacent surfaces internal to a volume. | Fault Orientation | Slip | Measured Displacement| | | | | | bind fault input Radio \"1\", \"2\", \"3\" , default \"1\" | bind slip input Radio \"1\", \"2\", \"3\" , default \"2\" | bind measurement input Radio \"1\", \"2\", \"3\" , default \"1\" \"\"\" md\"The displacement field in the second state is given by integrating the moment tensor density over the source region, which constitutes of geologic faults or underground volume explosions.\" md\"\"\" Setting Up Two States \"\"\" variables x 1 3 md\" Displacement Fields Declaring symbols for vector displacement fields in the temporal frequency domain. \" variables u 1 3 v 1 3 md\" Body Force Densities Body force densities in both the states. For internal seismic sources, we assume that the body forces are absent in the case of the second state.\" variables f 1 3 h 1 3 md\" c ijkl The elastic constants for an isotropic medium are \\lambda and \\mu . These constants are identical for both the states, and their values at the source region affect the resultant displacement field.\" variables Î» Î¼ Ciso Î» 2Î¼, Î», Î», 0, 0, 0 Î», Î» 2Î¼, Î», 0, 0, 0 Î», Î», Î» 2Î¼, 0, 0, 0 0, 0, 0, Î¼, 0, 0 0, 0, 0, 0, Î¼, 0 0, 0, 0, 0, 0, Î¼ function get cijkl C C i isequal i, j 1 isequal i, j 9 i j , k isequal k, l 1 isequal k, l 9 k l for i in 1 3, j in 1 3, k in 1 3, l in 1 3 end ciso get cijkl Ciso md\" Strain Tensors\" einsum eáµ¤ i, j 0.5 âˆ‡ i u j âˆ‡ j u i einsum eáµ¥ i, j 0.5 âˆ‡ i v j âˆ‡ j v i md\" Stress Tensors\" einsum Ïƒáµ¤ i, j ciso i, j, k, l eáµ¤ k, l einsum Ïƒáµ¥ i, j ciso i, j, k, l eáµ¥ k, l md\"\"\" Betti's Theorem \"\"\" syms âˆ­ f âˆ¬ f volume and surface integrals Bv1 dot u, h Bv2 dot v, f md\"\"\" Elastodynamic Green's Tensor We shall denote the spatial coordinate in the source region using \\xi . The ith component of the displacement field in the frequency domain, due to an impulsive force acting in the jth direction, is given by G ji \\xi, x . \"\"\" variables Î¾ 1 3 syms Gâ‚â‚ xâ‚, xâ‚‚, xâ‚ƒ, Î¾â‚, Î¾â‚‚, Î¾â‚ƒ Gâ‚â‚‚ xâ‚, xâ‚‚, xâ‚ƒ, Î¾â‚, Î¾â‚‚, Î¾â‚ƒ Gâ‚â‚ƒ xâ‚, xâ‚‚, xâ‚ƒ, Î¾â‚, Î¾â‚‚, Î¾â‚ƒ Gâ‚‚â‚ xâ‚, xâ‚‚, xâ‚ƒ, Î¾â‚, Î¾â‚‚, Î¾â‚ƒ Gâ‚‚â‚‚ xâ‚, xâ‚‚, xâ‚ƒ, Î¾â‚, Î¾â‚‚, Î¾â‚ƒ Gâ‚‚â‚ƒ xâ‚, xâ‚‚, xâ‚ƒ, Î¾â‚, Î¾â‚‚, Î¾â‚ƒ Gâ‚ƒâ‚ xâ‚, xâ‚‚, xâ‚ƒ, Î¾â‚, Î¾â‚‚, Î¾â‚ƒ Gâ‚ƒâ‚‚ xâ‚, xâ‚‚, xâ‚ƒ, Î¾â‚, Î¾â‚‚, Î¾â‚ƒ Gâ‚ƒâ‚ƒ xâ‚, xâ‚‚, xâ‚ƒ, Î¾â‚, Î¾â‚‚, Î¾â‚ƒ md\"These symbols look a bit clumsy, anyway, let us form the Green's tensor\" G Gâ‚â‚ x..., Î¾... Gâ‚â‚‚ x..., Î¾... Gâ‚â‚ƒ x..., Î¾... Gâ‚‚â‚ x..., Î¾... Gâ‚‚â‚‚ x..., Î¾... Gâ‚‚â‚ƒ x..., Î¾... Gâ‚ƒâ‚ x..., Î¾... Gâ‚ƒâ‚‚ x..., Î¾... Gâ‚ƒâ‚ƒ x..., Î¾... md\" Spatial Reciprocity Assuming homogeneous boundary conditions everywhere on S \\Sigma^ \\Sigma^ , we can show that\" G1 Gâ‚â‚ Î¾..., x... Gâ‚‚â‚ Î¾..., x... Gâ‚ƒâ‚ Î¾..., x... Gâ‚â‚‚ Î¾..., x... Gâ‚‚â‚‚ Î¾..., x... Gâ‚ƒâ‚‚ Î¾..., x... Gâ‚â‚ƒ Î¾..., x... Gâ‚‚â‚ƒ Î¾..., x... Gâ‚ƒâ‚ƒ Î¾..., x... G1 ~ G md\"\"\" Displacement Discontinuity \"\"\" variables vâº 1 3 vâ» 1 3 md\" Appendix\" tikz ingredients \"tikz.jl\" âˆ‡ Differential Î¾ 1 , Differential x 2 , Differential Î¾ 3 md\" UI\" fault normal map x isequal x, fault input , \"1\", \"2\", \"3\" Bs1 dot v, Ïƒáµ¤ fault normal | simplify Bs2 dot u, Ïƒáµ¥ fault normal | simplify âˆ­ Bv1 Bv2 ~ âˆ¬ Bs1 Bs2 slip component map x isequal x, slip input , \"1\", \"2\", \"3\" measured component map x isequal x, measurement input , \"1\", \"2\", \"3\" iv comp findfirst measured component Bv1 sub substitute Bv1, u k G k, iv comp for k in 1 3 ... | expand derivatives Bs1 sub substitute Bs1, v k slip component k vâº k vâ» k for k in 1 3 ..., u k G k, iv comp for k in 1 3 ... | expand derivatives v iv comp ~ âˆ¬ Bs1 sub md\"\"\" Plots \"\"\" xyz Iterators.product X, Y, Z , X, Y, Z need an iterator for elements of moment tensor begin struct X end struct Y end struct Z end struct XY end struct YZ end struct XZ end end begin dcouple 0.5 half distance b w the elements of a force couple body force locations X dcouple, 0.0, 0.0 , dcouple, 0.0, 0.0 body force locations Y 0.0, dcouple, 0.0 , 0.0, dcouple, 0.0 body force locations Z 0.0, 0.0, dcouple , 0.0, 0.0, dcouple end collect forces just for plotting srclocs reshape cat body force locations eval x 2 for x in xyz ..., dims 1 , 1, 1, 9 2 function plot moment tensor normal ps Plot Layout scene attr xaxis range 5, 5 , yaxis range 5, 5 , zaxis range 5, 5 , xaxis title \"x m \", yaxis title \"y m \", zaxis title \"z m \", title \"Equivalent Force Distribution\" , margin attr l 0, r 0, b 0, t 0 , showlegend false, limits ps, x 5, 5 , y 5, 5 , z 5, 5 arrows ps, x vec getindex. srclocs, 1 , y vec getindex. srclocs, 2 , z vec getindex. srclocs, 3 , u vec getindex. srcstrength 1, 1, , 2 , v vec getindex. srcstrength 1, 2, , 2 , w vec getindex. srcstrength 1, 3, , 2 , line attr color black, width 0.05 , sizemode \"absolute\", sizeref 0.5, color black, Create points on the plane to form a grid x range 5, stop 5, length 50 y range 5, stop 5, length 50 xgrid first Iterators.product x, y ygrid last Iterators.product x, y Calculate z values for the plane using the plane equation z normal 1 . x1 . normal 2 . y1 . normal 3 for x1 in x for y1 in y Plot the plane add trace ps, surface x x, y y, z z add trace ps, cone x 1 , y 1 , z 1 , u 1 , v 1 , w 1 , sizeref 1, sizemode \"absolute\", , return plot ps end plot moment tensor 1, 1, 1 function plot volume u \" \", G false L1 L\"\"\" \\tikzset Pacman .pic \\shadedraw inner color gray,outer color gray 80 white,draw black,thick 1,1 node left, xshift 0.5cm, yshift 0.25cm 1 \\Sigma^ 5 2 arc 5 360 2 node above, xshift 0.5cm, yshift 0.7cm 4 \\Sigma^ cycle \\pic at 1,0 Pacman \\node at current bounding box 0.5cm, 1cm V \\node at current bounding box 2cm,1cm S \\node at current bounding box 0cm,2.5cm % u \"\"\" L2 L\"\"\" \\node label yellow 90 \\xi xi at 2,1 \\draw , yellow, thick node midway, above left x 2,1 to out 150,in 0 node midway, below, yshift 0.5cm G x, \\xi 0,0 \"\"\" if G return tikz.plot L1 L2 else return tikz.plot L1 end end function two state tikz TwoColumn md\"\"\" plot volume L\"\\mathrm State\\,I u, \\sigma u, f\", true \"\"\", md\"\"\" plot volume L\"\\mathrm State\\,II v, \\sigma v, h\", false \"\"\" end two state tikz "},{"url":"raytheory/eikonal-equation backup 1/","title":"Stress Tensor","tags":["introduction"],"text":" A Pluto.jl notebook v0.19.46 frontmatter order \"4\" title \"Stress Tensor\" tags \"introduction\" layout \"layout.jlhtml\" using Markdown using InteractiveUtils This Pluto notebook uses bind for interactivity. When running this notebook outside of Pluto, the following 'mock version' of bind gives bound variables a default value instead of an error . macro bind def, element quote local iv try Base.loaded modules Base.PkgId Base.UUID \"6e696c72 6542 2067 7265 42206c756150\" , \"AbstractPlutoDingetjes\" .Bonds.initial value catch b missing end local el esc element global esc def Core.applicable Base.get, el ? Base.get el iv el el end end begin using LinearAlgebra using PlutoUI using LaTeXStrings using PlutoTeachingTools using PlutoUI using Symbolics using SymbolicUtils using Einsum using PlutoPlotly using TikzPictures end ChooseDisplayMode TableOfContents variables A Real N Real F Real C Real L Real variables Î» Real Î¼ Real Ctrans A, A 2N, F, 0, 0, 0 A 2N, A, F, 0, 0, 0 F, F, C, 0, 0, 0 0, 0, 0, L, 0, 0 0, 0, 0, 0, L, 0 0, 0, 0, 0, 0, L Ciso map Ctrans do x substitute x, A Î» 2Î¼, C Î» 2 Î¼, N Î¼, F Î», L Î¼ end variables u 1 3 vector displacement field x 1 3 g 1 3 p Real syms Uâ‚ t Uâ‚‚ t Uâ‚ƒ t U Uâ‚, Uâ‚‚, Uâ‚ƒ syms f xâ‚, xâ‚‚, xâ‚ƒ syms T xâ‚, xâ‚‚, xâ‚ƒ U 2 syms t syms Ä± Ï‰ variables e 1 3, 1 3 strain tensor function get cijkl C C i isequal i, j 1 isequal i, j 9 i j , k isequal k, l 1 isequal k, l 9 k l for i in 1 3, j in 1 3, k in 1 3, l in 1 3 end ciso get cijkl Ciso for isotropic einsum Ïƒiso i, j ciso i, j, k, l e k, l variables x 1 3 position vector ~ x, y, z f x... utrail1 exp Ä± Ï‰ t p dot s, x D Differential x 1 , Differential x 2 , Differential x 3 Dt Differential t einsum uddot i ciso i, j, k, l D j D l u k einsum uddot trail1 i ciso i, j, k, l expand derivatives D j D l f x 1 , x 2 , x 3 U k t T x 1 , x 2 , x 3 D 1 U 1 t T x 1 , x 2 , x 3 | expand derivatives U 1 x 1 Dt Dt f x 1 , x 2 , x 3 U k for k in 1 3 md\"\"\" Eikonal Equation Interactive Seismology Notebooks https pawbz.github.io Interactive Seismology.jl Instructor Pawan Bharadwaj , Indian Institute of Science, Bengaluru, India \"\"\" md\"\"\" The stress tensor three dimensions is given by ```math \\sigma \\begin bmatrix \\sigma 11 & \\sigma 12 & \\sigma 13 \\\\ \\sigma 12 & \\sigma 22 & \\sigma 23 \\\\ \\sigma 13 & \\sigma 23 & \\sigma 33 \\\\ \\end bmatrix ``` | | | | | | | | | Ïƒ 11 bind Ïƒ11 Scrubbable 1 0.01 1, default 1 | Ïƒ 22 bind Ïƒ22 Scrubbable 1 0.1 1, default 0 | Ïƒ 33 bind Ïƒ33 Scrubbable 1 0.1 1, default 0.5 | | Ïƒ 12 bind Ïƒ12 Scrubbable 1 0.1 1, default 0.5 | Ïƒ 23 bind Ïƒ23 Scrubbable 1 0.1 1, default 0 | Ïƒ 13 bind Ïƒ13 Scrubbable 1 0.1 1, default 0 | which is symmetric. \"\"\" bind resample normal CounterButton \"Resample Imaginary Plane\" md\" UI and Plotting\" md\"\"\" Let us define the functions that we will be using in this notebook. \"\"\" Ïƒinput let Ïƒ11 Ïƒ12 Ïƒ13 Ïƒ12 Ïƒ22 Ïƒ23 Ïƒ13 Ïƒ23 Ïƒ33 end eigsigma eigen Ïƒinput nsample let resample normal n randn 3 n n . sqrt sum abs2, n end Tinput Ïƒinput nsample function plot3lines 1 v, color, name p1 scatter3d x 0, v 1 , y 0, 0 , z 0, 0 , mode \"lines\", name name, line attr color color , p2 scatter3d x 0, 0 , y 0, v 2 , z 0, 0 , mode \"lines\", name name, line attr color color , p3 scatter3d x 0, 0 , y 0, 0 , z 0, v 3 , mode \"lines\", name name, line attr color color , return p1, p2, p3 end function plot3lines 2 v1,v2,v3, color, name p1 scatter3d x 0, v1 1 , y 0, v1 2 , z 0, v1 3 , mode \"lines\", name name, line attr color color , p2 scatter3d x 0, v2 1 , y 0, v2 2 , z 0, v2 3 , mode \"lines\", name name, line attr color color , p3 scatter3d x 0, v3 1 , y 0, v3 2 , z 0, v3 3 , mode \"lines\", name name, line attr color color , return p1, p2, p3 end function stress plot p1 cone x 0 , y 0 , z 0 , u nsample 1 , v nsample 2 , w nsample 3 , name \"Surface Normal\", hoverinfo \"name\", showscale false, opacity 0.5, anchor \"tail\", color \"black\", colorscale colors.Blues 8, sizeref 0.5 p2 scatter3d x 0, nsample 1 , y 0, nsample 2 , z 0, nsample 3 , mode \"lines\", name \"Normal Vector\", line attr color \"gray\" , p3 plot3lines 1 Tinput, \"red\", \"Traction\" p4 plot3lines 2 collect eachcol eigsigma.vectors . eigsigma.values ..., \"blue\", \"Principal\" layout Layout scene camera eye attr x 0, y 0, z 0 , width 600, height 500, uirevision 1, scene attr xaxis attr nticks 10, range 1,1 , yaxis attr nticks 10, range 1,1 , zaxis attr nticks 10, range 1,1 , , return plot p1, p2, p3..., p4... , layout end stress plot md\"\"\" Appendix \"\"\" md\" Tikz\" tikz default options raw\"\"\" background rectangle .style fill white , show background rectangle, \"\"\" tikz preamble raw\"\"\" \\usepackage tikz \\usepackage tikz 3dplot \\usetikzlibrary fit, matrix, shapes.geometric \\tikzset % use tikzset, not tikzstyle cell .style rectangle, rounded corners 5pt, draw, \\tikzset % use tikzset, not tikzstyle cellv .style rectangle, rounded corners 5pt, draw, rotate 90, \\usepackage xifthen \\usetikzlibrary hobby \\usepackage pgfplots \\usepackage fontawesome \\usepackage bm,amsfonts,amsmath \\usetikzlibrary backgrounds,pgfplots.groupplots,snakes \\usepgfplotslibrary patchplots \\pgfplotsset try min ticks 2 \\usepackage pgfplotstable \\usetikzlibrary plotmarks,positioning,spy \\usetikzlibrary shapes.geometric, arrows, fadings \\usepgfplotslibrary groupplots, polar \\usepackage space grffile \\usetikzlibrary % decorations.pathreplacing,% decorations.pathmorphing% \\usetikzlibrary positioning,fit,backgrounds \\usetikzlibrary shapes,arrows \\usetikzlibrary decorations.markings \\usetikzlibrary patterns \\usetikzlibrary plotmarks \\usetikzlibrary fit \\usetikzlibrary intersections \\usepgfplotslibrary fillbetween \\pgfplotsset axis line style black 10 , every axis label .append style black 10 , every axis title .append style black 10 , every tick label .append style black 10 % need for pgfplots \\newcommand \\axisz 0cm \\newcommand \\axisx 0cm \\usetikzlibrary positioning \\usetikzlibrary shapes.geometric \\usetikzlibrary backgrounds \"\"\" t1, t2, t3, tv are texts s1 and s2 are labels with sizes plot plane normal TikzPicture L\"\"\" \\tdplotsetmaincoords 105 30 \\tdplotsetrotatedcoords 00 30 0 \\begin scope tdplot rotated coords \\begin scope canvas is xy plane at z 0 \\fill gray,fill opacity 0.3 2, 3 rectangle 2,3 \\draw very thick 2,0 2,0 \\path 150 2 coordinate H 1.5,0 coordinate X \\pgflowlevelsynccm \\draw very thick, stealth,gray 0,0 30 1.5 \\end scope \\draw stealth H 1,0,0.2 node pos 1.3 H \\draw stealth X 0,1,0.2 node pos 1.3 X \\draw very thick, stealth 0,0,0 coordinate O 0,0,3 node right p \\end scope \\pgfmathsetmacro \\Radius 1.5 \\draw stealth O 2.5 \\Radius,0,0 node pos 1.15 spot 0 \\draw stealth O 0,3.5 \\Radius,0 node pos 1.15 spot 2 \\draw stealth O 0,0,2.5 \\Radius node pos 1.05 spot 1 \"\"\", options tikz default options, preamble tikz preamble, width \"12cm\" plot plane normal TikzPicture L\"\"\" \\tdplotsetmaincoords 60 125 \\tikzset cube .style very thick,black , grid .style very thin,gray , axis .style ,blue,thick , %draw a grid in the x y plane \\foreach \\x in 0.5,0,...,2.5 \\foreach \\y in 0.5,0,...,2.5 \\draw grid \\x, 0.5 \\x,2.5 \\draw grid 0.5,\\y 2.5,\\y %draw the axes \\draw axis 0,0,0 3,0,0 node anchor west x 1 \\draw axis 0,0,0 0,3,0 node anchor west x 2 \\draw axis 0,0,0 0,0,3 node anchor west x 3 %draw the top and bottom of the cube \\draw cube 0,0,0 0,2,0 2,2,0 2,0,0 cycle \\draw cube 0,0,2 0,2,2 2,2,2 2,0,2 cycle %draw the edges of the cube \\draw cube 0,0,0 0,0,2 \\draw cube 0,2,0 0,2,2 \\draw cube 2,0,0 2,0,2 \\draw cube 2,2,0 2,2,2 \"\"\", options tikz default options, preamble tikz preamble, width \"12cm\" plot scatter3d x x, y y, z z, mode \"lines\", name \"Plane\" , scatter3d x 0, normal vector 1 , y 0, normal vector 2 , z 0, normal vector 3 , mode \"lines markers\", name \"Normal Vector\", line attr color \"red\" plot scatter3d x x, y y, z z, mode \"lines\", name \"Plane\" TikzPicture L\"\"\" % Define the unit normal vector \\def\\nx 0.5 % x component of the normal vector \\def\\ny 0.5 % y component of the normal vector \\def\\nz 0.5 % z component of the normal vector % Define the plane equation ax by cz d \\def\\d 1 % Distance from the origin % Calculate the vertices of the small plane \\pgfmathsetmacro \\a 0.5 % Half the side length of the small plane % Calculate two vectors perpendicular to the normal vector using Gram Schmidt process \\pgfmathsetmacro \\ux \\ny \\pgfmathsetmacro \\uy \\nx \\pgfmathsetmacro \\uz 0 \\pgfmathsetmacro \\vx \\nx \\nz \\pgfmathsetmacro \\vy \\ny \\nz \\pgfmathsetmacro \\vz \\nx^2 \\ny^2 % Normalize the perpendicular vectors \\pgfmathsetmacro \\ulen sqrt \\ux \\ux \\uy \\uy \\uz \\uz \\pgfmathsetmacro \\vlen sqrt \\vx \\vx \\vy \\vy \\vz \\vz \\pgfmathsetmacro \\ux \\ux \\ulen \\pgfmathsetmacro \\uy \\uy \\ulen \\pgfmathsetmacro \\uz \\uz \\ulen \\pgfmathsetmacro \\vx \\vx \\vlen \\pgfmathsetmacro \\vy \\vy \\vlen \\pgfmathsetmacro \\vz \\vz \\vlen % Draw the coordinate axes \\draw 0,0,0 3,0,0 node anchor north east x \\draw 0,0,0 0,3,0 node anchor north west y \\draw 0,0,0 0,0,3 node anchor south z % Draw the small plane \\filldraw opacity 0.5 \\a \\ux , \\a \\uy , \\a \\uz \\a \\vx , \\a \\vy , \\a \\vz \\a \\ux , \\a \\uy , \\a \\uz \\a \\vx , \\a \\vy , \\a \\vz cycle % Draw the normal vector \\draw , thick, color red 0,0,0 \\nx,\\ny,\\nz \\node at \\nx,\\ny,\\nz anchor south west \\vec n \"\"\", options tikz default options, preamble tikz preamble, width \"12cm\" "},{"url":"raytheory/eikonal-equation/","title":"Stress Tensor","tags":["introduction"],"text":" A Pluto.jl notebook v0.19.46 frontmatter order \"4\" title \"Stress Tensor\" tags \"introduction\" using Markdown using InteractiveUtils This Pluto notebook uses bind for interactivity. When running this notebook outside of Pluto, the following 'mock version' of bind gives bound variables a default value instead of an error . macro bind def, element quote local iv try Base.loaded modules Base.PkgId Base.UUID \"6e696c72 6542 2067 7265 42206c756150\" , \"AbstractPlutoDingetjes\" .Bonds.initial value catch b missing end local el esc element global esc def Core.applicable Base.get, el ? Base.get el iv el el end end begin using LinearAlgebra using PlutoUI using LaTeXStrings using PlutoTeachingTools using PlutoUI using Symbolics using SymbolicUtils using Einsum using PlutoPlotly using TikzPictures end ChooseDisplayMode TableOfContents variables A Real N Real F Real C Real L Real variables Î» Real Î¼ Real Ctrans A, A 2N, F, 0, 0, 0 A 2N, A, F, 0, 0, 0 F, F, C, 0, 0, 0 0, 0, 0, L, 0, 0 0, 0, 0, 0, L, 0 0, 0, 0, 0, 0, L Ciso map Ctrans do x substitute x, A Î» 2Î¼, C Î» 2 Î¼, N Î¼, F Î», L Î¼ end variables u 1 3 vector displacement field x 1 3 g 1 3 p Real syms Uâ‚ t Uâ‚‚ t Uâ‚ƒ t syms xâ‚ xâ‚‚ xâ‚ƒ syms f xâ‚, xâ‚‚, xâ‚ƒ syms T xâ‚, xâ‚‚, xâ‚ƒ f x... syms t U Uâ‚ t , Uâ‚‚ t , Uâ‚ƒ t U 2 syms Ä± Ï‰ variables e 1 3, 1 3 strain tensor function get cijkl C C i isequal i, j 1 isequal i, j 9 i j , k isequal k, l 1 isequal k, l 9 k l for i in 1 3, j in 1 3, k in 1 3, l in 1 3 end ciso get cijkl Ciso for isotropic einsum Ïƒiso i, j ciso i, j, k, l e k, l utrail1 exp Ä± Ï‰ t p dot s, x variables x 1 3 position vector ~ x, y, z D Differential xâ‚ , Differential xâ‚‚ , Differential xâ‚ƒ D 1 u Dt Differential t einsum uddot i ciso i, j, k, l D j D l u k einsum uddot trail1 i ciso i, j, k, l D j D l T xâ‚, xâ‚‚, xâ‚ƒ D 1 U 1 t T x 1 , x 2 , x 3 | expand derivatives U 1 x 1 Dt Dt f x 1 , x 2 , x 3 U k for k in 1 3 md\"\"\" Eikonal Equation Interactive Seismology Notebooks https pawbz.github.io Interactive Seismology.jl Instructor Pawan Bharadwaj , Indian Institute of Science, Bengaluru, India \"\"\" md\"\"\" The stress tensor three dimensions is given by ```math \\sigma \\begin bmatrix \\sigma 11 & \\sigma 12 & \\sigma 13 \\\\ \\sigma 12 & \\sigma 22 & \\sigma 23 \\\\ \\sigma 13 & \\sigma 23 & \\sigma 33 \\\\ \\end bmatrix ``` | | | | | | | | | Ïƒ 11 bind Ïƒ11 Scrubbable 1 0.01 1, default 1 | Ïƒ 22 bind Ïƒ22 Scrubbable 1 0.1 1, default 0 | Ïƒ 33 bind Ïƒ33 Scrubbable 1 0.1 1, default 0.5 | | Ïƒ 12 bind Ïƒ12 Scrubbable 1 0.1 1, default 0.5 | Ïƒ 23 bind Ïƒ23 Scrubbable 1 0.1 1, default 0 | Ïƒ 13 bind Ïƒ13 Scrubbable 1 0.1 1, default 0 | which is symmetric. \"\"\" bind resample normal CounterButton \"Resample Imaginary Plane\" md\" UI and Plotting\" md\"\"\" Let us define the functions that we will be using in this notebook. \"\"\" Ïƒinput let Ïƒ11 Ïƒ12 Ïƒ13 Ïƒ12 Ïƒ22 Ïƒ23 Ïƒ13 Ïƒ23 Ïƒ33 end eigsigma eigen Ïƒinput nsample let resample normal n randn 3 n n . sqrt sum abs2, n end Tinput Ïƒinput nsample function plot3lines 1 v, color, name p1 scatter3d x 0, v 1 , y 0, 0 , z 0, 0 , mode \"lines\", name name, line attr color color , p2 scatter3d x 0, 0 , y 0, v 2 , z 0, 0 , mode \"lines\", name name, line attr color color , p3 scatter3d x 0, 0 , y 0, 0 , z 0, v 3 , mode \"lines\", name name, line attr color color , return p1, p2, p3 end function plot3lines 2 v1,v2,v3, color, name p1 scatter3d x 0, v1 1 , y 0, v1 2 , z 0, v1 3 , mode \"lines\", name name, line attr color color , p2 scatter3d x 0, v2 1 , y 0, v2 2 , z 0, v2 3 , mode \"lines\", name name, line attr color color , p3 scatter3d x 0, v3 1 , y 0, v3 2 , z 0, v3 3 , mode \"lines\", name name, line attr color color , return p1, p2, p3 end function stress plot p1 cone x 0 , y 0 , z 0 , u nsample 1 , v nsample 2 , w nsample 3 , name \"Surface Normal\", hoverinfo \"name\", showscale false, opacity 0.5, anchor \"tail\", color \"black\", colorscale colors.Blues 8, sizeref 0.5 p2 scatter3d x 0, nsample 1 , y 0, nsample 2 , z 0, nsample 3 , mode \"lines\", name \"Normal Vector\", line attr color \"gray\" , p3 plot3lines 1 Tinput, \"red\", \"Traction\" p4 plot3lines 2 collect eachcol eigsigma.vectors . eigsigma.values ..., \"blue\", \"Principal\" layout Layout scene camera eye attr x 0, y 0, z 0 , width 600, height 500, uirevision 1, scene attr xaxis attr nticks 10, range 1,1 , yaxis attr nticks 10, range 1,1 , zaxis attr nticks 10, range 1,1 , , return plot p1, p2, p3..., p4... , layout end stress plot md\"\"\" Appendix \"\"\" md\" Tikz\" tikz default options raw\"\"\" background rectangle .style fill white , show background rectangle, \"\"\" tikz preamble raw\"\"\" \\usepackage tikz \\usepackage tikz 3dplot \\usetikzlibrary fit, matrix, shapes.geometric \\tikzset % use tikzset, not tikzstyle cell .style rectangle, rounded corners 5pt, draw, \\tikzset % use tikzset, not tikzstyle cellv .style rectangle, rounded corners 5pt, draw, rotate 90, \\usepackage xifthen \\usetikzlibrary hobby \\usepackage pgfplots \\usepackage fontawesome \\usepackage bm,amsfonts,amsmath \\usetikzlibrary backgrounds,pgfplots.groupplots,snakes \\usepgfplotslibrary patchplots \\pgfplotsset try min ticks 2 \\usepackage pgfplotstable \\usetikzlibrary plotmarks,positioning,spy \\usetikzlibrary shapes.geometric, arrows, fadings \\usepgfplotslibrary groupplots, polar \\usepackage space grffile \\usetikzlibrary % decorations.pathreplacing,% decorations.pathmorphing% \\usetikzlibrary positioning,fit,backgrounds \\usetikzlibrary shapes,arrows \\usetikzlibrary decorations.markings \\usetikzlibrary patterns \\usetikzlibrary plotmarks \\usetikzlibrary fit \\usetikzlibrary intersections \\usepgfplotslibrary fillbetween \\pgfplotsset axis line style black 10 , every axis label .append style black 10 , every axis title .append style black 10 , every tick label .append style black 10 % need for pgfplots \\newcommand \\axisz 0cm \\newcommand \\axisx 0cm \\usetikzlibrary positioning \\usetikzlibrary shapes.geometric \\usetikzlibrary backgrounds \"\"\" t1, t2, t3, tv are texts s1 and s2 are labels with sizes plot plane normal TikzPicture L\"\"\" \\tdplotsetmaincoords 105 30 \\tdplotsetrotatedcoords 00 30 0 \\begin scope tdplot rotated coords \\begin scope canvas is xy plane at z 0 \\fill gray,fill opacity 0.3 2, 3 rectangle 2,3 \\draw very thick 2,0 2,0 \\path 150 2 coordinate H 1.5,0 coordinate X \\pgflowlevelsynccm \\draw very thick, stealth,gray 0,0 30 1.5 \\end scope \\draw stealth H 1,0,0.2 node pos 1.3 H \\draw stealth X 0,1,0.2 node pos 1.3 X \\draw very thick, stealth 0,0,0 coordinate O 0,0,3 node right p \\end scope \\pgfmathsetmacro \\Radius 1.5 \\draw stealth O 2.5 \\Radius,0,0 node pos 1.15 spot 0 \\draw stealth O 0,3.5 \\Radius,0 node pos 1.15 spot 2 \\draw stealth O 0,0,2.5 \\Radius node pos 1.05 spot 1 \"\"\", options tikz default options, preamble tikz preamble, width \"12cm\" plot plane normal TikzPicture L\"\"\" \\tdplotsetmaincoords 60 125 \\tikzset cube .style very thick,black , grid .style very thin,gray , axis .style ,blue,thick , %draw a grid in the x y plane \\foreach \\x in 0.5,0,...,2.5 \\foreach \\y in 0.5,0,...,2.5 \\draw grid \\x, 0.5 \\x,2.5 \\draw grid 0.5,\\y 2.5,\\y %draw the axes \\draw axis 0,0,0 3,0,0 node anchor west x 1 \\draw axis 0,0,0 0,3,0 node anchor west x 2 \\draw axis 0,0,0 0,0,3 node anchor west x 3 %draw the top and bottom of the cube \\draw cube 0,0,0 0,2,0 2,2,0 2,0,0 cycle \\draw cube 0,0,2 0,2,2 2,2,2 2,0,2 cycle %draw the edges of the cube \\draw cube 0,0,0 0,0,2 \\draw cube 0,2,0 0,2,2 \\draw cube 2,0,0 2,0,2 \\draw cube 2,2,0 2,2,2 \"\"\", options tikz default options, preamble tikz preamble, width \"12cm\" plot scatter3d x x, y y, z z, mode \"lines\", name \"Plane\" , scatter3d x 0, normal vector 1 , y 0, normal vector 2 , z 0, normal vector 3 , mode \"lines markers\", name \"Normal Vector\", line attr color \"red\" plot scatter3d x x, y y, z z, mode \"lines\", name \"Plane\" TikzPicture L\"\"\" % Define the unit normal vector \\def\\nx 0.5 % x component of the normal vector \\def\\ny 0.5 % y component of the normal vector \\def\\nz 0.5 % z component of the normal vector % Define the plane equation ax by cz d \\def\\d 1 % Distance from the origin % Calculate the vertices of the small plane \\pgfmathsetmacro \\a 0.5 % Half the side length of the small plane % Calculate two vectors perpendicular to the normal vector using Gram Schmidt process \\pgfmathsetmacro \\ux \\ny \\pgfmathsetmacro \\uy \\nx \\pgfmathsetmacro \\uz 0 \\pgfmathsetmacro \\vx \\nx \\nz \\pgfmathsetmacro \\vy \\ny \\nz \\pgfmathsetmacro \\vz \\nx^2 \\ny^2 % Normalize the perpendicular vectors \\pgfmathsetmacro \\ulen sqrt \\ux \\ux \\uy \\uy \\uz \\uz \\pgfmathsetmacro \\vlen sqrt \\vx \\vx \\vy \\vy \\vz \\vz \\pgfmathsetmacro \\ux \\ux \\ulen \\pgfmathsetmacro \\uy \\uy \\ulen \\pgfmathsetmacro \\uz \\uz \\ulen \\pgfmathsetmacro \\vx \\vx \\vlen \\pgfmathsetmacro \\vy \\vy \\vlen \\pgfmathsetmacro \\vz \\vz \\vlen % Draw the coordinate axes \\draw 0,0,0 3,0,0 node anchor north east x \\draw 0,0,0 0,3,0 node anchor north west y \\draw 0,0,0 0,0,3 node anchor south z % Draw the small plane \\filldraw opacity 0.5 \\a \\ux , \\a \\uy , \\a \\uz \\a \\vx , \\a \\vy , \\a \\vz \\a \\ux , \\a \\uy , \\a \\uz \\a \\vx , \\a \\vy , \\a \\vz cycle % Draw the normal vector \\draw , thick, color red 0,0,0 \\nx,\\ny,\\nz \\node at \\nx,\\ny,\\nz anchor south west \\vec n \"\"\", options tikz default options, preamble tikz preamble, width \"12cm\" "},{"url":"raytheory/ray-theory-eikonal-equation/","title":"Ray Theory and The Eikonal Equation","tags":["raytheory"],"text":" A Pluto.jl notebook v0.19.46 frontmatter title \"Ray Theory and The Eikonal Equation\" tags \"raytheory\" layout \"layout.jlhtml\" description \"This interactive notebook explores the Eikonal equation under the high frequency approximation and its applications in tracing seismic rays in heterogeneous Earth models.\" using Markdown using InteractiveUtils This Pluto notebook uses bind for interactivity. When running this notebook outside of Pluto, the following 'mock version' of bind gives bound variables a default value instead of an error . macro bind def, element quote local iv try Base.loaded modules Base.PkgId Base.UUID \"6e696c72 6542 2067 7265 42206c756150\" , \"AbstractPlutoDingetjes\" .Bonds.initial value catch b missing end local el esc element global esc def Core.applicable Base.get, el ? Base.get el iv el el end end begin using Symbolics using SymbolicUtils using LinearAlgebra using PlutoTeachingTools using PlutoPlotly using PlutoTest using Interpolations using Statistics using ProgressLogging using Latexify using PlutoUI using ImageFiltering using ForwardDiff using Einsum using Eikonal using DrWatson savename end TableOfContents ChooseDisplayMode md\"\"\" Ray Theory and The Eikonal Equation Seismic ray theory is a fundamental tool for understanding how high frequency seismic waves propagate through a smoothly varying Earth medium. It is essential for understanding the imaging of the Earth's interior using seismic data. This interactive notebook explores the Eikonal equation under the high frequency approximation and its applications in tracing seismic rays in heterogeneous Earth models. The derivation of the governing equations of ray theoretical methods and their numerical solutions are presented, with a focus on two dimensional scenarios that can be extended to 3D. An exciting feature of this notebook is that users can input any slowness function of and leverage Julia's automatic differentiation capability to compute the gradient of this function, which is crucial for ray tracing. Interactive Seismology Notebooks https pawbz.github.io Interactive Seismology.jl Instructor Pawan Bharadwaj, Indian Institute of Science, Bengaluru, India \"\"\" md\"\"\" Enter the name of the slowness generating function bind slowness fn name confirm TextField default \"slowness prograde\" \"\"\" md\"\"\" Velocity increases linearly with depth. To use this function type `slowness linear` above. \"\"\" function slowness zlinear z, x return inv 2000.0 abs z 20.0 end function slowness gaussian z, x return inv 2000.0 4000.0 exp x 250 ^2 1e4 exp z 50 ^2 1e4 end function slowness custom z, x you can write a custom function, e.g., return inv 2000.0 abs z abs x end function slowness homogeneous z, x return inv 2000.0 end function slowness LVZ z, x velocity if z 30.0 2000.0 z 20.0 elseif 30.0 z 40.0 2000.0 else 2000.0 z 20.0 end return inv velocity end function slowness prograde z, x velocity if z 50.0 2000 z 10.0 elseif 50.0 z 60.0 6000.0 z 170.0 elseif z 60.0 3100.0 z 20.0 end return inv velocity end md\"\"\" Ansatz We shall assume a solution of the form \"\"\" syms U t syms Ä± md\"...with variables\" syms x Real z Real t Real Ï‰ Real y Real syms Î² x, z Ï x, z Î¼ x, z syms T x, z A x, z travel time and amplitude A x,z Ï• A x, z exp Ä± Ï‰ t T x, z trail solution md\"...and the following operators.\" begin Dx Differential x Dz Differential z Dy Differential y Dt Differential t end D Dx, Dy, Dz L Ï• Ï x, z Dt Dt Ï• Dx Î¼ x, z Dx Ï• Dz Î¼ x, z Dz Ï• md\"Here, T denotes the travel time and A denotes the amplitude. Now, let's check the terms after substituting the solution \\phi into the scalar homogeneous wave equation.\" args LÏ• arguments simplify substitute simplify expand derivatives L Ï• , Ä±^2 1 md\"\"\" High frequency Approximation This approximation ignores the terms that are sufficiently small in the far field, i.e. when the high frequencies are considered. In this case, we shall divide the arguments obtained after substituting Ï•â‚‚ in the 2 D wave equation with Ï‰^2 , and ignore \\frac 1 Ï‰^2 terms when \\omega is sufficiently large. \"\"\" map simplify, args LÏ• . Ï‰^2 md\"\"\" This results in the 2D Eikonal equation. \"\"\" begin eik T Dx T x, z ^2 Dz T x, z ^2 1 Î² x, z ^2 eik T ~ 0 end md\"... and\" begin eikA A 2 dot Symbolics.gradient A x, z , x, z , Symbolics.gradient T x, z , x, z A x, z Dx Dx T x, z Dz Dz T x, z eikA A ~ 0 end tip md\"\"\" Note the similarity of the above Eikonal equation to the dispersion relation we derived using a plane wave solution of the homogeneous scalar wave equation. The magnitude of the wavenumber vector \\vec k should be equal to Ï‰^2 Î±^2 , which also constrains the magnitude of the slowness vector \\vec s to 1 Î±^2 .\"\"\" tip md\"\"\"... when solving the Eikonal equation, we think of a local plane wave at x,z with corresponding slowness vector \\vec s x,z . Take a moment to realize that Dx T gives the x component of the slowness vector. \"\"\" md\"\"\" Wavefronts The function T x,y,z const. defines surfaces called wavefronts. For a medium with homogeneous elastic properties, these wavefronts are spherical. They can have arbitrary shapes in the presence of medium heterogeneities. \"\"\" md\"\"\" Raypath Tracing Lines perpendicular to the wavefronts i.e. T x,y,z const. surfaces are termed rays. In other words, rays are parallel to the gradient of the travel time function âˆ‡T x,y,z . If \\hat s denoted the direction along \\nabla T , then ```math \\nabla T x,y,z \\vec s x,z |\\vec s x,z |\\hat s x,z , \\qquad\\qquad 1 ``` where |\\vec s | \\frac 1 Î± is the local slowness. We shall start this section by declaring the necessary symbols. \"\"\" begin syms s x Real, z Real Real slowness syms sx x Real, z Real Real slowness vector x component syms sz x Real, z Real Real ... end svec sx x, z , sz x, z slowness vector The Jacobian Matrix J Symbolics.jacobian svec, x, z md\"\"\" The journey along a ray begins at the source, where we choose the direction of the outgoing plane wavefronts \\hat s 0 . Denoting the source position with \\vec p 0 , we simply move along \\hat s 0 by an incremental length dl , and the updated position is given by ```math \\vec p 1 \\vec p 0 \\hat s 0 \\,dl. \\qquad\\qquad 2 ``` In order to trace the ray path further, we need to estimate the change in s as we moved from \\vec p 0 to \\vec p 1 . Note that the plane wave that we are riding gets transformed as it propagates in the medium due to changes in the slowness s |\\vec s | . In order to estimate this change, we shall first consider a Jacobian Matrix `J` J. Then, we will simplify the derivative of \\vec s with respect to the length along the ray path l , which is `dsdl` `J` \\hat s , using the Eikonal equation, to get `dsdl` \\nabla\\,s . Finally, the slowness vector at the new position \\vec p 1 is given by ```math \\vec s 1 \\vec s 0 \\nabla\\,s\\,dl. \\qquad\\qquad 3 ``` This notebook solves equations 2 and 3 numerically to trace the ray path in 2 D heterogeneous media. \"\"\" dsdl1 J svec . s x, z md\"\"\" Using equation 1 , we shall now substitute `sx` and `sz` in `dsdl` and simplify. \"\"\" dsdl2 broadcast dsdl1 do â‹… simplify substitute â‹…, sx x, z Dx T x, z , sz x, z Dz T x, z end r1 acrule Dx Dx ~T Dx ~T ~B ~A 1 2 Dx Dx ~T Dx ~T ~B ~A r2 acrule ~B Dz Dx ~T Dz ~T ~A ~B 1 2 Dx Dz ~T Dz ~T ~A r3 acrule Dz Dz ~T Dz ~T ~B ~A 1 2 Dz Dz ~T Dz ~T ~B ~A r4 acrule ~B Dx Dz ~T Dx ~T ~A ~B 1 2 Dz Dx ~T Dx ~T ~A dsdl4 r1 r2 dsdl2 1 , r4 r3 dsdl2 2 dsdl3 r1 r2 dsdl2 1 , r4 r3 dsdl2 2 r5 acrule ~A Dx ~B ~A Dx ~C ~D ~A Dx ~B ~C ~D r6 acrule ~A Dz ~B ~A Dz ~C ~D ~A Dz ~B ~C ~D md\"\"\" We can now finally use the Eikonal equation to derive equation 3 . \"\"\" dsdl expand derivatives. substitute. dsdl4, Dx T x, z Dx T x, z Dz T x, z Dz T x, z s x, z s x, z tip md\"From this derivation, it is obvious that `dsdl` determines how the horizontal and vertical components of the slowness vector change along the raypath. For example, if Dx s x,z is zero in a layered Earth medium, the horizontal slowness remains constant \" test iszero dsdl . Symbolics.gradient s x, z , x, z md\"\"\" Amplitudes \"\"\" eikA A ~ 0 begin eikA arg A simplify expand derivatives substitute eikA A , Dx T x, z sx x, z , Dz T x, z sz x, z eikA arg A end md\"\"\" Lets assume a solution of the form `A x, z exp AÌƒ x, z `. \"\"\" syms AÌƒ x Real, z Real eikAÌƒ1 expand derivatives substitute eikA arg A , A x, z exp AÌƒ x, z eikAÌƒ2 simplify eikAÌƒ1 exp AÌƒ x, z eikAÌƒ sum arguments eikAÌƒ2 1 2 2 s x, z ~ sum arguments eikAÌƒ2 3 4 s x, z 2 md\"\"\" The LHS of the above equation corresponds to the projection of the gradient of A along the ray path. We can now integrate along the ray path to obtain the amplitude. \"\"\" syms âˆ«â‚šâ‚â‚œâ‚• x exp âˆ«â‚šâ‚â‚œâ‚• eikAÌƒ.lhs md\"\"\" Intuition Divergence of the slowness field. \"\"\" md\"\"\" Appendix \"\"\" md\"\"\" UI \"\"\" function layered medium input n n is the number of layers return PlutoUI.combine do Child inputs md\"\"\" Layer string i Child string \"L\",i , Slider 1000 10000, default 1000 i 1000, show value true \"\"\" for i in 1 n md\"\"\" Layered Earth These sliders are only active if you input `slowness layered` below. Adjust the seismic velocities âˆˆ 1, 10 km s. inputs \"\"\" end end md\"\"\" Medium \"\"\" begin dx 0.5 choosing dx other than 1.0 needs adjustment for Eikonal package zgrid range 0.0, stop 150.0, step dx xgrid range 0.0, stop 500.0, step dx end function source input return PlutoUI.combine do Child dinput md\"\"\" Î¸âˆˆ 1, 360 Child \"Î¸\", RangeSlider range 0, stop 360, step 5 left 0, right 60, show value true \"\"\" for i in 1 1 linput md\"\"\" x Child string x, \"pos\" , Slider grid, default 10, show value true \"\"\" for x, grid in zip \"x\", \"z\" , xgrid, zgrid md\"\"\" Source Parameters Adjust the position from which the ray originates. linput... The direction of the outgoing slowness vector. dinput... \"\"\" end end TwoColumn md\"\"\" bind lmedium confirm layered medium input 5 \"\"\", md\"\"\" bind source confirm source input \"\"\" begin layers getindex lmedium, k for k in Symbol. filter x occursin \"L\", x , string. keys lmedium convert the input velocity values to a slowness field zlayer collect range zgrid 1 , stop zgrid end , length length layers xlayer xgrid 1 , xgrid end slayer inv. collect layers slayer itp extrapolate interpolate zlayer, xlayer , hcat slayer, slayer , Gridded Interpolations.Linear , Flat end slowness layered z, x slayer itp z, x slowness z, x eval Symbol slowness fn name z, x slowness grid slowness z, x for z in zgrid, x in xgrid begin slowness x z, x ForwardDiff.derivative x slowness z, x , x slowness z z, x ForwardDiff.derivative z slowness z, x , z end md\" Trace\" pa slowness, slowness x, slowness z, xgrid, zgrid ds 1.0 function get raypaths N, ds, Xsource, initial slowness vectors, pa slowness, slowness x, slowness z, xgrid, zgrid pa Xrays map initial slowness vectors do slowness vector keep the direction of S init, but adjust the magnitude to match the slowness at the source slowness vector slowness vector . norm slowness vector . norm slowness Xsource 1 , Xsource 2 Xraysave Array Any missing, 2, N Xray deepcopy Xsource S deepcopy slowness vector for i 1 N Xs view Xraysave, , i copyto Xs, Xray equation 2 Xray 1 Xray 1 S 1 slowness Xray 1 , Xray 2 ds Xray 2 Xray 2 S 2 slowness Xray 1 , Xray 2 ds equation 3 S 1 S 1 ds slowness z Xray 1 , Xray 2 S 2 S 2 ds slowness x Xray 1 , Xray 2 exit, if the ray reaches the edge of the medium Xray 2 xgrid 1 && Xray 2 xgrid end && Xray 1 zgrid 1 && Xray 1 zgrid end && break end return Xraysave end return Xrays end raypaths get raypaths 500, ds, source.zpos, source.xpos , sind Î¸ , cosd Î¸ for Î¸ in source.Î¸ , pa md\"Now lets integrate slowness along the raypaths to get traveltimes.\" function get raytraveltimes N, Xrays, pa slowness, slowness x, slowness z, xgrid, zgrid pa traveltimes map Xrays do Xray Xray filter x any ismissing. x , eachslice Xray, dims 2 traveltime Array Any missing, N traveltime 1 0.0 for i 2 length Xray this is supposed to be constant, as we are moving a fixed length along the ray during ray tracing, but anyway... distance sqrt sum abs2. Xray i Xray i 1 traveltime i traveltime i 1 distance slowness Xray i 1 1 , Xray i 1 2 end return traveltime end end raytraveltimes get raytraveltimes 500, raypaths, pa begin findout if the ray intersects the surface z 0 , if yes, return the index along the ray Iz0 map raypaths, raytraveltimes do raypath, raytt Xray filter x any ismissing. x , eachslice raypath, dims 2 i findlast x x 1 1 , Xray end return traveltime, when ray intersects the surface rayXtraveltimes map raytraveltimes, Iz0 do raytt, i if i nothing return missing else return raytt i end end return distance to the point where ray intersects the surface rayX map raypaths, Iz0 do raypath, i if i nothing return missing else return raypath 2, i end end end md\" Eikonal\" begin fastsweep FastSweeping slowness grid init fastsweep, argmin abs. source.zpos . zgrid , argmin abs. source.xpos . xgrid sweep fastsweep, verbose false end TT grid fastsweep.t dx traveltime to each x,z function diff2 z u, dx u2 zero u for ix in 1 size u, 2 u2 2 end 1, ix . u 1 end 2, ix . 2u 2 end 1, ix . u 3 end, ix . dx^2 end return u2 end function diff2 x u, dx u2 zero u for iz in 1 size u, 1 u2 iz, 2 end 1 . u iz, 1 end 2 . 2u iz, 2 end 1 . u iz, 3 end . dx^2 end return u2 end div s grid diff2 x TT grid, dx diff2 z TT grid, dx md\" Amplitudes\" function get amplitudes raypaths amplitudes map raypaths do raypath amps Array Any missing, size raypath, 2 amp 0.0 initialize for i, p in enumerate eachslice raypath, dims 2 if any . ismissing. p ipz argmin abs. p 1 . zgrid ipx argmin abs. p 2 . xgrid amp amp 2.0 div s grid ipz, ipx slowness p 1 , p 2 amps i amp end end return exp. amps end return amplitudes end amplitudes get amplitudes raypaths md\"\"\" Plots \"\"\" begin source create a plot object `rayplot` that will be updated later rayplot Plot Layout showlegend false, yaxis autorange \"reversed\", height 250, width 700, title attr font size 12, , legend attr x 0.6, y 0.0, , font attr size 10 , yaxis attr scaleanchor \"x\" , Subplots horizontal spacing 0.3, rows 1, cols 1, subplot titles \"2 D x, z Ray Tracing\" \"\" add velocity model to `rayplot` add trace rayplot, heatmap x xgrid, y zgrid, z inv. slowness grid , colorscale \"Cividis\", colorbar title \"Velocity br m s \", colorbar x 1 , row 1, col 1 end update `rayplot` by adding a raypath that was just traced function update rayplot rayplot, raypaths map raypaths, amplitudes do raypath, amplitude add trace rayplot, scatter x raypath 2, , y raypath 1, , mode \"markers\", marker attr size 1, color log. amplitude , colorscale \"Blackbody\" , line attr color \"black\", width 1.5 , name savename source , , row 1, col 1 end return nothing end begin update rayplot rayplot, raypaths PlutoPlotly.plot rayplot end function plot tt contours plot contour x xgrid, y zgrid, z TT grid, showlabels true, colorscale \"Viridis\", contours attr coloring \"heatmap\", showlabels true, show labels on contours labelfont attr label font properties size 12, color \"white\", , Layout title \"First Arrival Traveltimes\", yaxis autorange \"reversed\", height 250, width 700, colorbar false, yaxis attr scaleanchor \"x\" , end plot tt contours function plot traveltimes trPlot Plot Layout showlegend false, margin 0.5, height 300, width 680, title attr font size 12, , xaxis attr range 0, maximum xgrid , legend attr x 0.6, y 0.0, , font attr size 10 , Subplots horizontal spacing 0.1, rows 1, cols 2, subplot titles \"First Arrival Traveltime\" \"Raytracing Traveltime\" , x title \"Distance\", y title \"Traveltime\", shared yaxes true add trace trPlot, scatter x xgrid, y TT grid 1, , mode \"markers\", marker attr size 2 , col 1, row 1 add trace trPlot, scatter x rayX, y rayXtraveltimes, mode \"markers lines\", marker attr size 5 , col 2, row 1 return plot trPlot end plot traveltimes md\" TODO\" md\"\"\" Amplitudes Prove Fermat Principle using Variational Calculus \"\"\" md\"\"\" Fermat's principle Consider two points A and B . We would like to show that the ray function minimizes the total travel time from A to B . In variational calculus, we are trying to find a function that minimizes a functional. The travel time is given by the integral ```math \\mathbb T \\int A^B s x \\,dl ``` Notice that this equation of \\mathbb T is nonlinear in the slowness field as the integration path depends on the velocity. In order to consider all other paths, let's consider some \\eta x that is an arbitrary path and scale it by a factor \\epsilon . \\epsilon\\eta x is the variation of s x . \\eta is twice differentiable. ```math \\bar s x s x \\epsilon\\eta x ``` ```math \\eta A \\eta B 0 ``` Now we are going to set the derivative of I w.r.t. to \\epsilon be zero. ```math \\frac d\\mathbb T d\\epsilon | \\epsilon 0 ``` ```math \\int A^B \\eta x ``` \"\"\" "},{"url":"raytheory/ray-tomography/","title":"Ray Tomography","tags":["raytheory"],"text":" A Pluto.jl notebook v0.19.46 frontmatter title \"Ray Tomography\" tags \"raytheory\" layout \"layout.jlhtml\" description \"This notebook focuses on the inverse formulation of 2 D first arrival travel times.\" using Markdown using InteractiveUtils This Pluto notebook uses bind for interactivity. When running this notebook outside of Pluto, the following 'mock version' of bind gives bound variables a default value instead of an error . macro bind def, element quote local iv try Base.loaded modules Base.PkgId Base.UUID \"6e696c72 6542 2067 7265 42206c756150\" , \"AbstractPlutoDingetjes\" .Bonds.initial value catch b missing end local el esc element global esc def Core.applicable Base.get, el ? Base.get el iv el el end end begin using Pluto using PlutoPlotly using PlutoTest using PlutoTeachingTools using LinearAlgebra using Distances using StatsBase using PlutoUI using TikzPictures using Colors, ColorSchemes,GLMNet end ChooseDisplayMode TableOfContents md\"\"\" Ray Tomography Seismic tomography is a method used to create images of the Earth's subsurface using seismic waves generated by earthquakes or explosions. These waves, known as P , S , and surface waves, can be used to create tomographic models with varying resolutions, depending on factors such as the wavelength of the seismic waves, the distance of the wave source, and the source receiver geometry. The process of creating these models is treated as an inverse problem, and this notebook specifically focuses on analyzing 2 D inversions of first arrival travel times. By interacting with this notebook, users will be able to Visualize tomograms for various source receiver configurations Understand the concept of ill posedness and the need for regularization Learn about the principle of backpropagation And gain more insight into the field of seismic tomography Interactive Seismology Notebooks https pawbz.github.io Interactive Seismology.jl Instructor Pawan Bharadwaj , Indian Institute of Science, Bengaluru, India \"\"\" md\"\"\" Forward Problem In order to create an accurate image of the Earth's subsurface using seismic tomography, we need to first generate observed data. To do this, we will construct the forward operator G , which takes into account the model grid and the source receiver setup. The forward problem is represented by the equation G\\times\\,s , where s is the model slowness vector. In this process, we will generate true seismic velocity and slowness arrays based on user input. These arrays will then be used to generate synthetic observations. \"\"\" md\"\"\" Row Picture The row picture of G \\times s illustrates the relationship between the slowness vector and the traveltime errors. It shows that the raypaths rows of G that have the strongest correlation with the slowness vector will have a higher traveltime error when compared to the others. This is because when a raypath passes through all the perturbed pixels of the medium, it will experience a greater delay, leading to a higher traveltime residual. In other words, the higher the correlation of a raypath with slowness vector, the more it is affected by the perturbations in the medium and hence higher traveltime residual. \"\"\" md\" Column Picture The column picture of G \\times s gives insight into the tradeoff between different pixels in the model grid. When two pixels are illuminated by a similar set of raypaths, they appear as dependent columns in the matrix G . As a result, these dependent columns can be linearly combined to produce no effect on the observed travel times. This means that changes in the slowness in these dependent pixels will not have any effect on the calculated traveltimes, and thus the solution to the inverse problem is not unique. It is important to keep in mind the tradeoff between these pixels while solving the inverse problem, and regularization may be needed to obtain a unique solution. \" md\"\"\" Backpropagation Gradient is formed by backpropagation of traveltime residuals. \"\"\" md\"\"\" Column Picture The column picture of G^ \\text T \\times \\Delta d illustrates how the traveltime residuals are distributed across the model grid. It represents a weighted sum of the raypaths, where the weights are given by the traveltime residuals. This means that higher values in the model will be spread along the raypaths whose associated traveltimes do not match the observed traveltimes. \"\"\" md\"\"\" Row Picture The row picture of G^ \\text T \\times \\Delta d represents the correlation between the model pixels and the data residuals. It shows that the model pixels whose ray distribution corresponds with the data residuals are given a larger weight. In other words, pixels that are intersected by high residual rays are highlighted, or this means that the pixels in the model that are most responsible for the residuals in the data will be given more weight in the image. \"\"\" md\"\"\" Inverse Problem Here, we shall simply use the Moore Penrose pseudoinverse to map the observed travel times to slowness estimates. Note that the forward operator will now be generated again, based on the user input on spatial sampling of the seismic slowness, which is usually smaller compared to what we have used for generating the observed data above. \"\"\" md\"Finally, we will take the inverse of slowness and reshape it to produce the final 2 D seismic velocity model.\" md\"Check if the observations are satisfied by the estimated model.\" md\"\"\" As a sanity check, we will now test the operator `G` by computing travel times in a homogeneous medium analytically. This will make sure that raytracing is done correctly. \"\"\" get inverse operator using SVD damped least squares also returns the singular values for viz. commented for now function get inverse operator G U, S, V svd G Gi V Diagonal inv. S . 1e 1 U' return Gi, S end md\" Uncertainity\" md\" Scree plot https en.wikipedia.org wiki Scree plot ~ text In%20multivariate%20statistics%2C%20a%20scree,principal%20component%20analysis%20 PCA . \" md\"Slider to choose the row of the Hessian matrix.\" md\"\"\" We will now vis. rows of data and model resolution matrices. \"\"\" md\" Appendix\" define a for modelling and inversion md\"\"\" `get medium` generates a medium with a background velocity of 2000 m s, and a circular perturbation. It outputs the velocity matrix and the corresponding slowness vector. \"\"\" function get medium xgrid, zgrid, pert nothing nx length xgrid nz length zgrid ctrue 2000.0 ones nz 1, nx 1 if pert nothing check if perturbation is required for iz in 1 nz 1, ix in 1 nx 1 if sqrt sum abs2. xgrid ix pert.x, zgrid iz pert.z pert.r ctrue iz, ix 100 end end end strue vec inv. ctrue return ctrue, strue end md\"\"\" Methods for straight ray tracing \"\"\" warn \"The straight ray implementation in this notebook requires sources and receivers on the outer edge of the 2 D grid, i.e., arbitrary positions are not allowed.\" careful before changing these only place sources and receivers on the outer edge of the grid function get source receivers outer edge xgrid, zgrid, ns, nr srcz ns 1 ? sample zgrid range zgrid 2 , stop zgrid end 1 , length ns srcx fill xgrid 1 , ns recz nr 1 ? sample zgrid range zgrid 2 , stop zgrid end 1 , length nr recx fill xgrid end , nr return srcz, srcx, recx, recz end find intersect b w two segments returns nothing if segments are parallel segments do not intersect else returns the point of intersection including C and D i.e., h 0 or h 1 function find intersect A1, A2, B1, B2, C1, C2, D1, D2 E B A F D C D1 C1, D2 C2 P A2 B2, B1 A1 dFP D1 C1 A2 B2 B1 A1 D2 C2 if iszero dFP when parallel return nothing end h A1 C1 A2 B2 A2 C2 B1 A1 dFP if h h 1 0 | h â‰ˆ 0 | h â‰ˆ 1 h should be in 0, 1 or h 0 or h 1 return C1 h D1 C1 , C2 h D2 C2 else return nothing end end function find length in cell xmin, xmax, zmin, zmax, A1, A2, B1, B2 P1 find intersect A1, A2, B1, B2, xmin, zmin, xmin, zmax P2 find intersect A1, A2, B1, B2, xmin, zmin, xmax, zmin P3 find intersect A1, A2, B1, B2, xmin, zmax, xmax, zmax P4 find intersect A1, A2, B1, B2, xmax, zmin, xmax, zmax P filter x x nothing , P1, P2, P3, P4 P unique P if length P 2 remove sides that will be otherwise counted twice by adjacent cells if xmin, zmax âˆˆ P & xmax, zmax âˆˆ P return 0 elseif xmax, zmin âˆˆ P & xmax, zmax âˆˆ P return 0 else return maximum broadcast x sqrt sum abs2. x , diff P end else return 0 end end function get forw operator xgrid, zgrid, srcx, srcz, recx, recz nx length xgrid nz length zgrid ns length srcx nr length recx G zeros ns nr, nx 1 nz 1 for is in 1 ns, ir in 1 nr, iz in 1 nz 1, ix in 1 nx 1 G ir is 1 nr, iz ix 1 nz 1 find length in cell xgrid ix , xgrid ix 1 , zgrid iz , zgrid iz 1 , srcx is , srcz is , recx ir , recz ir end return G end md\"\"\" UI \"\"\" function perturbation input xgrid, zgrid nx length xgrid nz length zgrid return PlutoUI.combine do Child p md\"\"\" x Child \"x\", Slider xgrid, default xgrid div nx,2 , show value true and z Child \"z\", Slider zgrid, default zgrid div nz,2 , show value true \"\"\", r md\"\"\" Child \"r\", Slider range 10, stop 500, length 10 , default 330, show value true \"\"\", md\"\"\" Medium Parameters Circular perturbation at p with radius âˆˆ 10, 500 m r \"\"\" end end function resolution input return PlutoUI.combine do Child d md\"\"\" Resolution m of true Child \"ds\", Slider range 10,stop 200 , default 25, show value true and inverted Child \"ds inv\", Slider range 10,stop 200 , default 150, show value true media \"\"\", md\" d \" end end bind res confirm resolution input begin xgrid range 1000, stop 1000, length floor Int, 2000 res.ds zgrid range 1000, stop 1000, length floor Int, 2000 res.ds end bind pert confirm perturbation input xgrid, zgrid ctrue, strue get medium xgrid, zgrid, pert begin xgrid inv range 1000, stop 1000, length floor Int, 2000 res.ds inv zgrid inv range 1000, stop 1000, length floor Int, 2000 res.ds inv end bind irowm Slider 1 length xgrid inv 1 length zgrid inv 1 , show value true, default div length xgrid inv length zgrid inv , 4 function acq input return PlutoUI.combine do Child d md\"\"\" Choose number of sources Child \"ns\", Slider 2 2 50, show value true, default 25 and receivers Child \"nr\", Slider 2 2 50, show value true, default 25 \"\"\", md\"\"\" Acquisition Setup d \"\"\" end end bind acq confirm acq input srcz, srcx, recx, recz get source receivers outer edge xgrid, zgrid, acq.ns, acq.nr Gtrue get forw operator xgrid, zgrid, srcx, srcz, recx, recz dobs Gtrue strue G get forw operator xgrid inv, zgrid inv, srcx, srcz, recx, recz plot heatmap z G , Layout xaxis title \"model vector index\", yaxis autorange \"reversed\", yaxis title \"data vector index\", width 450, title \"Forward Operator\" Gi pinv G compute Moore Penrose pseudoinverse sest Gi dobs inverse map cest reshape inv. sest , length zgrid inv 1, length xgrid inv 1 plot scatter y dobs, name \"observed\" , scatter y G sest, name \"predicted\" , Layout title \"Data Residual Observed Vs. Predicted Traveltimes \", xaxis title \" raypath\", yaxis title \"traveltime\" function plot G scree s svd G plot s.S, Layout title \"Singular values of G\" end plot G scree plot heatmap z transpose G G , Layout yaxis autorange \"reversed\", title \"the Hessian matrix\", xaxis title \"model index\", yaxis title \"model index\", width 450 plot heatmap x xgrid inv, y zgrid inv, z reshape transpose G G irowm, , length zgrid inv 1, length xgrid inv 1 , Layout yaxis autorange \"reversed\", title \"row of the Hessian matrix\", width 450 plot heatmap x xgrid inv, y zgrid inv, z reshape Gi G irowm, , length zgrid inv 1, length xgrid inv 1 , Layout yaxis autorange \"reversed\", title \"Row of Model Resolution Matrix\", width 450 begin tt analytic vec sqrt sum abs2. srcx is recx ir , srcz is recz ir inv 2000 for ir in 1 acq.nr, is in 1 acq.ns tt G G inv. fill 2000, length zgrid inv 1 length xgrid inv 1 test tt analytic â‰ˆ tt G end data residual tt G dobs grad slowness reshape G' data residual, length zgrid inv 1, length xgrid inv 1 c Dict \"Backpropagate the data residual\" grad slowness, \"Estimate seismic velocity\" cest md\"\"\" What do you want to do? bind ckey Select collect keys c \"\"\" bind irowd Slider 1 acq.nr acq.ns, show value true plot G Gi irowd, , Layout title \"Row of data resolution matrix\", xaxis title \"raypath index\" md\" Plots\" function plot models fig Plot Layout yaxis autorange \"reversed\", height 300, width 650, title attr font size 12, , font attr size 10 , yaxis attr scaleanchor \"x\" , Subplots shared xaxes true, shared yaxes true, horizontal spacing 0.3, rows 1, cols 2, subplot titles \"True Seismic Velocity\" ckey add trace fig, heatmap x xgrid, y zgrid, z reshape ctrue, length zgrid 1, length xgrid 1 , colorscale \"jet\", colorbar x 0.35 , row 1, col 1 add trace fig, heatmap x xgrid inv, y zgrid inv, z c ckey , colorscale \"jet\", colorbar x 1.0 , row 1, col 2 return PlutoPlotly.plot fig end plot models data residual colors get. Ref colorschemes seismic , data residual . minimum data residual . maximum data residual ray setup broadcast reshape 1 acq.nr, acq.nr, 1 , reshape 1 acq.ns, 1, acq.ns do ir, is scatter x srcx is , recx ir , y srcz is , recz ir , marker attr symbol \"asterisk\", \"triangle down\" , size 10, 10 , line attr color \"black\" , color data residual colors ir is 1 acq.nr , opacity 0.15, mode \"lines markers\", end function plot ray setup return plot vec ray setup , Layout yaxis autorange \"reversed\", font attr size 10 , showlegend false, width 450, title \"Ray Geometry br red ray paths have higher data residuals \", yaxis tickvals zgrid inv, xaxis tickvals xgrid inv, xaxis attr title \"x\", ticks \"outside\", tickwidth 1, tickcolor \"black\", ticklen 10, gridcolor \"gray\" , yaxis attr title \"z\", scaleanchor \"x\", ticks \"outside\", tickwidth 1, tickcolor \"black\", ticklen 10, gridcolor \"gray\" , xaxis zeroline false, yaxis zeroline false, end plot ray setup md\" Tikz\" tikz default options raw\"\"\" background rectangle .style fill white , show background rectangle, \"\"\" tikz preamble raw\"\"\" \\usepackage tikz \\usepackage tikz \\usetikzlibrary fit, matrix, shapes.geometric \\tikzset % use tikzset, not tikzstyle cell .style rectangle, rounded corners 5pt, draw, \\tikzset % use tikzset, not tikzstyle cellv .style rectangle, rounded corners 5pt, draw, rotate 90, \\usepackage xifthen \\usetikzlibrary hobby \\usepackage pgfplots \\usepackage fontawesome \\usepackage bm,amsfonts,amsmath \\usetikzlibrary backgrounds,pgfplots.groupplots,snakes \\usepgfplotslibrary patchplots \\pgfplotsset try min ticks 2 \\usepackage pgfplotstable \\usetikzlibrary plotmarks,positioning,spy \\usetikzlibrary shapes.geometric, arrows, fadings \\usepgfplotslibrary groupplots, polar \\usepackage space grffile \\usetikzlibrary % decorations.pathreplacing,% decorations.pathmorphing% \\usetikzlibrary positioning,fit,backgrounds \\usetikzlibrary shapes,arrows \\usetikzlibrary decorations.markings \\usetikzlibrary patterns \\usetikzlibrary plotmarks \\usetikzlibrary fit \\usetikzlibrary intersections \\usepgfplotslibrary fillbetween \\pgfplotsset axis line style black 10 , every axis label .append style black 10 , every axis title .append style black 10 , every tick label .append style black 10 % need for pgfplots \\newcommand \\axisz 0cm \\newcommand \\axisx 0cm \\usetikzlibrary positioning \\usetikzlibrary shapes.geometric \\usetikzlibrary backgrounds \"\"\" t1, t2, t3, tv are texts s1 and s2 are labels with sizes plot tikzrow t1, t2, tn, tv s1 \"\", s2 \"\" TikzPicture L\"\"\" \\matrix matrix of nodes, nodes in empty cells, minimum width 4cm, column sep 4pt, row sep 10pt, text height 2ex, text depth .25ex, minimum height 4ex, left delimiter , right delimiter , m | cell | % t1 \\\\ | cell | % t2 \\\\ | cell | \\cdots \\\\ | cell | % tn \\\\ \\matrix right of m, matrix of nodes, nodes in empty cells, %minimum width 4cm, column sep 4pt, row sep 10pt, text height 2ex, text depth .25ex, %minimum height 4cm, left delimiter , right delimiter , m2 | rotate 90 | % tv \\\\ \\node below of m2, node distance 5em, % s2 \\node below of m, node distance 6em, % s1 \"\"\", options tikz default options, preamble tikz preamble, width \"12cm\" plot tikzrow \"raypath 1\", \"raypath 2\", \"raypath K\", \"slowness vector\", s1 \"KÃ—N\", s2 \"NÃ—1\" plot tikzrow \"model pixel 1\", \"model pixel 2\", \"model pixel N\", \"data residual\", s1 \"NÃ—K\", s2 \"KÃ—1\" t1, t2, t3, tv are texts s1 and s2 are labels with sizes plot tikzcol t1, t2, tn, tv s1 \"\", s2 \"\" TikzPicture L\"\"\" \\matrix matrix of nodes, nodes in empty cells, minimum width 4cm, minimum height 1cm, column sep 4pt, row sep 10pt, % text height 2ex, rotate 90, text depth .25ex, left delimiter , right delimiter , m | cellv | % t1 & | cellv | % t2 & | cellv | \\cdots & | cellv | % tn \\\\ \\matrix right of m, matrix of nodes, nodes in empty cells, %minimum width 4cm, column sep 4pt, row sep 10pt, text height 2ex, text depth .25ex, %minimum height 4cm, left delimiter , right delimiter , m2 | rotate 90 | % tv \\\\ \\node below of m2,node distance 5em, % s2 \\node below of m, node distance 7em, % s1 \"\"\", options tikz default options, preamble tikz preamble, width \"12cm\" plot tikzcol \"model pixel 1\", \"model pixel 2\", \"model pixel N\", \"slowness vector\", s1 \"KÃ—N\", s2 \"NÃ—1\" plot tikzcol \"raypath 1\", \"raypath 2\", \"raypath K\", \"data residual\", s1 \"NÃ—K\", s2 \"KÃ—1\" "},{"url":"surfacewaves/Love-wave-analytic1/","title":"Love Waves","tags":["surfacewaves"],"text":" A Pluto.jl notebook v0.19.46 frontmatter title \"Love Waves\" tags \"surfacewaves\" layout \"layout.jlhtml\" description \"Dive into the world of plane Love waves in a single homogeneous layer overlying a homogeneous half space, offering a simple yet fascinating exploration of the topic.\" using Markdown using InteractiveUtils This Pluto notebook uses bind for interactivity. When running this notebook outside of Pluto, the following 'mock version' of bind gives bound variables a default value instead of an error . macro bind def, element quote local iv try Base.loaded modules Base.PkgId Base.UUID \"6e696c72 6542 2067 7265 42206c756150\" , \"AbstractPlutoDingetjes\" .Bonds.initial value catch b missing end local el esc element global esc def Core.applicable Base.get, el ? Base.get el iv el el end end using PlutoPlotly, PlutoUI, Roots, Symbolics, SymbolicUtils, FFTW, PlutoTeachingTools, Latexify, PlutoUI, Peaks ChooseDisplayMode TableOfContents md\"\"\" Love Waves This notebook studies the simplest case of plane Love waves in a single homogeneous layer overlying a homogeneous half space. This is an eigenvalue problem, where the boundary and the free surface conditions limit the allowable eigenvalues and eigenfunctions. In other words, for a given frequency, the horizontal slowness can only take special values. It can often happen that more than one value of the horizontal slowness contributes to the Love wave of a particular frequency. By interacting with this notebook, we can visualize the displacement wavefield for different modes notice the cut off frequency of the n th order higher mode. Interactive Seismology Notebooks https pawbz.github.io Interactive Seismology.jl Instructor Pawan Bharadwaj , Indian Institute of Science, Bengaluru, India \"\"\" bind tt Clock 0.1 Markdown.MD Markdown.Admonition \"warning\", \"Observations\", md\"\"\" Use the frequency slider to visualize the seismograms corresponding to a wave packet with a finite frequency band around a given frequency \\omega 0 . Do you observe a sinusoidal oscillation of frequency \\omega 0 modulated by an envelope sinc function ? Perform stationary phase analysis for different time locations on the seismogram and notice the saddle points or points of stationary phase to determine the frequency of the wave packet that can be expected to dominate at a particular time. \"\"\" md\" \" syms Î²â‚ Real Î²â‚‚ Real Î¼â‚ Real Î¼â‚‚ Real Ïâ‚ Real Ïâ‚‚ Real syms H Real md\"\"\" Trail Wavefield We shall now consider a trail solution for the y component of the displacement field, denoted using `u`. This solution considers two planewaves with amplitudes A and B and slowness components p and \\eta . If the planewave if homogeneous \\eta is imaginary. Otherwise, if \\eta is real, we have either exponentially decaying or growing fields with depth with inhomogeneous waves travelling in the x direction. \"\"\" syms p Real Î·â‚‚ Complex syms Ä± Complex Real imaginary unit, going to substitute with im later syms x Real z Real t Real Ï‰ Real trail soln p, Î·, A, B A exp Ï‰ Î· z B exp Ï‰ Î· z exp Ä± Ï‰ t p x md\"The wave operator corresponding to the top layer zâˆˆ 0, H is denoted using `L1`.\" begin Dz Differential z Dx Differential x Dt Differential t end L1 u Dt Dt u Î¼â‚ Ïâ‚ Dx Dx u Dz Dz u md\"We now write an expression for the wavefield in the top layer using the vertical component of the slowness vector \\eta 1 and amplitudes A 1 and B 1 .\" syms Aâ‚ Real Bâ‚ Real Î·â‚ Complex u1 trail soln p, Î·â‚, Aâ‚, Bâ‚ arguments u1 simplify expand derivatives L1 u1 u1 md\"Similarly, for the half space.\" syms Aâ‚‚ Real Bâ‚‚ Real u2 trail soln p, Î·â‚‚, Aâ‚‚, Bâ‚‚ md\"\"\" We ignore the upcoming wave when \\eta 2 is imaginary, and avoid exponential growth with depth when \\eta 2 is real such that. \"\"\" Bâ‚‚ ~ 0 md\"\"\" Free Surface Condition We shall now evaluate the traction corresponding to the free surface and set it to zero. \"\"\" Ïƒyz1 expand derivatives Î¼â‚ . Dz u1 substitute Ïƒyz1, z 0 ~ 0 Symbolics.symbolic linear solve substitute Ïƒyz1, z 0 , Bâ‚ | simplify Aâ‚ ~ Bâ‚ md\" Dynamic Boundary Condition We now impose continuity of \\sigma yz component of the stress tensor across the boundary at z H .\" Ïƒyz2 expand derivatives Î¼â‚‚ . Dz u2 Ïƒyz1H substitute Ïƒyz1, z H Ïƒyz2H substitute Ïƒyz2, z H Aâ‚‚ex1 substitute Symbolics.symbolic linear solve Ïƒyz1H ~ Ïƒyz2H, Aâ‚‚ , Bâ‚ Aâ‚, Bâ‚‚ 0 md\" Kinematic Boundary Condition Similarly, we impose the continuity of the displacement field across the boundary.\" u1H substitute u1, z H, Bâ‚ Aâ‚ u2H substitute u2, z H, Bâ‚‚ 0 Aâ‚‚ex2 Symbolics.symbolic linear solve u1H ~ u2H, Aâ‚‚ md\"\"\" Graphical Solution This section reacts to the medium configuration selected above. In order to have a non trivial solution, we need the two expressions for Aâ‚‚ should be equal to each other. We begin by simplifying these expressions, substitute the UI medium configuration and plot them in following three ranges. \"\"\" ex1 simplify Aâ‚‚ex1 arguments Aâ‚‚ex1 2 Aâ‚ ex2 simplify Aâ‚‚ex2 arguments Aâ‚‚ex1 2 Aâ‚ md\"Note that the goal here is to find zeros of the function `F` defined below, which outputs `ex1 ex2` for a given horizontal slowness `p`.\" md\"From the above plots, we can observe that there are no zeros in either 0,Î²â‚ or Î²â‚‚, âˆ . Therefore, we will now find the zeros of `F` in the interval Î²â‚, Î²â‚‚ . The `find zeros` function from the `Roots.jl` https github.com JuliaMath Roots.jl package can be used to search for all zeros in a specified interval in a derivative free fashion. We only consider the real part of `F` as the imaginary part is zero in Î²â‚, Î²â‚‚ . The zeros correspond to the eigenvalue phase velocities.\" md\" Dispersion Curves\" md\" Appendix\" tgrid range 0, stop 1000, length 1000 freqgrid rfftfreq length tgrid , inv step tgrid function get k c k inv. c . freqgrid 2 end . 2 . pi end function get group velocity k return step freqgrid 2 pi . diff k end a range for phase velocity typical shear velocity values in crust mantle cgrid range 1, stop 7, step 0.2 function getÎ· p, Î² if abs2 p inv abs2 Î² return im sqrt inv abs2 Î² abs2 p else return sqrt abs2 p inv abs2 Î² end end md\"In order to plot the displacement wavefield, we will now build functions that output the particle displacement in the first and second layers for input x , z , t and p .\" md\" UI\" function medium input return PlutoUI.combine do Child inputs1 md\"\"\" H km Child \"Hp\", Slider range 10, 100, step 5 , default 35, show value true \"\"\", md\"\"\" Î²â‚ km s Child \"Î²â‚\", Slider cgrid, default 3.5, show value true \"\"\", md\"\"\" Î²â‚‚ km s Child \"Î²â‚‚\", Slider cgrid, default 4.5, show value true \"\"\", md\"\"\" Ïâ‚ gm cc Child \"Ïâ‚\", Slider range 1, 7, step 0.2 , default 2.6, show value true \"\"\", md\"\"\" Ïâ‚‚ gm cc Child \"Ïâ‚‚\", Slider range 1, 7, step 0.2 , default 3.4, show value true \"\"\" md\"\"\" Medium Choose the depth of the boundary between the top layer and the halfspace. Slide to adjust the seismic velocities âˆˆ 1, 7 km s and densities âˆˆ 1, 7 gm cc of the top layer and the halfspace. By default, the parameters corresponding to the curst and mantle will be chosen. inputs1 \"\"\" end end function freq rec input return PlutoUI.combine do Child inputs1 md\"\"\" receiver location km Child \"xrecpos\", Slider range 0, 3000, step 1 , default 2000, show value true \"\"\", md\"\"\" frequency band Hz Child \"freqs\", RangeSlider range first freqgrid , step step freqgrid , length length freqgrid , show value true \"\"\", inputs time md\"\"\" time s Child \"T\", Slider tgrid, default div maximum tgrid , 2 , show value true \"\"\", inputs2 md\"\"\" frequency Hz Child \"freq\", Slider range 0.0, 0.25, step 0.01 , default 0.08, show value true \"\"\", md\"\"\" Wavefield Animation inputs2 Seismogram inputs1 Stationary Phase Analysis inputs time \"\"\" end end TwoColumn md\"\"\" bind medium confirm medium input \"\"\", md\"\"\" bind freq rec confirm freq rec input \"\"\" crange1 range medium.Î²â‚, stop medium.Î²â‚‚, length 1000 crange2 range medium.Î²â‚ 0.5, stop medium.Î²â‚, length 100 crange3 range medium.Î²â‚‚, stop medium.Î²â‚‚ 0.5, length 100 substitute values of medium.Hp, medium.Î²â‚, and medium.Ïâ‚ into the expression x, instead of Î¼, Î·. then return a function of horizontal slowness f p that can be plotted function subs Î²Ï x output function true x substitute x, H medium.Hp, Î¼â‚ medium.Î²â‚ medium.Î²â‚ medium.Ïâ‚, Î¼â‚‚ medium.Î²â‚‚ medium.Î²â‚‚ medium.Ïâ‚‚ if output function return build function x, p, Ï‰, Î·â‚, Î·â‚‚, expression Val false else x end end subs Î²Ï ex1, output function true F subs Î²Ï ex1 ex2 output function true Fmedium p F p, 2 pi freq rec.freq, getÎ· p, medium.Î²â‚ , getÎ· p, medium.Î²â‚‚ cn sort inv. find zeros real âˆ˜ Fmedium, inv medium.Î²â‚ , inv medium.Î²â‚‚ need prettier labels for MultiCheckBox names cn map enumerate cn do i, c c string i, \" \", floor c, digits 2 end cn vec map freqgrid 2 end do f F1 p F p, 2 pi f, getÎ· p, medium.Î²â‚ , getÎ· p, medium.Î²â‚‚ cn sort inv. find zeros real âˆ˜ F1, inv medium.Î²â‚ , inv medium.Î²â‚‚ end phase velocities map 1 4 do i map cn vec do c if length c i c i else missing end end end wavenumbers map phase velocities do c get k c end group velocities map wavenumbers do k get group velocity k end function subs u1 u output function true u substitute subs Î²Ï u output function false , Ä± im, Bâ‚ 1, Aâ‚ 1, Bâ‚‚ 0 if output function build function u, x, z, t, p, Ï‰, Î·â‚, Î·â‚‚, expression Val false else u end end U1 subs u1 u1 function subs u2 u output function true Aâ‚‚p subs u1 Aâ‚‚ex1, output function false u substitute subs Î²Ï u output function false , Ä± im, Bâ‚ 1, Aâ‚ 1, Bâ‚‚ 0, Aâ‚‚ Aâ‚‚p if output function build function u, x, z, t, p, Ï‰, Î·â‚, Î·â‚‚, expression Val false else u end end U2 subs u2 u2 function mode input return PlutoUI.combine do Child input md\"\"\" câ‚™ km s Child \"c\", MultiCheckBox names cn, select all true, default cn \"\"\", return md\"\"\" Phase velocity Eigenvalues Depending on the parameters chosen above, the estimated phase velocity eigenvalues câ‚™ are given below. Select them to plot the corresponding eigenfunction uâ‚™ i.e., displacement wavefield of a particular mode. You may also select multiple eigenfunctions to plot their superposition. For example, for the crust mantle configuration, we can notice the first higher order mode for frequency 0.08 Hz. input \"\"\" end end bind modes confirm mode input md\" Plots\" function plot roots x1, x2, cgrid f1 subs Î²Ï x1 f2 subs Î²Ï x2 a f1 inv c , 2 pi freq rec.freq, getÎ· inv c , medium.Î²â‚ , getÎ· inv c , medium.Î²â‚‚ for c in cgrid b f2 inv c , 2 pi freq rec.freq, getÎ· inv c , medium.Î²â‚ , getÎ· inv c , medium.Î²â‚‚ for c in cgrid trace1 scatter x cgrid, y real. a , mode \"lines\", line color \"red\", name \"real ex1 \" trace2 scatter x cgrid, y imag. a , mode \"lines\", line color \"blue\", name \"imag ex1 \" trace3 scatter x cgrid, y real. b , mode \"lines\", line color \"red\", line dash \"dash\", name \"real ex2 \" trace4 scatter x cgrid, y imag. b , mode \"lines\", line color \"blue\", line dash \"dash\", name \"imag ex2 \" trace5 scatter x medium.Î²â‚ , y 0 , mode \"markers\", marker size 8, marker color \"black\", marker symbol \"dot\", name \"Î²â‚\" trace6 scatter x medium.Î²â‚‚ , y 0 , mode \"markers\", marker size 8, marker color \"black\", marker symbol \"line ns open\", name \"Î²â‚‚\" layout Layout title \"F c ex1 c ex2 c \", xaxis title \"phase velocity c \", margin attr l 50, r 50, b 50, t 50 , legend attr x 10, y 1.3 , width 700, height 400, xaxis range cgrid 1 , cgrid end plot trace1, trace2, trace3, trace4, trace5, trace6 , layout end plot roots ex1, ex2, crange1 plot roots ex1, ex2, crange2 plot roots ex1, ex2, crange3 begin we need to discretize space before plotting xgrid range 50, stop 250, length 100 zgrid1 range 0, stop medium.Hp, length 100 zgrid2 range medium.Hp, stop 200, length 100 grid xgrid, zgrid1, zgrid2 end function plot record x, z, U1 record mapreduce , freqgrid 2 end , phase velocities 1 do f, c return broadcast tgrid do t real U1 x, z, t, inv c , 2 pi f, getÎ· inv c , medium.Î²â‚ , getÎ· inv c , medium.Î²â‚ f âˆˆ freq rec.freqs end end fig Plot Layout uirevision 1, title \"Fundamental Mode Seismogram at freq rec.xrecpos km\", xaxis attr title \"Time s \" , yaxis attr title \"Amplitude\", range 500, 500 add trace fig, scatter x tgrid, y record, line color \"black\" add vline fig, freq rec.xrecpos medium.Î²â‚, line color \"red\" add vline fig, freq rec.xrecpos medium.Î²â‚‚, line color \"red\" add vline fig, freq rec.T, line color \"blue\" fillcolor \"LightSalmon\", opacity 0.5, layer \"below\", line width 0, plot fig end plot record freq rec.xrecpos, 0, U1 function plot Love waves t, medium, grid, U1, U2, modes xgrid, zgrid1, zgrid2 grid U1p mapreduce , modes.c do c return broadcast Iterators.product zgrid1, xgrid do z, x real U1 x, z, t, inv c , 2 pi freq rec.freq, getÎ· inv c , medium.Î²â‚ , getÎ· inv c , medium.Î²â‚‚ end end U2p mapreduce , modes.c do c return broadcast Iterators.product zgrid2, xgrid do z, x real U2 x, z, t, inv c , 2 pi freq rec.freq, getÎ· inv c , medium.Î²â‚ , getÎ· inv c , medium.Î²â‚‚ end end return U1p trace1 heatmap y zgrid1, x xgrid, zauto false, zmin 5, zmax 5, colorscale \"RdBu\", z U1p, showscale false trace2 heatmap y zgrid2, x xgrid, zauto false, zmin 5, zmax 5, colorscale \"RdBu\", z U2p, showscale false, layout Layout title \"Love wave Displacement\", xaxis title \"Distance x \", yaxis title \"Depth z \", width 600, height 500, yaxis scaleanchor \"x\", yaxis scaleratio 1, yaxis autorange \"reversed\", shapes Shape \"a\", type \"line\", x0 xgrid 1 , y0 medium.Hp, x1 xgrid end , y1 medium.Hp, line attr color \"black\", width 5 , Shape \"b\", type \"line\", x0 xgrid 1 , y0 0, x1 xgrid end , y1 0, line attr color \"black\", width 5, dash \"dot\" , annotations annotation for the first line attr text \"Boundary\", xref \"paper\", yref \"y\", x 0.1, y medium.Hp, font attr size 12 , showarrow false, borderpad 4, bgcolor \"white\", , annotation for the second line attr text \"Free Surface\", xref \"paper\", yref \"y\", x 0.1, y 0, font attr size 12 , showarrow false, borderpad 4, bgcolor \"white\", , legend attr x 0, y 0.3, traceorder \"reversed\" return plot trace1, trace2 , layout end plot Love waves tt, medium, grid, U1, U2, modes function plot dispersion curves phase velocities, group velocities, freqgrid fig Plot Layout height 600, title \"Dispersion Curves\", Subplots shared xaxes true, rows 2, cols 1, subplot titles \"Phase Velocity\" \"Group Velocity\" , x title \"Frequency Hz \" add trace fig, scatter x freqgrid 2 end , y phase velocities 1 , name \"Fundamental Mode\" , row 1, col 1 add trace fig, scatter x freqgrid 2 end , y phase velocities 2 , name \"First Higher order Mode\" , row 1, col 1 add trace fig, scatter x freqgrid 2 end , y phase velocities 3 , name \"Second Higher order Mode\" , row 1, col 1 add trace fig, scatter x freqgrid 2 end , y phase velocities 4 , name \"Second Higher order Mode\" , row 1, col 1 add trace fig, scatter x freqgrid 2 end , y group velocities 1 , name \"Fundamental Mode\" , row 2, col 1 add trace fig, scatter x freqgrid 2 end , y group velocities 2 , name \"First Higher order Mode\" , row 2, col 1 add trace fig, scatter x freqgrid 2 end , y group velocities 3 , name \"Second Higher order Mode\" , row 2, col 1 add trace fig, scatter x freqgrid 2 end , y group velocities 4 , name \"Second Higher order Mode\" , row 2, col 1 plot fig end plot dispersion curves phase velocities, group velocities, freqgrid function plot phase t fig Plot Layout title \"Stationary Phase Analysis\", yaxis attr title \"Phase kx Ï‰t \" , xaxis attr title \"Frequency Hz \" t1 freq rec.xrecpos medium.Î²â‚ 0.5 t2 freq rec.xrecpos medium.Î²â‚‚ 2 phase wavenumbers 1 freq rec.xrecpos . 2pi . freqgrid 2 end t min points, findminima phase max points, findmaxima phase add trace fig, scatter x freqgrid 2 end , y phase, name string t plot fig map min points do p add vline fig, freqgrid 2 end p end map max points do p add vline fig, freqgrid 2 end p end plot fig end plot phase freq rec.T md\"\"\" TODO Have a plot that shows how a wavelet disperses as it propagates, which needs a sum of frequencies, with some initial phases assigned. \"\"\" "},{"url":"surfacewaves/Rayleigh-function/","title":"Rayleigh Function","tags":["surfacewaves"],"text":" A Pluto.jl notebook v0.19.46 frontmatter title \"Rayleigh Function\" tags \"surfacewaves\" layout \"layout.jlhtml\" description \"Particles may go round and round, but don't worry, let the Rayleigh wave pass by This notebook will help you understand the physics behind it.\" using Markdown using InteractiveUtils This Pluto notebook uses bind for interactivity. When running this notebook outside of Pluto, the following 'mock version' of bind gives bound variables a default value instead of an error . macro bind def, element quote local iv try Base.loaded modules Base.PkgId Base.UUID \"6e696c72 6542 2067 7265 42206c756150\" , \"AbstractPlutoDingetjes\" .Bonds.initial value catch b missing end local el esc element global esc def Core.applicable Base.get, el ? Base.get el iv el el end end begin using Symbolics using SymbolicUtils using LinearAlgebra using Latexify using LaTeXStrings using PlutoUI using PlutoTeachingTools using PlutoPlotly using Measures using Roots using Parameters end ChooseDisplayMode PlutoUI.TableOfContents md\"\"\" Rayleigh Function This notebook aims to provide a comprehensive understanding of Rayleigh waves. Unlike previous discussions on reflection coefficients where the incident wave is homogeneous and at least one of the scattered waves is homogeneous, this notebook focuses on scenarios where all interacting plane waves are inhomogeneous. Specifically, we examine inhomogeneous P and SV waves interacting with the free surface of a medium. This approach allows us to delve deeper into the unique characteristics and behaviors of Rayleigh waves in seismology. Interactive Seismology Notebooks https pawbz.github.io Interactive Seismology.jl Instructor Pawan Bharadwaj , Indian Institute of Science, Bengaluru, India \"\"\" TwoColumnWideLeft md\"\"\" Choose the medium parameters of the half space using these sliders. Accordingly, we shall plot the Rayleigh function, where its root gives the phase velocity of the Rayleigh wave cáµ£ . It can be noticed that this velocity is a few percent less than the shear wave speed. \"\"\", md\"\"\" Î± km sec bind Î±p PlutoUI.Slider range 4.0, stop 10.0, step 0.1 , default 6.0, show value true Î² km sec bind Î²p PlutoUI.Slider range 3.0, stop 6.0, step 0.1 , default 4.49, show value true Ï gm cmÂ³ bind Ïp PlutoUI.Slider range 2.0, stop 6.0, step 0.1 , default 2.9, show value true \"\"\" md\"\"\" In this document, we denote 2D spatial coordinates, angular frequency, time and necessary differential operators. \"\"\" syms x Real z Real Ï‰ Real t Real begin Dx Differential x Dz Differential z end syms Ä± Complex Real imaginary unit, going to substitute with im later md\"\"\" The medium is assumed to be homogeneous with uniform P and S wave velocities \\alpha and \\beta . We use p to denote the horizontal slowness. As both the P and SV waves are inhomogeneous, a necessary condition is ```math \\frac 1 \\alpha \\frac 1 \\beta p. ``` The Lame parameters are denoted using \\lambda and \\mu , and \\rho is mass density. \"\"\" syms Î± Real p Real Î² Real Ï Real Î» Real Î¼ Real tip md\"The inhomegeneous P and SV waves are coupled due to the fact that they share the same horizonal slowness p . If they are not coupled, one can show that the stress free conditions cannot be satisfied.\" md\"\"\" The vertical components of the slowness vectors corresponding to \\alpha and \\beta are imaginary. Here, we use \\eta to denote the imaginary part of the vertical components of the slowness vector. \"\"\" syms Î·â‚š Real Î·â‚› Real md\"The dispersion relation gives.\" Î·â‚š ~ sqrt p^2 1 Î±^2 Î·â‚› ~ sqrt p^2 1 Î²^2 syms Aâ‚š A Aâ‚› md\"\"\" Inhomogeneous Plane Waves We now derive the expression for an inhomogeneous plane wave with amplitude A and frequency Ï‰ , propagating in the x direction with slowness p . These waves exhibit exponential decay with increasing distance from the surface at z 0 . \"\"\" inhomo plane p, Î·, A A exp Ï‰ Î· z exp Ä± Ï‰ t p x md\"\"\" We now consider two harmonic plane waves that satisfy the scalar wave equations for P and SV potentials \\phi and \\psi . A p and A s denote the amplitudes of these potentials. \"\"\" Ï• inhomo plane p, Î·â‚š, Aâ‚š Ïˆ inhomo plane p, Î·â‚›, Aâ‚› md\"\"\" Total Displacement The particle displacement due to the P wave. \"\"\" uâ‚š expand derivatives. Dx Ï• , Dz Ï• md\"Similarly for SV wave, we have.\" uâ‚› expand derivatives. Dz Ïˆ , Dx Ïˆ TwoColumnWideLeft md\"\"\" Rayleigh waves, a type of surface seismic wave, exhibit unique characteristics due to their elliptical particle motion. For a homogeneous medium, the phase velocity cáµ£ of Rayleigh waves is independent of the frequency Ï‰ , indicating non dispersive behavior. To visualize the particle motion, we can select a frequency and adjust the time to generate a snapshot. Key observations include Particles move in an elliptical trajectory, which is retrograde at the free surface. The amplitude of particle motion decreases exponentially with depth, influenced by the frequency. At greater depths, the particle motion transitions to a prograde elliptical trajectory, dominated by the SV wave component. \"\"\", md\"\"\" angular frequency bind Ï‰p PlutoUI.Slider range 0.05, stop 0.3, length 100 , show value true bind tp Clock 0.5 experimental plot individual components bind uplot MultiCheckBox uâ‚š \"P\", uâ‚› \"SV\" , default uâ‚š, uâ‚› \"\"\" md\"The total displacement field is given by summing the P and SV components. We denote the x and z components of the total displacement field using `ux` and `uz`.\" ux, uz uâ‚š . uâ‚› md\"\"\" Stress free Condition We now evaluate the stress components `Ïƒxz` and `Ïƒzz` on the free surface and apply the boundary conditions to estimate the ratio `Aâ‚› Aâ‚š` using both boundary conditions. Subsequently, we derive a condition that must be satisfied for this ratio to be unique. This condition provides the Rayleigh function, and the roots of this function give the phase velocities of the Rayleigh waves. \"\"\" Ïƒxz expand derivatives Î¼ Dx uz Dz ux | simplify Ïƒxz z0 substitute Ïƒxz, z 0, Ä± Ä± 1 | simplify Ïƒxz z0 ~ 0 Aratio1 Symbolics.symbolic linear solve Ïƒxz z0 ~ 0, Aâ‚› Aâ‚š | simplify Ïƒzz expand derivatives Î» Dx ux Dz uz 2 Î¼ Dz uz | simplify Ïƒzz z0 simplify substitute Ïƒzz, z 0, Ä± Ä± 1 Aratio2 Symbolics.symbolic linear solve Ïƒzz z0 ~ 0, Aâ‚› Aâ‚š | simplify md\"\"\" Rayleigh Function For a non trivial solution for `Aâ‚š` and `Aâ‚›`, the following equation must be satisfied. \"\"\" R1 diff arguments Aratio1 . reverse arguments Aratio2 | first | simplify md\"\"\" We will reparameterize the Rayleigh function using \\alpha , \\beta , and \\rho , and substitute Ä±^2 1 . This reparameterized function must be satisfied for a given medium. The root of this function provides the horizontal slowness p at which both the inhomogeneous P and SV plane waves propagate. \"\"\" md\"\"\" Towards plotting, we will now substitute the UI values of \\alpha , \\beta and \\rho . \"\"\" md\"\"\" We will now find the root of the Rayleigh function using the bisection method. \"\"\" md\"\"\" Rayleigh Waves We shall now substitute the zero of the Rayleigh function into the expressions of inhomogeneous P and SV planewaves that are channeled along the free surface. \"\"\" simplify substitute ux, Aâ‚š 1, Aâ‚› Aratio1 simplify substitute uz, Aâ‚š 1, Aâ‚› Aratio1 md\"\"\" Appendix \"\"\" Reparametrize an expression `x` using Î±, Î² and Ï, instead of Î», Î¼, Î·. Also substitutes Ä±^2 1. function subs Î±Î²Ï x simplify substitute x, Ä± Ä± 1, Î» Î± Î± Ï 2 Î² Î² Ï, Î¼ Î² Î² Ï, Î·â‚š Î·â‚š p p 1 Î±^2, Î·â‚› Î·â‚› p p 1 Î²^2, Î·â‚š sqrt p p 1 Î±^2 , Î·â‚› sqrt p p 1 Î²^2 , Î¼ Î² Î² Ï end R subs Î±Î²Ï R1 Substitutes UI values of Î±, Î², and Ï. function subs Î±Î²Ï plot x simplify substitute subs Î±Î²Ï x , Î± Î±p, Î² Î²p, Ï Ïp end RUI build function subs Î±Î²Ï plot R , p, expression Val false begin cmin 1.0 minimum possible speed cmax Î²p eps Float64 maximum speed, otherwise the SV wave will no longer be evanascent root cáµ£ find zero c RUI inv c , cmin, cmax , Bisection md\"The root is cáµ£ cáµ£ km s \" end function subs all plot x simplify substitute subs Î±Î²Ï plot x , p inv cáµ£ , Ä± im, Ï‰ Ï‰p, Aâ‚š 1, end uxp build function substitute subs all plot first sum uplot , Aâ‚š 1, Aâ‚› subs all plot Aratio1 , x, z, t, expression Val false uzp build function substitute subs all plot last sum uplot , Aâ‚š 1, Aâ‚› subs all plot Aratio1 , x, z, t, expression Val false md\"\"\" Plots \"\"\" default plotly template plotly dark function plot displacement field xgrid range 0, stop 500, length 10 zgrid range 0, stop 250, length 10 evaluate ux and uz on the grids ux real uxp x, z, tp for x in xgrid, z in zgrid uz real uzp x, z, tp for x in xgrid, z in zgrid normalize ux and uz ux . abs uxp 0, 0, 0 uz . abs uxp 0, 0, 0 strength vec sqrt. ux .^ 2 . uz .^ 2 xq x1 for x1 in xgrid, z1 in zgrid yq z1 for x1 in xgrid, z1 in zgrid scale 25 vels attr x xq i scale ux i , y yq i scale uz i , showarrow true, axref \"x\", ayref \"y\", text \"âˆ˜\", arrowcolor \"blue\", arrowsize strength i , arrowwidth 2, arrowhead 3, ax xq i , ay yq i for i in 1 length xq layout Layout uirevision 1, yaxis attr title \"Depth\", range 400, 100 , xaxis attr title \"Distance\", range 100, 600 , title text \"Rayleigh Displacement Field\", autosize false, width 700, height 500, margin attr l 50, r 50, b 50, t 65 , showlegend false, annotations vels fig Plot layout add trace fig, scatter y 0, 0 , x extrema xgrid , mode \"lines markers text\", text \"\", \"Free Surface\" , textfont attr family \"sans serif\", size 15, color \"Red\" , textposition \"top center\", line attr color \"Red\", width 2, return plot fig end plot displacement field function plot Rayleigh function fig Plot Layout title \"Rayleigh Function\", xaxis title \"Phase Velocity km s \", width 700, height 350 declare a range of speeds for plotting crange range cmin, stop cmax, length 100 add trace fig, PlutoPlotly.scatter x crange, y RUI inv c for c in crange , line attr width 3, color \"white\" , name \"Rayleigh Function\" add hline fig, 0.0, line attr dash \"dot\" add trace fig, PlutoPlotly.scatter x cáµ£, cáµ£ , y 1, 1 , name \"Rayleigh Phase Velocity cáµ£ \", line attr color \"Orange\", width 4, add trace fig, PlutoPlotly.scatter x Î±p, Î±p , y 1, 1 , name \"P wave Velocity Î± \", line attr color \"Red\", width 4, add trace fig, PlutoPlotly.scatter x Î²p, Î²p , y 1, 1 , name \"S wave Velocity Î² \", line attr color \"Blue\", width 4, relayout fig PlutoPlotly.plot fig end plot Rayleigh function "},{"url":"surfacewaves/tbu/","title":"To be updated","tags":["mod1"],"text":"COMING SOON"},{"url":"tikz/tikz/","title":"tikz","tags":[],"text":" A Pluto.jl notebook v0.19.41 using Markdown using InteractiveUtils using TikzPictures, LaTeXStrings tikz default options raw\"\"\" background rectangle .style fill white , show background rectangle, \"\"\" tikz preamble raw\"\"\" \\usepackage tikz \\usepackage booktabs \\usepackage tikzducks \\usepackage tikz 3dplot \\usetikzlibrary fit, matrix, shapes.geometric \\tikzset % use tikzset, not tikzstyle cell .style rectangle, rounded corners 5pt, draw, \\tikzset % use tikzset, not tikzstyle cellv .style rectangle, rounded corners 5pt, draw, rotate 90, \\usepackage xifthen \\usetikzlibrary hobby \\usepackage pgfplots \\usepackage fontawesome \\usepackage bm,amsfonts,amsmath \\usetikzlibrary backgrounds,pgfplots.groupplots,snakes, math \\usepgfplotslibrary patchplots \\pgfplotsset try min ticks 2 \\usepackage pgfplotstable \\usetikzlibrary plotmarks,positioning,spy \\usetikzlibrary shapes.geometric, arrows, fadings \\usepgfplotslibrary groupplots, polar \\usepackage space grffile \\usetikzlibrary % decorations.pathreplacing,% decorations.pathmorphing% \\usetikzlibrary positioning,fit,backgrounds \\usetikzlibrary backgrounds, hobby \\usetikzlibrary shapes,arrows \\usetikzlibrary decorations.markings \\usetikzlibrary patterns \\usetikzlibrary plotmarks \\usetikzlibrary fit \\usetikzlibrary intersections \\usepgfplotslibrary fillbetween \\pgfplotsset axis line style black 10 , every axis label .append style black 10 , every axis title .append style black 10 , every tick label .append style black 10 % need for pgfplots \\newcommand \\axisz 0cm \\newcommand \\axisx 0cm \\usetikzlibrary positioning \\usetikzlibrary shapes.geometric \\usetikzlibrary backgrounds \\tikzset pics wavelet .style n args 3 code \\draw fill 2, thick, domain 3 2, samples 200, smooth plot coordinates 1 \\node fill white at 1.5,0 3 % arguments frequency, time shift, amplitude, color \\tikzset pics ricker .style n args 4 code \\draw fill 4, thick, domain 3 2, samples 200, smooth plot \\x, 1 2 pi 1 \\x 2 1 \\x 2 e^ pi 1 \\x 2 1 \\x 2 3 \\tikzset pics meyer .style n args 4 code \\draw fill 4, thick, domain 3 2, samples 200, smooth plot \\x, sin 2 pi 1 200 \\x 2 sin pi 1 200 \\x 2 pi 1 200 \\x 2 20 3 \\tikzset pics poisson .style n args 4 code \\draw fill 4, thick, domain 3 2, samples 200, smooth plot \\x, 3 1 \\x 2 \\x 2 1 1 1 \\x 2 \\x 2 1 1 1 \\x 2 \\x 2 1 1 \\newcommand\\waveletone 5 \\begin scope shift 1 , rotate 0 \\draw fill 5, thick, domain 3 2, samples 200, smooth plot \\x, \\x 3 1 2 pi 2 \\x 3 2 \\x 3 e^ pi 2 \\x 3 2 \\x 3 4 \\end scope \\newcommand\\wavelettwo 5 \\begin scope shift 1 , rotate 0 \\draw fill 5, thick, domain 3 2, samples 200, smooth plot \\x, 1 2 pi 2 \\x 3 2 \\x 3 e^ pi 2 \\x 3 2 \\x 3 4 \\end scope \\newcommand\\waveletthree 5 \\begin scope shift 1 , rotate 0 \\draw fill 5, thick, domain 3 2, samples 200, smooth plot \\x, \\x \\x 3 1 2 pi 2 \\x 3 2 \\x 3 e^ pi 2 \\x 3 2 \\x 3 4 \\end scope \\newcommand\\hx 6cm \\newcommand\\dx 0.5cm \\newcommand\\hz 3cm \\newcommand\\dz 0.5cm \\tikzset pics spike .style code \\draw draw gray, thick, fill gray, 0,0 rectangle 0.2cm,0.2cm \\draw very thick,black .1cm,0 .1cm, 0.2cm , pics receivers .style n args 2 code \\foreach \\x in 0, 0.8, 1.6, 2.4, 3.2, 4.0 \\pic at \\x,0 spike \\draw 0,0 4,0 \\node scale 2 at 4.0,0.5cm receivers , pics truck .style n args 6 code \\node xshift 2.6 \\hx,yshift 2 \\hz at 0,0 s1 \\node xshift \\hx 4,yshift 2 \\hz at 0,0 s2 \\draw very thick, black 90, , stealth s1 s2 \\filldraw pattern horizontal lines light gray s1 rectangle yshift \\hz 2 s2 \\draw fill gray 20 1 \\hx 1.7cm, 2 \\hz 0.4cm 1 \\hx 1.7cm, 2 \\hz 0.4cm 1 \\hx 1.7cm, 2 \\hz 2.2cm 1 \\hx 0.7cm, 2 \\hz 2.2cm 1 \\hx 0.6cm, 2 \\hz 1.6cm 1 \\hx 1.7cm, 2 \\hz 1.6cm 1 \\hx 1.7cm, 2 \\hz 0.4cm \\node at 1 \\hx 1.7cm, 2 \\hz .8cm s9 \\draw fill gray 50 1 \\hx 1.3cm, 2 \\hz 1cm rectangle 1 \\hx 0.3cm, 2 \\hz 1.2cm \\draw fill gray 5 1 \\hx 1cm, 2 \\hz 1.2cm rectangle 1 \\hx 1.5cm, 2 \\hz 1.7cm \\draw fill gray 80 1 \\hx 1cm, 2 \\hz .4cm circle 0.4cm node c1 \\draw fill gray 80 1 \\hx 1cm, 2 \\hz .4cm circle 0.4cm \\node scale 2 at 1 \\hx .7cm, 2 \\hz 1.9cm source \\node at 1 \\hx 3.9cm, 2 \\hz s10 \\draw thick s9.south s10.north \\draw snake expanding waves,segment angle 90, 3,segment length 4,thick 1 \\hx 1cm, 2 \\hz 1 \\hx 1cm, 2 \\hz 1.5cm \\draw snake expanding waves,segment angle 90, 5,segment length 6,thick 1 \\hx 1cm, 2 \\hz 1 \\hx 1cm, 2 \\hz 1.5cm \\draw snake snake, 3,segment length 4,thick 1 \\hx 2.7cm, 2 \\hz .5cm 2.55 \\hx, 2 \\hz .5cm \\draw snake snake, 5,segment length 6,thick 1 \\hx 2.7cm, 2 \\hz .7cm 2.55 \\hx, 2 \\hz .7cm \\pic at s10.north receivers 1 2 \\tikzset pics crust .style n args 6 code \\coordinate c0 at 4, 1 \\coordinate c1 at 3, 1.1 \\coordinate c2 at 2, 1.2 \\coordinate c3 at 1, 1.3 \\coordinate c4 at 0, 1.4 \\coordinate c5 at 1, 1.6 \\coordinate c6 at 2, 1.8 % Round rectangle \\fill gray 10 4,0 rectangle 3, 3 % Interface \\draw gray,line width .5pt,draw,decorate,decoration border,angle 45, amplitude 0.3cm,segment length 2mm 4,0 3,0 % Vertical dashed line \\draw gray 20 0, 3 0,0 \\draw black 20 4, 3 3, 3 % Incidence \\foreach \\x \\i \\y \\s \\c in 2 1 1.2 1 4, 0.5 2 1.35 2 5,1 3 1.6 3 6 \\node scale 1.5, star, star point ratio 0.5, star points 3, fill black,anchor center at \\x,0 rec\\i \\draw rec\\i node above receiver \\ \\i \\draw snake snake,thick,segment length \\s,\\c \\x 0.2, 3 \\x 0.1,\\y node midway,right P \\draw snake snake,thick,segment length \\s,\\c, dashed \\x 0.1,\\y rec\\i node midway,right S % Media names \\node align left at 3.4, 1.75 subducting \\\\plate % \\draw line width .6pt 0,0 % 135 .12cm 45 .12cm % 45 .12cm 135 .12cm % Interface pointer \\draw latex,thick 2.25,0.5 node right free surface to out 180,in 90 2,0 \\draw black, thick,pattern horizontal lines,pattern color gray plot smooth, tension 0.01 coordinates c0 c1 c2 c3 c4 c5 c6 3, 1.9 3, 2.3 2, 2.1 1, 1.9 0, 1.8 1, 1.7 2, 1.6 3, 1.5 4, 1.5 \"\"\" plot code width \"\", options raw\"\" TikzPicture code, options tikz default options options, preamble tikz preamble, width width tikz default options raw\"\"\"scale 2\"\"\" plot L\"\"\" \\draw 1,0 0,1 \"\"\", options raw\"\"\"scale 2\"\"\" plot L\"\"\" \\tikzset pics blob .style code \\draw use Hobby shortcut, fill, closed 0,0 0 1 4 rnd \\foreach \\a in 60,120,...,350 .. \\a 1 4 rnd \\pic at 0,0 fill green 30, scale 1, rotate 360 rnd blob \"\"\" md\" Ricker\" "}]