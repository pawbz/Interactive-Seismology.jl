[{"url":"cheatsheets/","title":"Cheatsheets","tags":["welcome"],"text":"Cheatsheets Getting Started with Julia - live . Fastrack to Julia  cheatsheet. MATLAB-Julia-Python comparative cheatsheet  by  QuantEcon group Plots.jl cheatsheet"},{"url":"classes/","title":"Lecture Schedule","tags":["welcome"],"text":"main a img {\n    width: 5rem;\n    margin: 1rem;\n}\n Introduction of the course: inverse, learning and design problems Discrete Linear Inverse Problems Formulation of discrete linear inverse problem  Gm=d ; Row and column interpretations of matrix-vector  Gm  and matrix-matrix  GH  products Overdetermined and underdeterminded systems; Linear (in)dependence, basis vectors; independence-dimension inequality Left (right) inverses of a matrix with independent column (row) vectors; Gram matrix; pseudo inverses; solving linear equations with the inverses Solving inverse problems via matrix factorization;  CR  Column times Row and  QR  factorizations Example of fitting a polynomial using temperature anomaly data Singular Value Decomposition; Factor Analysis; Examples from chemical analysis of ocean sediments Analysis of spatial patterns in atmospheric pressure - Assignment Formulaton of gravity inversion - Assignment Least-squares; Coordinate Descent Algorithm, Lasso, Ridge Regression, Elastic-Net Demonstration of Elastic-Net using the gravity problem - Assignment Pseudoinverse via SVD; Importance of setting tolerance with noisy data; Demonstration using Deconvolution Problem - Assignment Gradient, Hessian, and their interpretations Data and model resolution matrices Probabilistic inverse problems Monte Carlo methods Learning Learning problems; Shallow Neural Networks Why Deep Learning; Loss Functions; Maximum Likelihood Approach for Regression and Classification Problems Bias-variance Tradeoff; K-means clustering Gaussian Mixture Models (some topics) Sparse Principal Component Analysis\nSplit Methods\nMatrix Completion Using NeuralNetworks\nExample from seismic imaging: traveltime tomography"},{"url":".","title":"index","tags":["homepage"],"text":""},{"url":"installation/","title":"Software installation","tags":["welcome"],"text":"First-time setup: Install Julia & Pluto Text and pictures version: Step 1: Install Julia  1.8.2 Go to  https://julialang.org/downloads  and download the current stable release, Julia  1.8.2 , using the correct version for your operating system (Linux x86, Mac, Windows, etc). Step 2: Run Julia After installing,  make sure that you can run Julia . On some systems, this means searching for the “Julia  1.8.2 ” program installed on your computer; in others, it means running the command  julia  in a terminal. Make sure that you can execute  1 + 1 : Make sure that you are able to launch Julia and calculate  1+1  before proceeding! Step 3: Install  Pluto Next we will install the  Pluto , the notebook environment that we will be using during the course. Pluto is a Julia  programming environment  designed for interactivity and quick experiments. Open the  Julia REPL . This is the command-line interface to Julia, similar to the previous screenshot. Here you type  Julia commands , and when you press ENTER, it runs, and you see the result. To install Pluto, we want to run a  package manager command . To switch from  Julia  mode to  Pkg  mode, type  ]  (closing square bracket) at the  julia>  prompt: \njulia> ]\n\n(@v 1.8 ) pkg>\n The line turns blue and the prompt changes to  pkg> , telling you that you are now in  package manager mode . This mode allows you to do operations on  packages  (also called libraries). To install Pluto, run the following (case sensitive) command to  add  (install) the package to your system by downloading it from the internet.\nYou should only need to do this  once  for each installation of Julia: \n(@v 1.8 ) pkg> add Pluto\n This might take a couple of minutes, so you can go get yourself a cup of tea! You can now close the terminal. Step 4: Use a modern browser: Mozilla Firefox or Google Chrome We need a modern browser to view Pluto notebooks with. Firefox and Chrome work best. Second time:  Running Pluto & opening a notebook Repeat the following steps whenever you want to work on a project or homework assignment. Step 1: Start Pluto Start the Julia REPL, like you did during the setup. In the REPL, type: julia> using Pluto\n\njulia> Pluto.run()\n The terminal tells us to go to  http://localhost:1234/  (or a similar URL). Let’s open Firefox or Chrome and type that into the address bar. If you’re curious about what a  Pluto notebook  looks like, have a look at the  Featured Notebooks . These notebooks are useful for learning some basics of Julia programming. If you want to hear the story behind Pluto, have a look a the  JuliaCon presentation . If nothing happens in the browser the first time, close Julia and try again. And please let us know! Step 2a: Opening a notebook from the web This is the main menu - here you can create new notebooks, or open existing ones. Our homework assignments will always be based on a  template notebook , available in this GitHub repository. To start from a template notebook on the web, you can  paste the URL into the blue box  and press ENTER. For example, homework 0 is available  here . Go to this page, and on the top right, click on the button that says “Edit or run this notebook”. From these instructions, copy the notebook link, and paste it into the box. Press ENTER, and select OK in the confirmation box. The first thing we will want to do is to save the notebook somewhere on our own computer; see below. Step 2b: Opening an existing notebook file When you launch Pluto for the second time, your recent notebooks will appear in the main menu. You can click on them to continue where you left off. If you want to run a local notebook file that you have not opened before, then you need to enter its  full path  into the blue box in the main menu. More on finding full paths in step 3. Step 3: Saving a notebook We first need a folder to save our homework in. Open your file explorer and create one. Next, we need to know the  absolute path  of that folder. Here’s how you do that in  Windows ,  MacOS  and  Ubuntu . For example, you might have: C:\\Users\\fons\\Documents\\18S191_assignments\\  on Windows /Users/fons/Documents/18S191_assignments/  on MacOS /home/fons/Documents/18S191_assignments/  on Ubuntu Now that we know the absolute path, go back to your Pluto notebook, and at the top of the page, click on  “Save notebook…” . This is where you type the  new path+filename for your notebook : Click  Choose . Step 4: Sharing a notebook After working on your notebook (your code is autosaved when you run it), you will find your notebook file in the folder we created in step 3. This the file that you can share with others, or submit as your homework assignment to Canvas. \nconst run = f => f();\nrun(async () => {\nconst versions = await (await fetch(`https://julialang-s3.julialang.org/bin/versions.json`)).json()\nconst version_names = Object.keys(versions).sort().reverse()\nconst stable = version_names.find(v => versions[v].stable)\nconsole.log({stable})\nconst pkg_stable = /\\d+\\.\\d+/.exec(stable)[0]\ndocument.querySelectorAll(\"auto-julia-version\").forEach(el => {\n    console.log(el)\n    el.innerText = el.getAttribute(\"short\") == null ? stable : pkg_stable\n})\n});"},{"url":"introduction/","title":"Introduction","tags":["welcome"],"text":"main a img {\n    width: 5rem;\n    margin: 1rem;\n}\n Earth, in all its grand complexity, whispers its secrets through an orchestra of data. In this course, we’ll become skilled detectives, equipped with powerful analytical tools to decode these whispers and unlock the mysteries of our planet. Let’s imagine Earth as a puzzle box, with three chambers holding the keys to understanding its dynamic processes. The first chamber houses the measured quantities, fingerprints of its current state. The second holds the governing laws, the hidden rules that orchestrate its dance. And finally, in the third chamber lie the hidden parameters, unseen yet crucial players in this grand story. This course equips you with the skills to tackle various challenges, depending on what’s known and what needs to be revealed. We’ll dive into: Inverse Problems : When the rules are known but the players hiding in the shadows remain unseen. Like a detective reconstructing a crime scene, we’ll use data and laws to unmask these hidden parameters. Learning Problems : When the rules themselves are shrouded in mystery. We’ll become data-driven alchemists, transforming information into a map of the underlying laws that govern Earth’s behavior. Design Problems : Before the experiment even begins, we’ll become master strategists, designing data acquisition to optimally reveal the hidden secrets we seek. Throughout this journey, we’ll explore a diverse range of Earth science applications, from predicting climate change to understanding earthquakes. You’ll not only gain technical skills in data analysis but also forge a deeper connection with our planet, appreciating its interconnectedness and learning to ask the right questions to unlock its secrets."},{"url":"linear-algebra/","title":"Linear Algebra Primer","tags":["welcome"],"text":" A Pluto.jl notebook v0.19.36 frontmatter order \"2\" title \"Linear Algebra Primer\" date \"2024 01 04\" tags \"welcome\" description \"Refresh your concepts of linear algebra. Thank you Gilbert Strang.\" layout \"layout.jlhtml\" using Markdown using InteractiveUtils This Pluto notebook uses bind for interactivity. When running this notebook outside of Pluto, the following 'mock version' of bind gives bound variables a default value instead of an error . macro bind def, element quote local iv try Base.loaded modules Base.PkgId Base.UUID \"6e696c72 6542 2067 7265 42206c756150\" , \"AbstractPlutoDingetjes\" .Bonds.initial value catch b missing end local el esc element global esc def Core.applicable Base.get, el ? Base.get el iv el el end end begin using LinearAlgebra using PlutoUI using PlutoTeachingTools using Symbolics using PlutoPlotly end ChooseDisplayMode TableOfContents md\"\"\" Linear Algebra Primer It is one of the mathematical pillars of our course the measured data is often organized to form a vector d in many problems, the physics is often simplified linearized to form a matrix G that maps the model vector m to produce measurements d ```math d G m. ``` In this notebook, we shall try to revisit some highlights of linear algebra. Hopefully, as most of you learned these basic concepts, this notebook will serve as a necessary primer One needs to develop a good geometrical picture of the concepts. For example, we would like to clearly visualize the least squares solution ```math \\hat m G^TG ^ 1 G^T d ``` that you will encounter soon. \"\"\" md\"\"\" Vectors \"\"\" data 0.4, 2.4, 5.6, 9 typeof data danger md\"`x 1,2,3 ` will result in a simple list called `Tuple` in Julia, it is different from a `Vector Float64 ` \" typeof 0.4, 2.4, 5.6, 9 md\"It is easy to check the length of arrays.\" length data md\"\"\" Scalar vector multiplication \"\"\" 3.0 data md\"\"\" Indexing \"\"\" data 1 2 data end first data last data md\"\"\" Concatenate \"\"\" data2 1.2, 3.4, 4.5 data full vcat data, data2 cat data, data2, dims 1 data3 1, 2, 3 vcat data, data3 aaa Float32. data full typeof aaa md\"\"\" Special arrays \"\"\" typeof zeros 5 typeof zeros Float32, 5 randn Float32, 10 md\"\"\" Linear combination Two arrays of same size can be added together. \"\"\" 0.5 . randn 5 . 0.3 randn 5 md\"\"\" Inner product \"\"\" v1 2.0, 3.4, 4.5 v2 1.0, 3.4, 4.5 dot v1, v2 sum v1 . v2 alternatively md\" Matrix vector multiplication\" syms m₁ m₂ m m₁, m₂ g₁ 0.2, 0.1, 3 g₂ 1, 0.2, 0.1 G hcat g₁, g₂ simply a collection of vectors columns d G m Markdown.MD Markdown.Admonition \"warning\", \"Intuition\", md\"\"\" The multiplication of G times m can be interpreted in two ways 1 linear combination of columns g 1 and g 2 which means the vector G\\,m belongs to the column space of G 2 an inner product between each row of G with the vector m roughly, what is the correlation of each row of G with the vector m ? \"\"\" linear combination of columns m₁ G , 1 m₂ G , 2 aside Markdown.MD Markdown.Admonition \"therom\", \"Think\", md\"\"\" Is there any linear combination, other than m 1 0 and m 2 0 , of g 1 and g 2 that produces a zero vector? Why not? \"\"\" md\"\"\" This means G\\,m lies in the space of g 1 and g 2 . You can get convinced by using the sliders below. Choose m₁ bind x₁p Slider range 1, 1, length 10 , default 0.5, show value true m₂ bind x₂p Slider range 1, 1, length 10 , default 0.5, show value true \"\"\" alternatively, inner product with rows sum G 1, . m , sum G 2, . m , sum G 3, . m md\"\"\" Outer product Results in a matrix with dependent columns on u ```math A u\\,v^ T . ``` \"\"\" bind resample1 Button \"Resample\" begin resample1 A1 randn 3 transpose randn 4 end md\"\"\" Rank building blocks of a matrix The rank of a matrix is the dimension of its column space. Let's check the rank of the matrix that we created using the outer product. We know that it has only one independent column. \"\"\" rank A1 md\"Now, lets add two rank 1 peices together.\" A2 randn 3 randn 4 ' . randn 3 randn 4 ' rank A2 md\"Obviously, a matrix with 3 rows has full rank if we add at least 3 rank 1 outer products together. To show this, we will create a matrix using `for` loop in Julia.\" rank sum randn 3 randn 7 ' for in 1 10 md\"\"\" Conversely, any matrix can be decomposed into rank 1 pieces We will talk more about this when working with singular value decomposition SVD . \"\"\" md\"\"\" Matrix matrix multiplication Product of two matrices C and R ```math CR \\text columns of C \\text times rows of R. ``` There are many ways of factoring A . Even though A is a fat matrix, we can simply collect the basis for the column space of A to form C . Other left out dependent columns can be generated later using R to form first great theorem ```math A C\\,R. ``` Two views again 1 linear combination of columns of C using each column of R earlier, we discussed this when R has only one column, i.e., it is a vector 2 or linear combination of rows of R using rows of C . Finally, we can show that the number of independent columns of C equals the number of rows of R . \"\"\" md\"\"\" Singular value decomposition \"\"\" md\"\"\" You are now given a fat matrix X , with a bunch of columns, much more than 3 column size . Obviously, there are only 3 independent columns in X. What are they? Can we order them by importance? \"\"\" bind resample2 Button \"Resample\" begin resample2 X randn 3, 3 randn 3, 20 create a fat matrix end md\"\"\" Choose the number of singular vectors for plotting bind ns Slider 1 3, show value true, default 1 \"\"\" sX svd X md\"Let's only pick the first rank 1 piece\" norm X . sX.U , 1 sX.V , 1 ' . sX.S 1 md\"If we pick the second piece, then the distance is higher.\" norm X . sX.U , 2 sX.V , 2 ' . sX.S 2 md\"and so on\" norm X . sX.U , 3 sX.V , 3 ' . sX.S 3 Markdown.MD Markdown.Admonition \"note\", \"Eckart Young Theorem\", md\"\"\" The Frobenius Norm of X is equal to the sum of squares of singular values. ```math ||X||^2 \\sigma 1^2 \\sigma 2^2 \\sigma 3^2 \\cdots ``` \"\"\" md\"Let's test this out...\" norm X ^2 Frobenius norm sum sX.S .^ 2 sum of squared singular values md\"Finally, we understand how to arrange singular vectors by importance, at least in the L2 sense.\" md\"\"\" Nullspace Now we are interested in a linear combination of the columns of a matrix that generates a zero vector. Other than the trivial case of multiplying all the columns with zero, when is such a non zero combination possible? Obviously, we cannot combine independent vectors to produce zero. \"\"\" Markdown.MD Markdown.Admonition \"note\", \"Counting Law\", md\"\"\" A matrix G has rank r then the equation G\\,m 0 has n r independent solutions, where n is the number of columns of G . \"\"\" md\"\"\" Appendix \"\"\" md\" Plots\" function myquiver v, names fill \"\", length v , colors fill \"black\", length v , title \"\" layout Layout title title, scene attr uirevision 1, aspectmode \"manual\", aspectratio attr x 1, y 1, z 1 , xaxis attr nticks 4, range 5, 5 , yaxis attr nticks 4, range 5, 5 , zaxis attr nticks 4, range 5, 5 , , p scatter x 0, vv 1 , y 0, vv 2 , z 0, vv 3 , mode \"markers lines\", marker attr size 2, symbol \"\", \"x\" , color color, set color to an array list of desired values opacity 0.8 , name name, type \"scatter3d\" for name, color, vv in zip names, colors, v return plot p, layout end myquiver g₁, g₂, G x₁p, x₂p , \"g₁\", \"g₂\", \"G m\" , \"black\", \"black\", \"red\" , \"Column space of G\" myquiver A1 , 1 , A1 , 2 , A1 , 3 , A1 , 4 , \"a₁\", \"a₂\", \"a₃\", \"a₄\" , fill \"black\", 4 , \"Columns of outerproduct u, v \" myquiver vcat X , i for i in 1 size X, 2 , sX.U , i . sX.S i for i in 1 ns , fill nothing, 20 ns , vcat fill \"black\", 20 , fill nothing, ns , \" ns Orthonormal Singular Vector s \" md\"\"\" Resources ^Book Linear algebra and learning from data, Gilbert Strang ^Youtube Essence of linear algebra https www.youtube.com playlist?list PLZHQObOWTQDPD3MizzM2xVFitgF8hE ab , 3Blue1Brown \"\"\" "},{"url":"logistics/","title":"Course Logistics","tags":["welcome"],"text":"main a img {\n    width: 5rem;\n    margin: 1rem;\n}\n Grading Describe here the logistics of your class."},{"url":"references/","title":"References","tags":["welcome"],"text":"main a img {\n    width: 5rem;\n    margin: 1rem;\n}\n Books Menke, William. Geophysical data analysis: Discrete inverse theory. Academic press, 2018. Tarantola, Albert. Inverse problem theory and methods for model parameter estimation. Society for industrial and applied mathematics, 2005. Robinson, Enders A., and Sven Treitel. Geophysical signal analysis. Society of Exploration Geophysicists, 2000 A. Blum, J. Hopcroft, and R. Kannan (2020) Foundations of Data Sciences, Cambridge University Press James, G., Witten, D., Hastie, T., & Tibshirani, R. (2013). An introduction to statistical learning (Vol. 112, p. 18). New York: Springer. Boyd, Stephen, and Lieven Vandenberghe. Introduction to applied linear algebra: vectors, matrices, and least squares. Cambridge university press, 2018. Video Lectures Essence of linear algebra , 3Blue1Brown"},{"url":"search/","title":"Search results","tags":[],"text":"window.init_search(); Search Results \nLoading..."},{"url":"assets/scripts/get_highlights/","title":"get_highlights","tags":[],"text":"if isempty get metadata \"homepage\" , \"highlights\", nothing else highlights htl \"\"\" section div class \"content\" h2 x \"name\" h2 p x \"text\" p div div class \"preview\" img src \" x \"img\" \" div section \"\"\" for x in metadata \"homepage\" \"highlights\" htl \"\"\" div class \"subjectscontainer wide\" h1 Highlights h1 div class \"contain\" highlights div div \"\"\" end"},{"url":"assets/scripts/get_subjects/","title":"get_subjects","tags":[],"text":"let sections metadata \"sidebar\" sections htl \"\"\" let input other page.input output other page.output name get output.frontmatter, \"title\", basename input.relative path desc get output.frontmatter, \"description\", nothing tags get output.frontmatter, \"tags\", String image get output.frontmatter, \"image\", nothing class \"no decoration\", \"tag replace x, \" \" \" \" \" for x in tags ..., image nothing || isempty image ? nothing htl \"\"\" a title desc class class href root url \" \" other page.url h3 name h3 img src image a \"\"\" end for other page in collections section id .pages \"\"\" for section id, section name in sections isempty sections ? nothing htl \"\"\" div class \"wide subjectscontainer\" h1 Subjects h1 div class \"subjects\" sections div div \"\"\" end"},{"url":"mod1_inverse_theory/deconvolution/","title":"deconvolution","tags":[],"text":" A Pluto.jl notebook v0.19.41 using Markdown using InteractiveUtils This Pluto notebook uses bind for interactivity. When running this notebook outside of Pluto, the following 'mock version' of bind gives bound variables a default value instead of an error . macro bind def, element quote local iv try Base.loaded modules Base.PkgId Base.UUID \"6e696c72 6542 2067 7265 42206c756150\" , \"AbstractPlutoDingetjes\" .Bonds.initial value catch b missing end local el esc element global esc def Core.applicable Base.get, el ? Base.get el iv el el end end using PlutoUI, LinearAlgebra, PlutoPlotly, DSP, ToeplitzMatrices, FFTW using HDF5 using Deconvolution TableOfContents md\" Deconvolution\" md\" Discrete Convolution\" bind resetfg CounterButton \"Reset\" md\"\"\" | | | | | | | | | | | | | | | | | | | | | | | f₁ bind f1 Scrubbable 1 0.1 1, default 0.9 | f₂ bind f2 Scrubbable 1 0.1 1, default 0.0 | f₃ bind f3 Scrubbable 1 0.1 1, default 0.5 | f₄ bind f4 Scrubbable 1 0.1 1, default 0.0 | f₅ bind f5 Scrubbable 1 0.1 1, default 0.9 | f₆ bind f6 Scrubbable 1 0.1 1, default 0.0 | f₇ bind f7 Scrubbable 1 0.1 1, default 0.0 | f₈ bind f8 Scrubbable 1 0.1 1, default 0.0 | f₉ bind f9 Scrubbable 1 0.1 1, default 0.0 | f₁₀ bind f10 Scrubbable 1 0.1 1, default 0.0 | | g₁ bind g1 Scrubbable 1 0.1 1, default 1.0 | g₂ bind g2 Scrubbable 1 0.1 1, default 1.0 | g₃ bind g3 Scrubbable 1 0.1 1, default 0.0 | g₄ bind g4 Scrubbable 1 0.1 1, default 0.0 | g₅ bind g5 Scrubbable 1 0.1 1, default 0.0 | g₆ bind g6 Scrubbable 1 0.1 1, default 0.0 | g₇ bind g7 Scrubbable 1 0.1 1, default 0.0 | g₈ bind g8 Scrubbable 1 0.1 1, default 0.0 | g₉ bind g9 Scrubbable 1 0.1 1, default 0.0 | g₁₀ bind g10 Scrubbable 1 0.1 1, default 0.0 | resetfg \"\"\" f f1, f2, f3, f4, f5, f6, f7, f8, f9, f10 f g g1, g2, g3, g4, g5, g6, g7, g8, g9, g10 g G Array LowerTriangularToeplitz g plot heatmap z G d1 G f let p make subplots rows 3, cols 1, shared xaxes true, vertical spacing 0.02 add trace p, scatter x 1 length d1 , y d1, name \"conv f,g \" , row 3, col 1 add trace p, scatter x 1 length g , y g, name \"g\" , row 2, col 1 add trace p, scatter x 1 length f , y f, name \"f\" , row 1, col 1 relayout p, title text \"Convolution\", height 600, width 600 p end plot svd G .S rank G G pinv pinv G plot heatmap z G pinv plot G pinv , 3 plot svd G .U , end 1 fhat pinv G d1 plot fhat plot f md\" Deconvolution\" md\"We aim to construct an inverse filter of the following signal\" md\"Toeplitz matrix to perform convolution\" md\" Appendix\" ╠═╡ Gairgun pinv pinv Gairgun noise ╠═╡ m zeros size airgun, 1 m im 1.0 m 100 0.5 m 120 0.8 d Gairgun m bind rtol pinv Slider range 0, 0.5, length 100 , show value true md\" Noise bind eps Slider range 0.0, 0.1, length 1000 , show value true \" plot heatmap z G pinv G function get airgun airgun 0.0019455 0.31999 0.0038911 0.66316 0.0058366 0.86648 0.0077821 0.96656 0.0097276 1 0.011673 0.93253 0.013619 0.34515 0.015564 0.44781 0.01751 0.48336 0.019455 0.5189 0.021401 0.55209 0.023346 0.59392 0.025292 0.68945 0.027237 0.81781 0.029183 0.91316 0.031128 0.78497 0.033074 0.38476 0.035019 0.076951 0.036965 0.086752 0.038911 0.21784 0.040856 0.29985 0.042802 0.32102 0.044747 0.32677 0.046693 0.33102 0.048638 0.3338 0.050584 0.33514 0.052529 0.32802 0.054475 0.29396 0.05642 0.26859 0.058366 0.25177 0.060311 0.23896 0.062257 0.23429 0.064202 0.24808 0.066148 0.27332 0.068093 0.2945 0.070039 0.31735 0.071984 0.33727 0.07393 0.34648 0.075875 0.14177 0.077821 0.37562 0.079767 0.87791 0.081712 0.89059 0.083658 0.89326 0.085603 0.80043 0.087549 0.65179 0.089494 0.47611 0.09144 0.27827 0.093385 0.074001 0.095331 0.10743 0.097276 0.24002 0.099222 0.29809 0.10117 0.31486 0.10311 0.31903 0.10506 0.32185 0.107 0.32347 0.10895 0.32406 0.11089 0.31521 0.11284 0.29185 0.11479 0.26807 0.11673 0.25313 0.11868 0.23954 0.12062 0.23031 0.12257 0.22912 0.12451 0.23333 0.12646 0.23991 0.1284 0.24646 0.13035 0.25062 0.1323 0.24505 0.13424 0.20885 0.13619 0.015198 0.13813 0.2673 0.14008 0.34262 0.14202 0.42791 0.14397 0.42477 0.14591 0.41847 0.14786 0.40802 0.14981 0.36234 0.15175 0.2916 0.1537 0.19553 0.15564 0.093273 0.15759 0.0030751 0.15953 0.089305 0.16148 0.14768 0.16342 0.18526 0.16537 0.20179 0.16732 0.20756 0.16926 0.211 0.17121 0.21146 0.17315 0.20567 0.1751 0.19503 0.17704 0.18266 0.17899 0.1717 0.18093 0.16365 0.18288 0.15677 0.18482 0.14909 0.18677 0.13862 0.18872 0.12337 0.19066 0.080138 0.19261 0.0028842 0.19455 0.093647 0.1965 0.18345 0.19844 0.22087 0.20039 0.24756 0.20233 0.25953 0.20428 0.25981 0.20623 0.25433 0.20817 0.22079 0.21012 0.1688 0.21206 0.11249 0.21401 0.063461 0.21595 0.0069556 0.2179 0.04728 0.21984 0.080277 0.22179 0.088373 0.22374 0.094356 0.22568 0.099036 0.22763 0.1024 0.22957 0.10443 0.23152 0.10511 0.23346 0.10345 0.23541 0.098763 0.23735 0.091573 0.2393 0.082384 0.24125 0.071706 0.24319 0.060049 0.24514 0.04736 0.24708 0.030436 0.24903 0.0072266 0.25097 0.024014 0.25292 0.090696 0.25486 0.14445 0.25681 0.16997 0.25875 0.16849 0.2607 0.16494 0.26265 0.15984 0.26459 0.15374 0.26654 0.14395 0.26848 0.12755 0.27043 0.10693 0.27237 0.084535 0.27432 0.062808 0.27626 0.042372 0.27821 0.020829 0.28016 0.00026162 0.2821 0.02051 0.28405 0.043459 0.28599 0.06294 0.28794 0.07142 0.28988 0.070491 0.29183 0.068005 0.29377 0.064614 0.29572 0.060962 0.29767 0.05753 0.29961 0.054005 0.30156 0.049899 0.3035 0.044727 0.30545 0.038004 0.30739 0.027892 0.30934 0.0011971 0.31128 0.037038 0.31323 0.05843 0.31518 0.067327 0.31712 0.074797 0.31907 0.080552 0.32101 0.084303 0.32296 0.08576 0.3249 0.082045 0.32685 0.0714 0.32879 0.056901 0.33074 0.041651 0.33268 0.028728 0.33463 0.016548 0.33658 0.0030656 0.33852 0.010982 0.34047 0.024856 0.34241 0.037819 0.34436 0.049133 0.3463 0.058061 0.34825 0.063865 0.35019 0.065807 0.35214 0.063886 0.35409 0.058991 0.35603 0.051847 0.35798 0.043181 0.35992 0.033721 0.36187 0.024001 0.36381 0.010948 0.36576 0.0048216 0.3677 0.020755 0.36965 0.034907 0.3716 0.050599 0.37354 0.065825 0.37549 0.076856 0.37743 0.080056 0.37938 0.076418 0.38132 0.068503 0.38327 0.057628 0.38521 0.045108 0.38716 0.027993 0.38911 0.0018992 0.39105 0.016215 0.393 0.025808 0.39494 0.033916 0.39689 0.039877 0.39883 0.043029 0.40078 0.043154 0.40272 0.041901 0.40467 0.039605 0.40661 0.036386 0.40856 0.032366 0.41051 0.027664 0.41245 0.019005 0.4144 0.0014679 0.41634 0.020129 0.41829 0.040631 0.42023 0.055326 0.42218 0.06826 0.42412 0.077979 0.42607 0.079818 0.42802 0.075647 0.42996 0.067681 0.43191 0.057143 0.43385 0.045255 0.4358 0.033241 0.43774 0.022322 0.43969 0.012652 0.44163 0.0013361 0.44358 0.0096963 0.44553 0.017938 0.44747 0.020899 0.44942 0.020899 0.45136 0.020899 0.45331 0.020899 0.45525 0.020899 0.4572 0.018299 0.45914 0.010555 0.46109 0.0002438 0.46304 0.010003 0.46498 0.018837 0.46693 0.028262 0.46887 0.037434 0.47082 0.045266 0.47276 0.051804 0.47471 0.058434 0.47665 0.064617 0.4786 0.069758 0.48054 0.073264 0.48249 0.074541 0.48444 0.074541 0.48638 0.074541 0.48833 0.074541 0.49027 0.074541 0.49222 0.074541 0.49416 0.071528 0.49611 0.061626 0.49805 0.047009 0.5 0.029947 airgun t airgun , 1 airgun airgun , 2 airgun . tukey length airgun , 0.5 airgun vcat airgun, zeros 200 nt length airgun responsetype Bandpass 0.15, 0.35 designmethod Butterworth 2 airgun filtfilt digitalfilter responsetype, designmethod , airgun airgun . Toeplitz vcat ones 100 , zeros nt 100 ,vcat 1 ,zeros nt 1 airgun return airgun t, airgun end airgun t, airgun get airgun plot airgun t, airgun, Layout width 500, height 250,xaxis attr title \"time s \" , yaxis attr title \"amplitude\" , title \"Source Signal g t \" Gairgun Array LowerTriangularToeplitz airgun plot heatmap z Gairgun , Layout yaxis attr autorange \"reversed\" , title \"G Toeplitz Matrix To Perform Convolution With g t \" rank Gairgun airgun noise airgun eps randn length airgun Gairgun noise Array LowerTriangularToeplitz airgun noise svd Gairgun noise svd Gairgun noise plot svd Gairgun noise.S, Layout title \"Singular Values of G\" bind isG Slider 1 length svd Gairgun noise.S , show value true plot svd Gairgun .U , isG Gairgun pinv pinv Gairgun noise, rtol rtol pinv plot Gairgun pinv Gairgun , 100 plot heatmap z Gairgun pinv Gairgun plot heatmap z Gairgun Gairgun pinv begin m exp. 20000 airgun t. 0.15 .^2 m . 0.5 exp. 200000 airgun t. 0.2 .^2 m . 0.3 exp. 20000 airgun t. 0.25 .^2 fill m, 0.0 m 50 1.0 end d Gairgun m plot pinv Gairgun d, Layout title \"Estimated f t \" dnoise eps randn length d d plot hcat d, dnoise plot randn length d restored d lucy d, airgun noise, iterations 3000 restored d2 wiener d, randn length airgun noise , randn length airgun noise , airgun noise plot restored d2 plot Gairgun pinv d plot m, Layout title \"True f t \" plot hcat m, pinv Gairgun, rtol rtol pinv dnoise h5open \"deconvolution.h5\", \"w\" do file write file, \"data\", dnoise write file, \"impulse response\", airgun write file, \"time\", airgun t alternatively, say \" write file A\" end length airgun length airgun t bind im Slider 1 length airgun , show value true plot abs. rfft airgun Toeplitz vcat ones 30 , zeros size airgun,1 30 ,vcat 1 ,zeros size airgun,1 1 "},{"url":"mod1_inverse_theory/elastic-net/","title":"Lasso and Elastic Net","tags":["module1"],"text":" A Pluto.jl notebook v0.19.36 frontmatter chapter \"1\" layout \"layout.jlhtml\" tags \"module1\" title \"Lasso and Elastic Net\" using Markdown using InteractiveUtils This Pluto notebook uses bind for interactivity. When running this notebook outside of Pluto, the following 'mock version' of bind gives bound variables a default value instead of an error . macro bind def, element quote local iv try Base.loaded modules Base.PkgId Base.UUID \"6e696c72 6542 2067 7265 42206c756150\" , \"AbstractPlutoDingetjes\" .Bonds.initial value catch b missing end local el esc element global esc def Core.applicable Base.get, el ? Base.get el iv el el end end using HDF5 using PlutoPlotly, LinearAlgebra, PlutoUI, GLMNet, Statistics, StatsBase TableOfContents md\"\"\" Gravity Inversion Lasso and Elastic Net In this exercise, we are interested in the numerical approximation of the gravity of an extended body. The gravitational potential at a point P external to that body is given by Eq. 3.13 , ```math U g G\\, \\int x \\int y \\int z \\frac \\rho x,y,z r x,y,z \\,dx\\,dy\\,dz\\,, ``` where G is the gravitational constant, \\rho x,y,z is the density at some location x,y,z , and r x,y,z is the distance between x,y,z and the observation point P . To numerically solve the integral, we discretize the spatial domain into evenly spaced grid points x i, y i, z i , separated by some small distance h . We then obtain an approximation of U g by summing over all grid points, ```math U g \\approx G\\,\\sum i \\frac \\rho x i,y i,z i r x i,y i,z i \\,V\\,, ``` where the small volume V is given by V h^3\\approx dx\\,dy\\,dz . The product \\rho x i,y i,z i V equals the mass m i contained in the small volume V . Renaming r i r x i,y i,z i , we may rewrite the above equation as ```math U g \\approx G\\,\\sum i \\frac m i r i \\,, ``` which is identical to equation 3.12 in the text. An approximation that we will make throughout this exercise is that the Earth is contained in a small rectangular box. Though this is obviously not realistic, it greatly simplifies the calculations, while still illustrating the basic principles. \"\"\" md\"\"\" Elastic Net α bind alphaselect Slider range 0, 1, length 101 , show value true, default 0.9 \"\"\" md\"\"\" Constrain on density? bind constraint CheckBox with maximum bind maximum density Slider show value true, range 3000, 10000, length 10 \"\"\" bind invG type Select \"Pseudo Inverse\", \"Ridge Regression\", \"Lasso\", \"Elastic Net\" md\" Error Bowls\" md\"\"\" The objective function for Elastic Net proposed by Zou and Hastie 2005 is given by ```math L m, \\lambda, \\alpha \\frac 1 2 \\|Gm d\\| 2^2 P m, \\lambda, \\alpha , ```where ```math P m, \\lambda, \\alpha \\lambda\\left 1 \\alpha \\frac 1 2 \\|m\\|^2 2 \\alpha \\|m\\| 1\\right . ``` The hyperparameter to be tuned in the Elastic Net is the value for \\alpha where, \\alpha \\in 0, 1 \"\"\" md\"\"\" In addition, Zou and Hastie 2005 showed that L1–L2 norm regularization encourages a “grouping effect”, which means that the elements of the solution corresponding to the highly correlated columns of X have similar estimated values. By this enforcing of the grouping effect, the second drawback is mitigated. For the details of this point, please refer to section 2.3 of Zou and Hastie As the result of L1–L2 norm regularization, the effect that the L1 norm regularized solution is overly concen trated is resolved by introducing the L2 norm constraint, and at the same time, the sparse nature of the model is also provided by the L1 norm constraint \"\"\" md\" Physics\" gravity const 6.67508e 11 begin Dimension of the computational domain km . x min 50.0 x max 50.0 z min 0 z max 50 nx 201 nz 101 Coordinate axes. xgrid range x min,stop x max,length nx dx step xgrid zgrid range z min,stop z max,length nz dz step zgrid Grid spacing m and cell volume A step xgrid step zgrid X first. Iterators.product xgrid, zgrid Z last. Iterators.product xgrid, zgrid xv,zv meshgrid xgrid,zgrid Define some density distribution. mtrue zeros nz, nx mtrue 50 80,65 70 . 10.0 mtrue 70 80,160 190 . 5500.0 mtrue 1 20,140 160 . 10.0 mtrue 40 60,10 30 . 5500.0 end md\"\"\" bind x bowl1 Slider xgrid, show value true, default mean xgrid bind z bowl1 Slider zgrid, show value true, default mean zgrid \"\"\" md\"\"\" bind x bowl2 Slider xgrid, show value true, default mean xgrid bind z bowl2 Slider zgrid, show value true, default mean zgrid \"\"\" mtrue Plot density distribution. begin Define observation points. xobs xgrid zobs 10.0. ones length xobs Initialize gravitational potential. U zeros nx Loop over all observation points. for k in range length x obs r np.sqrt x obs k xv ^2 z obs k zv ^2 U k G V np.sum rho r end end begin G mapreduce hcat, xobs, zobs do x, z r . sqrt abs2 X x abs2 Z z 1e3 . gravity const A r end end function plot error bowl ix1 argmin abs2. xgrid . x bowl1 iz1 argmin abs2. zgrid . z bowl1 ix2 argmin abs2. xgrid . x bowl2 iz2 argmin abs2. zgrid . z bowl2 m zeros nz, nx m1 zeros nz, nx m iz1, ix1 500.0 m iz2, ix2 500.0 d G vec m rho values range 0, 1000, length 50 rho iterator Iterators.product rho values, rho values bowl map first. rho iterator , last. rho iterator do m11, m22 fill m1, 0.0 m1 iz1, ix1 m11 m1 iz2, ix2 m22 abs2 norm G vec m1 d, 2 end show size bowl plot surface contours attr x attr show true, start 1.5, size 0.04, color \"white\" , x end 2, z attr show true, start 0.5, size 0.05 , z end 0.8 , x rho values, y rho values, z bowl , Layout scene attr xaxis nticks 20, zaxis nticks 4, camera eye attr x 0, y 1, z 0.5 , aspectratio attr x 1, y 1, z 0.2 plot heatmap z bowl end plot error bowl data observed G vec mtrue h5open \"gravity data.h5\", \"w\" do file write file, \"G\", G write file, \"d\", data observed alternatively, say \" write file A\" end plot data observed Gpinv pinv G bind λ Slider 0.1 0.9 qrG qr G G' G F svd G plot F.S md\" Inversion\" md\" Constraints\" constraints if constraint cat zeros nx nz ', maximum density ones nx nz ', dims 1 else cat fill Inf, nx nz ', fill Inf, nx nz ', dims 1 end alphaused if invG type \"Lasso\" 1.0 elseif invG type \"Ridge Regression\" 0.0 else alphaselect end path glmnet G, data observed, alpha alphaused, constraints copy constraints md\"\"\" Select Lasso Path λ bind lambdaselect Slider path.lambda, show value true, default last path.lambda \"\"\" result if invG type \"Pseudo Inverse\" mhat pinv G data observed data predicted G mhat mhat, data predicted, data observed else mhat path.betas ,findfirst x x lambdaselect, path.lambda data predicted GLMNet.predict path, G ,findfirst x x lambdaselect, path.lambda mhat, data predicted, data observed end md\" Appendix\" md\" Plots\" function plot densitymap rho, title \"density distribution\" R reshape rho, length zgrid , length xgrid plot heatmap x xgrid, y zgrid, z R , Layout width 500, height 300, title string title, \" kg m³ \" , xaxis attr title \"x km \" , yaxis attr autorange \"reversed\",title \"z km \" end PlutoUI.ExperimentalLayout.vbox plot densitymap mtrue, \"true mass density\" , plot densitymap result.mhat, \"predicted mass density\" function plot data data, title \"data\", names fill \"\", size data,2 D cat data,dims 2 plot scatter x xgrid, y d, name name for d, name in zip eachslice D, dims 2 , names , Layout width 500,height 300, title title, xaxis attr title \"x km \" , yaxis attr title \"gravitational potential\" end plot data hcat result.data predicted, data observed , \"observed vs predicted data\", \"predicted\", \"observed\" "},{"url":"mod1_inverse_theory/factor-analysis/","title":"Factor Analysis","tags":["module1"],"text":" A Pluto.jl notebook v0.19.36 frontmatter chapter \"1\" title \"Factor Analysis\" tags \"module1\" layout \"layout.jlhtml\" using Markdown using InteractiveUtils This Pluto notebook uses bind for interactivity. When running this notebook outside of Pluto, the following 'mock version' of bind gives bound variables a default value instead of an error . macro bind def, element quote local iv try Base.loaded modules Base.PkgId Base.UUID \"6e696c72 6542 2067 7265 42206c756150\" , \"AbstractPlutoDingetjes\" .Bonds.initial value catch b missing end local el esc element global esc def Core.applicable Base.get, el ? Base.get el iv el el end end using CSV, DataFrames, LinearAlgebra, PlutoPlotly, PlutoUI, Distributions TableOfContents md\"\"\" Factor Analysis The purpose of this notebook is to show the importance of factoring the observed data matrix. \"\"\" md\" Geomorphology Mountain Profiles\" md\" Atmospheric Pressure Fluctuations\" md\"\"\" Perturbation of atmospheric pressure measured in ` x,y ` plane at time `t` bind it atm Slider 1 25, show value true \"\"\" bind it atm2 Slider 1 25, show value true md\" Petrologic Database\" md\"We apply factor analysis to rock chemistry data taken from a petrologic database PetDB at www.petdb.org . This database contains chemical information on igneous and metamorphic rocks collected from the floor of all the world’s oceans, but we analyze here N 1⁄4 6356 samples from the Atlantic Ocean that have the following chemical species SiO2, TiO2, Al2O3, FeOtotal, MgO, CaO, Na2O, and K2O units of weight percent .\" bind resample data CounterButton \"Resample Data\" element names \"SiO₂\", \"TiO₂\", \"Al₂O₃\",\"FeO\", \"MgO\", \"CaO\", \"Na₂O\", \"K₂O\" md\" Appendix\" md\" Data\" rocks CSV.read \"rocks.txt\", DataFrame, header false nsamples size rocks, 1 nelements size rocks, 2 s svd Array rocks ' plot s.S, Layout title \"Singular Values\" s.U begin mountains zeros 15,11 mountains 1, 0, 1, 2, 3, 4, 5, 4, 3, 2, 1, 0 mountains 2, 0, 2, 3, 4, 5, 6, 5, 4, 3, 1, 0 mountains 3, 0, 1, 2, 4, 5, 6, 5, 4, 2, 1, 0 mountains 4, 0, 1, 3, 5, 5, 4.5, 4, 3.5, 3, 2.5, 0 mountains 5, reverse mountains 4, mountains 6, 0, 6, 6, 6, 5, 5, 5, 3.5, 2, 1, 0 mountains 7, reverse mountains 6, mountains 8, 0, 0.25, 0.5, 1, 3, 6, 3, 1, 0.5, 0.25, 0 mountains 9, 0, 1, 2.5, 3, 4, 6, 4, 3, 2.5, 1, 0 mountains 10, 0, 1, 2, 4, 6, 4, 2, 1, 1, 0.5, 0 mountains 1, reverse mountains 10, mountains 12, 0, 0, 0.5, 0, 1, 1, 2, 4, 6, 3, 0 mountains 13, reverse mountains 12, mountains 14, 0, 0, 0.5, 1, 3, 6, 5.5, 5.5, 4.5, 3.5, 0 mountains 15, reverse mountains 14, end function get atm pressure data Nx 20 Nx2 Nx Nx dx 1.0 L dx Nx 1 x dx collect 0 Nx 1 ' m0 zeros Nx,Nx m1 zeros Nx,Nx m2 zeros Nx,Nx for p 1 Nx for q 1 Nx m0 p,q sin pi x p L . sin pi x q L m1 p,q sin pi x p L . sin 2 pi x q L m2 p,q sin 2 pi x p L . sin 3 pi x q L end end build data with modes with these amplitudes at different times c0 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 ' c1 1, 2, 3, 4, 5, 5, 4, 3, 2, 1, 1, 2, 3, 4, 5, 5, 4, 3, 2, 1, 1, 2, 3, 4, 5 ' c2 0, 0, 0, 1, 2, 3, 2, 1, 0, 0, 0, 0, 1, 2, 1, 0, 0, 0, 0, 0, 1, 2, 3, 2, 1 ' Nt 25 D zeros Nx, Nx, Nt for it in 1 Nt D , ,it . c0 it m0 c1 it m1 c2 it m2 0.7 randn Nx,Nx end return D end atm pressure get atm pressure data plot heatmap z atm pressure , , it atm , colorscale \"jet\", showscale false , Layout title \"t it atm\", width 200, height 200,xaxis attr showticklabels false , yaxis attr showticklabels false atm pressure size atm pressure data matrix atm pressure reshape atm pressure, , 25 s atm svd data matrix atm pressure s atm.Vt data matrix atm pressure hat s atm.U Diagonal s atm.S s atm.Vt C s atm.U R Diagonal s atm.S s atm.Vt size C plot heatmap z reshape C , it atm2 , 20, 20 , colorscale \"jet\", showscale false , Layout title \"Singular Vector it atm2\", width 200, height 200,xaxis attr showticklabels false , yaxis attr showticklabels false plot R 1, plot R 2, plot R 3, plot R 4, plot R 5, C R ≈ data matrix atm pressure data matrix atm pressure ≈ data matrix atm pressure hat md\" Plots\" function sample plot z, title plot heatmap y element names, z z, showscale false, zmin 1,zmax 1,colorscale \"Blackbody\" , Layout title string title , width 125, xaxis attr showticklabels false end let resample data R transpose Array rocks map rand 1 nsamples, 5 do i sample plot log. R , i i , i end end map 1 5 do i sample plot s.U ,i i , i end "},{"url":"mod1_inverse_theory/least-squares-line-fitting/","title":"Least Squares Line Fitting","tags":["module1"],"text":" A Pluto.jl notebook v0.19.38 frontmatter chapter \"1\" title \"Least Squares Line Fitting\" tags \"module1\" layout \"layout.jlhtml\" using Markdown using InteractiveUtils This Pluto notebook uses bind for interactivity. When running this notebook outside of Pluto, the following 'mock version' of bind gives bound variables a default value instead of an error . macro bind def, element quote local iv try Base.loaded modules Base.PkgId Base.UUID \"6e696c72 6542 2067 7265 42206c756150\" , \"AbstractPlutoDingetjes\" .Bonds.initial value catch b missing end local el esc element global esc def Core.applicable Base.get, el ? Base.get el iv el el end end using LinearAlgebra, PlutoUI, PlutoTeachingTools, Symbolics, Distributions, PlutoPlotly TableOfContents md\" Fitting A Straight Line\" md\"We will consider a simple inverse problem here Suppose that N temperature measurements Ti are made at times ti in the atmosphere. We assume that the temperature is a simple linear function of time. There are two model parameters in this problem, the slope of the straight line and its y intercept. \" md\"\"\" Configuration bind config MultiCheckBox \"Additive Gaussian Noise\", \"Outlier\", \"Constraint\" , default \"Additive Gaussian\", \"Constraint\" \"\"\" md\"\"\" Click to regenerate 1 bind renoise Button \"Noise\" 2 bind reout Button \"Outlier\" 3 bind recon Button \"Constraint\" \"\"\" Markdown.MD Markdown.Admonition \"warning\", \"Intuition\", md\"\"\" Regenerate noise to notice that the variance along the y intercept dimension is higher than the variance along the slope dimension. This means the estimate of the slope is less uncertain than the y intercept. Notice the broad minimum along the y intercept dimension compared to the sharp minimum along the slope dimension. \"\"\" md\"\"\" Line Fitting \"\"\" begin sloper range 2, stop 5, length 100 range for slope yintr range 2, stop 5, length 100 range for y intercept end begin choose the number of data points and control variable x N 10 change this to K x range 1, stop N end forward map G hcat x, ones N G' G choose true model parameters mtrue 3.0, 0.4 md\"\"\" Least squares functional has the form ```math J G\\cdot m d ^\\top \\cdot G\\cdot m d ``` which can be written as ```math J m^\\top G^\\top G\\,m\\, \\,2\\,m^\\top\\,G^\\top\\,d\\, d^\\top\\,d ``` gradient w.r.t. m ```math \\frac \\partial J \\partial m 2\\cdot G^\\top \\cdot G\\cdot m d ``` solution using the Moore Penrose inverse ```math G^TG ^ 1 G^Td ``` \"\"\" md\"\"\" Notice that the columns of G are linearly independent, therefore G^\\top G is invertible. \"\"\" y nonoise G mtrue G⁻ᵍ inv transpose G G transpose G m slope, yintercept md\"\"\" Error Bowl \"\"\" Markdown.MD Markdown.Admonition \"formula\", \"Gradient and Hessian of Linear and Quadratic Functions\", md\"\"\" A linear function of the form ```math f m a^\\top\\,m ``` had gradient \\nabla\\,f a . The quadratic function of the form ```math f m m^\\top\\,A\\,m ``` has gradient \\nabla\\,f A A^\\top \\,m and Hessian \\nabla^2\\,f A A^\\top . These results can be derived by utilizing summation notation, taking partial derivatives, and subsequently recombining these partial derivatives into matrix form. \"\"\" plot heatmap x \"1\", \"2\" ,y \"1\",\"2\" , z G' G , Layout title \"Hessian Matrix\", width 550 generate observed data and add noise begin renoise y randnoise copy y nonoise some random noise to the data if \"Additive Gaussian Noise\" ∈ config y randnoise . randn N 0.5 end end begin reout y copy y randnoise add an outlier if \"Outlier\" ∈ config y rand 1 N 2.0 end end mest G⁻ᵍ y Jbowl broadcast Iterators.product sloper, yintr do m1, m2 sum abs2. G m1, m2 . y end md\"\"\" Constrained Problem Number of constraints P ```math Hm h 0 ``` \"\"\" begin recon x1 rand Uniform 1, 4 y1 rand Uniform extrema y ... end H x1, 1 ' h y1 md\"\"\" ```math \\begin bmatrix G^TG & H^T \\\\ H & 0 \\end bmatrix \\begin bmatrix m \\\\ \\lambda \\end bmatrix \\begin bmatrix G^Td \\\\ h \\end bmatrix ``` \"\"\" md\"\"\" Lagrangian The Lagrangian is a function of m\\in\\mathbb R ^N and \\lambda\\in\\mathbb R ^P , i.e., N P variables. We produce N equations when differentiating w.r.t. each element of m and P equations when differentiating w.r.t. each element of \\lambda . \"\"\" md\"\"\" Lagrangian ```math \\mathbb L G\\cdot m d ^\\top \\cdot G\\cdot m d λ^\\top \\cdot H\\cdot m h ``` gradient w.r.t. m ```math \\frac \\partial \\mathbb L \\partial m 2\\cdot G^\\top \\cdot G\\cdot m d H^\\top \\cdot \\lambda ``` gradient w.r.t. \\lambda ```math \\frac \\partial \\mathbb L \\partial \\lambda H\\cdot m h ``` \"\"\" yc G' y y1 Gc G' G H' H 0 mestc inv transpose Gc Gc transpose Gc yc mestc md\" Data Resolution Matrix\" Rd G G⁻ᵍ plot heatmap x string. 1 size Rd,1 ,y string. 1 size Rd,1 ,z Rd ,Layout title \"Data Resolution Matrix\", width 550 md\"\"\" The diagonal elements of Data resolution matrix indicate how much weight a datum has in its own prediction. The diagonal elements are often singled out and called importance of the data. In this case, \"\"\" plot scatter x x, y diag Rd , Layout title \"Data Importance\", xlabel \"x\" md\"\"\" Curvature for the prediction error given by the second derivative \"\"\" md\" Model Resolution Matrix\" Rm G⁻ᵍ G plot heatmap x \"1\",\"2\" , y \"1\",\"2\" ,z Rm , Layout title \"Model Resolution Matrix\", width 550 md\" Appendix\" md\" Global Temperature Data Hansen, J., R. Ruedy, Mki. Sato, and K. Lo, 2010 Global surface temperature change. Rev. Geophys., 48, RG4004, doi 10.1029 2010RG000345\" global temp data 1965 0.11 1966 0.03 1967 0.01 1968 0.04 1969 0.08 1970 0.03 1971 0.10 1972 0.00 1973 0.14 1974 0.08 1975 0.05 1976 0.16 1977 0.12 1978 0.01 1979 0.08 1980 0.19 1981 0.26 1982 0.04 1983 0.25 1984 0.09 1985 0.04 1986 0.12 1987 0.27 1988 0.31 1989 0.19 1990 0.36 1991 0.35 1992 0.13 1993 0.13 1994 0.23 1995 0.37 1996 0.29 1997 0.39 1998 0.56 1999 0.32 2000 0.33 2001 0.47 2002 0.56 2003 0.55 2004 0.48 2005 0.62 2006 0.55 2007 0.58 2008 0.44 2009 0.58 2010 0.63 plot scatter x global temp data , 1 , y global temp data ,2 , name \"a\" , , Layout xaxis attr title \"Year\" , yaxis attr title \"Temperature Anomaly °C \" md\"\"\" References Useful resources for matrix calculus https www.matrixcalculus.org https www.matrixcalculus.org http www.ee.ic.ac.uk hp staff dmb matrix intro.html http www.ee.ic.ac.uk hp staff dmb matrix intro.html \"\"\" md\" Plots\" pbowl let s contour x yintr, y sloper, z Jbowl, colorscale \"Hot\", colorbar attr thickness 25, thicknessmode \"pixels\", len 0.3, lenmode \"fraction\", outlinewidth 0 , scatter x mtrue 2 , y mtrue 1 , mode \"markers\",name \"True Model\", marker attr color green , scatter x mest 2 , y mest 1 , mode \"markers\", name \"Estimated Model\", marker attr color blue if \"Constraint\" ∈ config push s, scatter x mestc 2 , y mestc 1 , mode \"markers\", name \"Constrained Model\", marker attr color red push s, scatter x y1 . sloper . x1, y yintr, mode \"lines\", name \"Constraint\", marker attr color red end plot s, Layout xaxis attr title \"Intercept\" , yaxis attr title \"Slope\" end pline let s scatter x x, y y, mode \"markers\", name \"Observations\", marker attr color black , scatter x x, y G mest, mode \"lines\", name \"Estimated Model\", line attr color blue , scatter x x, y G mtrue, mode \"lines\", name \"True Model\", line attr color green if \"Constraint\" ∈ config push s, scatter x x1 , y y1 , mode \"markers\", name \"Constraint\", marker attr color red push s, scatter x x, y G mestc 1 2 , mode \"lines\", name \"Constrained Model\", line attr color red end plot s, Layout xaxis attr title \"Year\" , yaxis attr title \"Temperature Anomaly °C \" end PlutoUI.ExperimentalLayout.vbox pline, pbowl "},{"url":"mod1_inverse_theory/monte-carlo-sampling/","title":"Monte Carlo Methods","tags":[],"text":" A Pluto.jl notebook v0.19.40 frontmatter chapter \"1\" title \"Monte Carlo Methods\" layout \"layout.jlhtml\" description \"How can we balance the trade off between taking large steps with many rejections versus taking small steps with few rejections?\" using Markdown using InteractiveUtils This Pluto notebook uses bind for interactivity. When running this notebook outside of Pluto, the following 'mock version' of bind gives bound variables a default value instead of an error . macro bind def, element quote local iv try Base.loaded modules Base.PkgId Base.UUID \"6e696c72 6542 2067 7265 42206c756150\" , \"AbstractPlutoDingetjes\" .Bonds.initial value catch b missing end local el esc element global esc def Core.applicable Base.get, el ? Base.get el iv el el end end begin using Distributions, Plots, PlutoUI, PlutoTeachingTools using StatsPlots, MLUtils, Interpolations, Measures, ImageFiltering end TableOfContents ChooseDisplayMode md\" Monte Carlo Sampling\" bind sample true density Button \"Change True Density Model\" md\"\"\" Prior Movie bind sample prior density Button \"Sample Prior Density Models\" Smooth? bind smooth prior flag CheckBox default false \"\"\" md\"\"\" Posterior Movie bind sample posterior density Button \"Sample Posterior Density Models\" Smooth? bind smooth posterior flag CheckBox default false \"\"\" md\" Simpler Demo\" md\" Striking the balance\" Markdown.MD Markdown.Admonition \"wrg\", \" Large Steps & Many Rejects Vs. Small Steps & Few Rejects \", md\"\"\" The acceptance rate of the Metropolis criterion has to be around 30 50\\% . If the acceptance ex1 rate is, we are not moving fast enough in the model space. On the other hand, if the acceptance ex1 rate is much smaller, then we are wasting computer resources as most of the samples are not accepted. \"\"\" md\" Metropolis Criterion\" Markdown.MD Markdown.Admonition \"info\", \"Metropolis Criterion\", md\"\"\" Consider some random rules that define a random walk. This random walk, if unmodified, samples some initial probability distribution. The metropolis algorithm modifies the random walk, by accepting or rejecting a proposed transition m i\\to m j using the following rules if L m j ≥ L m i , then accept the proposed transition else if L m j L m i , then decide randomly whether to accept or reject, with the following probability of accepting the move to m j ```math P i\\to j \\frac L m j L m i . ``` It can be shown that the random walker samples the conjunction of the probability densities \\rho m and L m , given by ^1 ```math σ m \\rho m \\wedge\\,L m \\mathrm const . \\rho m L m ``` ^1 We have assumed the homogeneous distribution \\mu m to be a constant for simplicity. \"\"\" md\"\"\" This function takes three mandatory inputs `m0` which is the initial model, prior which is a function that samples from the prior distribution, and `L` which is a function that evaluates the likelihood of a model. The function also takes an optional input `N` which is the number of samples to generate and is set to 100 by default. The function generates samples using the Metropolis Hastings algorithm, which is a Markov Chain Monte Carlo MCMC method. It initializes the first sample to `m0`, and then repeatedly generates a new candidate sample using the prior function. It then evaluates the likelihood of the candidate sample using the `L` function and computes the Metropolis Hastings ratio. If the ratio is greater than a randomly generated number from a Bernoulli distribution, the candidate sample is accepted as the next sample, and the process is repeated until N samples are generated or the loop breaks. The function returns two objects `msamples ex1`, which is an array of the generated samples, and `acceptance ex1 history`, which is an array that keeps track of whether a sample was accepted or rejected at each step of the Metropolis Hastings algorithm. \"\"\" function generate samples m0, walk, L N 10 msamples ex1 push msamples ex1, m0 acceptance ex1 history metropolis ratios create an array to store previous model mp copy m0 evaluate the initial likelihood p current L nothing ? 1.0 L m0 i 0 while i ≤ N sample from prior to get destination m walk mp evaluate prob of destination p prop L nothing ? 1.0 L m metropolis ratio metropolis ratio p prop p current push metropolis ratios, metropolis ratio if rand Bernoulli min 1, metropolis ratio mp copy m p current p prop push msamples ex1, m push acceptance ex1 history, true i 1 else simply revert back push acceptance ex1 history, false end end return msamples ex1, acceptance ex1 history end md\" Simple 2D Example\" method to generate 2 D example target probability density function Lex1 m s1 1.0 s2 0.5 return exp 0.5 m 1 1.7 ^2 m 2 ^2 s1^2 2.0 pi s2 exp 0.5 m 1 2.0 ^2 m 2 ^2 s2^2 2.0 pi s2 end md\"\"\" Use Metropolis criterion? bind metro Select Lex1 \"Yes\", nothing \"No\" \"\"\" range ex1 range 10, stop 10, length 256 Lex1 grid Lex1 x, y for x in range ex1, y in range ex1 md\"\"\" This function generates a 2D random walk step by drawing two independent random numbers from a normal distribution with mean 0 and standard deviation 1, scaling them by a factor of 10, and returning them as a 2D vector. The resulting step is uncorrelated with any previous steps and is independent of the current position. This is an example of an independent random walk. \"\"\" md\"\"\" This function generates a proposal for a 2D random walk by adding random perturbations to the current model m based on a Gaussian distribution with standard deviation sigma of 1.0. This is a local proposal, where each step is a small perturbation around the current point. \"\"\" heatmap range ex1, range ex1, Lex1 grid, c grays, title \"Likelihood Distribution\", aspect ratio 1 md\" Gravity Example ^mosegaard1995 \" md\"\"\" Note that the complex prior knowledge used in this example renders the posterior distribution to be non Gaussian. \"\"\" xrange ex2 range 1, stop 40, length 20 ρrange 100, 6000 md\" Samplers\" md\"\"\" This sampler output neighbors of an input model by creating or destroying a new interface in the model. \"\"\" md\"\"\" Physics We measure the horizontal derivative of the vertical component of the acceleration due to gravity. Contribution from a homogeneous half layer is given by ```math G\\Delta\\rho\\,\\log\\left \\frac z 2^2 x^2 z 1^2 x^2 \\right , ``` where depth of the top pf the layer is z 1 the depth of the bottom is z 2 horizontal density contrast is \\Delta\\rho . \"\"\" function ggravity m, xrange xrange ex2 Gconst 6.6743 1e 11 m3 kg 1 s 2 ρ left half 2570 kg m3 l, ρ splitobs m, at 0.5 l l . 1e3 return broadcast xrange do x xm x 1e3 km to m data 0.0 d 0 first layer at zero depth for i in 1 length l data Gconst ρ i ρ left half log abs2 d l i abs2 xm inv abs2 d abs2 xm d l i depth of top of next layer end return data end end md\" Prior\" pρ Gumbel 3000, 400 plot pρ, w 2, label nothing, title \"Prior Mass Density Distribution\", c black, size 500, 250 pl Exponential 4 function randomwalk density independent m, pl pl, pρ pρ l Vector Float64 undef, 0 d 0 cumulative sum of widths while d 100 less than 100 km l1 rand pl push l, l1 d l1 end change last layer to obey 100 km constraint l end 100 sum l 1 end 1 pick density values ρ rand pρ, length l model vector is vcat of l and d return cat l, ρ, dims 1 end begin sample true density mex2 true randomwalk density independent 0 end dobs ex2 ggravity mex2 true, xrange ex2 msamples ex2 prior randomwalk density independent 0 for i in 1 100 function randomwalk density dependent m, pl pl, pρ pρ mout copy m l, ρ splitobs mout, at 0.5 nlayers length l if rand Bernoulli 0.5 change density of randomly chosen layer k randobs 1 nlayers ρ k rand pρ else for wait in 1 5 ib randobs 2 nlayers L l ib l ib 1 l ib rand truncated pl, 0, L l ib 1 L l ib ρ ib rand pρ ρ ib 1 rand pρ end end return cat l, ρ, dims 1 end plot pl, w 2, label nothing, title \"Prior Layer Thickness Distribution\", c black, size 500, 250 md\" Likelihood\" md\"\"\" References ^mosegaard1995 Monte Carlo sampling of solutions to inverse problems, Mosegaard and Tarantola, JGR, 1995. \"\"\" md\" Appendix\" md\" UI\" function sampler input ex2 return PlutoUI.combine do Child p md\"\"\" Initial model m₁ Child \"m₁0\", Slider range ex1, default 5, show value true and m₂ Child \"m₂0\", Slider range ex1, default 5, show value true \"\"\", σ md\"\"\" Standard deviation for prior distribution for drawing independent samples Child \"σglobal\", Slider range 0.05, stop 10, length 100 , default 10, show value true Standard deviation for local proposal Child \"σlocal\", Slider range 0.001, stop 10, length 10 , default 1, show value true \"\"\", md\"\"\" Design the random walk p σ \"\"\" end end function sampler input ex1 return PlutoUI.combine do Child p md\"\"\" Initial model m₁ Child \"m₁0\", Slider range ex1, default 5, show value true and m₂ Child \"m₂0\", Slider range ex1, default 5, show value true \"\"\", σ md\"\"\" Standard deviation for prior distribution for drawing independent samples Child \"σglobal\", Slider range 0.05, stop 10, length 100 , default 10, show value true Standard deviation for local proposal Child \"σlocal\", Slider range 0.001, stop 10, length 10 , default 1, show value true \"\"\", md\"\"\" Design the random walk p σ \"\"\" end end bind ex1 confirm sampler input ex1 function randomwalk ex1 independent m sigma ex1 σglobal return sigma . randn 2 . 0.5 end function randomwalk ex1 local m sigma ex1 σlocal return m . sigma . randn 2 end md\"\"\" Generate bind Nex1 Slider 1 256, default 20, show value true samples which are bind walk Select randomwalk ex1 independent \"Independent\", randomwalk ex1 local \"Markov Chain\" \"\"\" msamples ex1, acceptance ex1 generate samples ex1 m₁0 , ex1 m₂0 , walk, metro, N Nex1 begin p1 heatmap range ex1, range ex1, Lex1 grid, c grays, lim 10, 10 , xlabel \"m₁\", aspect ratio 1, ylabel \"m₂\", title \"Accepted Nex1 length acceptance ex1 with ratio round count acceptance ex1 length acceptance ex1 , digits 3 \" scatter p1, msamples ex1 1 1 1 , msamples ex1 1 2 2 , c yellow, m x, label \"Initial Sample\" gif for isamp in 2 length msamples ex1 println m, acc plot p1, msamples ex1 isamp 1 2 , msamples ex1 isamp 2 , msamples ex1 isamp 1 1 , msamples ex1 isamp 1 , c blue, label nothing end end md\" Plots\" begin userplot pdensity model recipe function f h pdensity model smooth false grid true size 200, 300 margin 1cm color black seriestype steppre colorbar nothing yflip true xlim 100, 6000 ylim 0, 100 w 2 xlabel \"Density kg m3 \" ylabel \"Depth km \" xticks 1000, 5000 titlefontsize 10 guidefontsize 7 tickfontsize 7 label nothing series begin l, ρ splitobs h.args 1 , at 0.5 l1 vcat 0.0 , cumsum l ρ1 vcat ρ, ρ end end if h.args 2 itp interpolate l1, , ρ1, Gridded Linear zrange range 0.1, stop 99.9, length 256 ρ2, l2 vec imfilter cat itp. zrange , dims 2 , Kernel.gaussian 3 , zrange else ρ2, l2 ρ1, l1 end ρ2, l2 end end end plot pdensity model msamples ex2 prior 1 , false, title \"Initial Sample\" , pdensity model randomwalk density dependent msamples ex2 prior 1 , false, title \"Perturbed Sample\" , size 500, 300 function plot true density model plot pdensity model mex2 true, false, title \"True Earth Model\" , pdensity model mex2 true, true, title \"Smoothed True Model\" , size 450, 300 , margin 5mm end TwoColumnWideRight md\"\"\" Gravity Inversion PlutoUI.LocalResource \"gravity inversion example.png\", width 300 Standard deviation of normally distributed gravity measurements bind σex2 Slider range 0.1e 8, stop 3e 8, length 10 , default 0.1e 6, show value true \"\"\", md\" plot true density model \" pd ex2 MvNormal dobs ex2, σex2 function Lex2 m, pd pd ex2, xrange xrange ex2 d ggravity m, xrange return pdf pd ex2, d end msamples ex2, acceptance ex2 generate samples randomwalk density independent 0 , randomwalk density dependent, Lex2, N 100 count acceptance ex2 length acceptance ex2 function plot density model m p1 plot playered model m, false p2 plot playered model m, true plot p1, p2, size 400, 300 , margin 1cm end function pdensity models mvec, smooth plot pdensity model m, smooth, xlabel \"\", ylabel \"\", margin 1mm, left margin 2.0 Plots.mm, right margin 2.0 Plots.mm, showaxis false, axis nothing for m in mvec ..., layout 1, length mvec , size 650, 300 , axis nothing end begin sample prior density pdensity models randomwalk density independent 0 for i in 1 6 , smooth prior flag end begin sample posterior density pdensity models randobs msamples ex2 end 20 end , 6 , smooth posterior flag end pdata ex2 plot xrange ex2, dobs ex2, w 2, size 500, 250 , xlim extrema xrange ex2 , label \"Observed Data\", xlabel \"sensor horizontal position\", ylabel \"\", titlefontsize 10, guidefontsize 7, tickfontsize 7, function plot prior data ex2 pdata ex2 prior deepcopy pdata ex2 for i in 1 20 plot pdata ex2 prior, xrange ex2, ggravity randomwalk density independent 0 , xrange ex2 , w 2, c black, alpha 0.3, label nothing, title \"Prior\" end pdata ex2 prior end function plot post data ex2 pdata ex2 post deepcopy pdata ex2 for m in msamples ex2 end 20 end plot pdata ex2 post, xrange ex2, ggravity m, xrange ex2 , w 2, c black, alpha 0.3, label nothing, title \"Posterior\" end pdata ex2 post end md\"\"\" Data Movie plot plot prior data ex2 , plot post data ex2 , size 650, 250 , link y \"\"\" "},{"url":"mod1_inverse_theory/probabilistic-inverse-problems backup 1/","title":"Probabilistic Inverse Problems","tags":[],"text":" A Pluto.jl notebook v0.19.38 frontmatter chapter 1 section 4 order 4 layout \"layout.jlhtml\" title \"Probabilistic Inverse Problems\" description \"Posterior Information Conjunction Prior Information, Theoretical Information .\" using Markdown using InteractiveUtils This Pluto notebook uses bind for interactivity. When running this notebook outside of Pluto, the following 'mock version' of bind gives bound variables a default value instead of an error . macro bind def, element quote local iv try Base.loaded modules Base.PkgId Base.UUID \"6e696c72 6542 2067 7265 42206c756150\" , \"AbstractPlutoDingetjes\" .Bonds.initial value catch b missing end local el esc element global esc def Core.applicable Base.get, el ? Base.get el iv el el end end using PlutoUI, Plots, Distributions, Measures, PlutoTeachingTools, StatsPlots, Symbolics, LaTeXStrings, TikzPictures ChooseDisplayMode TableOfContents md\"\"\" Probabilistic Inverse Problems The fundamental idea of probabilistic inverse theory is to express all knowledge concerning model parameters, data, and the physical theory in terms of probabilities. Frequentist interpretation of probability is simple it considers a large number of repeatable experiments. When we don't consider repeatable experiments, we adopt the Bayesian interpretation of probabilities, where they represent state of information. \"\"\" md\"\"\" Repeating Experiments The data measured at the receivers are no longer certain. They change from one experiment to another. For example, we can measure the traveltime at a specific receiver 10 times after repeating the experiment. \"\"\" md\"\"\" As we think of data as a set of random variables, we can plot the normalized histogram to roughly understand its probability density function. \"\"\" md\" Joint Probability Usually, our data are composed of multiple random variables. Independent if the conditional distribution is in. \" md\"Are the elements of the data vector independent? Most likely not.\" A randn 2, 2 mixing matrix, lets call this op md\" Coordinate Transformation\" plot histogram rand Uniform 0.5, 4 , 10000 , normalize true, label nothing, xlabel \"bulk modulus\", c gray, xlim 0, 5 , histogram inv. rand Uniform 0.5, 4 , 10000 , normalize true, label nothing, xlabel \"compressibility\", c gray , size 700, 300 , margin 1cm mrange range 0, 5, length 100 md\"\"\" Multi dimensional Gaussian Distribution ```math \\frac 1 \\sqrt 2\\pi \\mathrm det \\,C m \\,\\exp\\left \\frac 1 2 \\, m m 0 ^\\top\\,C m^ 1 \\, m m 0 \\right ``` \"\"\" bind cov12 Slider range 0.7, stop 0.7, length 100 , show value true Cₘ 1 cov12 cov12 1 pm2D MvNormal 3, 2 , Cₘ Z pdf pm2D, x, y for y in mrange, x in mrange pheat2d mrange, mrange, Z, aspect ratio 1, title \"2 D Gaussian Density Function\" md\"\"\" Marginal densities Given joint information about m 1 and m 2 , if we are only interested in one of the parameters, say m 1 , then we can marginalize over m 2 . ```math \\rho m 1 \\int m 2 \\rho m 1, m 2 \\,\\mathrm d m 2 ``` is the marginal probability density that contains all the information on m 1 that is independent of the information on m 2 . \"\"\" begin x, y rand Normal , 1000 , rand Uniform 10, 15 , 1000 layout layout a b 0.8w,0.8h c default plot layout layout, link both, size 500, 500 , margin 0.3cm scatter x, y, subplot 2, framestyle box, fillcolor lightgrey, markercolor gray, grid false, legend false, xlabel \"m₁\", ylabel \"m₂\" histogram x y , subplot 1 3 , orientation v h , framestyle none, label nothing, c gray end md\"\"\" Mean of measurements Consider the mean of measurements that were collected by repeating the experiment. What would be the distribution of the mean? You may slide to increase the number of independent experiments. \"\"\" bind d distribution Select Normal 1, 1 , Uniform 2, 2 bind nm Slider range 1, stop 25, step 1 , show value true dobs mean mean rand d distribution, 1000 for i in 1 nm begin histogram dobs mean, normalize true, size 500, 250 , label nothing, xlabel \"Measurement\", c gray, xlim 5, 5 vline 1.0 , w 3, c blue, label \"True Measurement\", margin 1cm, legend topleft end md\"\"\" Theoretical Information Θ d, m is the joint probability desnity describing the correlations that correspond to our physical theory , together with inherent uncertainites of the theory in this case, knowledge on the the outgoing wavenumber vector is uncertain, which is attributed to the raytracing \"\"\" md\"\"\" ```math \\Theta d, m \\theta d\\,|\\,m \\,μ m m ``` \"\"\" md\"\"\" ```math \\theta d\\,|\\,m \\text const. \\,\\exp\\left \\frac 1 2 \\, d g m ^\\top\\,C T^ 1 \\, d g m \\right ``` \"\"\" md\" Measurements\" md\"\"\" \\rho D d \"\"\" md\"\"\" Prior Information ```math \\rho M m ``` \"\"\" md\" Joint Prior Information ```math \\rho d, m \\rho D d \\,\\rho M m ```\" md\"\"\" Combining states of information Different experts or different datasets often provide different pieces of information that may be encoded by the probability densities ρ1 m and ρ2 m , respectively. ```math \\rho 1\\land\\rho 2 m k\\,\\frac \\rho 1 m \\rho 2 m \\rho h m ``` The homogeneous uninformative probability density in equation 3.47 ensures that the conjunction of information ρ1 with the no information ρh does not yield any new information, that is ```math \\rho 1 \\land \\rho h \\rho 1 ``` \"\"\" pm2D 1 MvNormal 1, 1 , 1 0 0 1 pm2D 2 MvNormal 3, 3 , 1 0.5 0.5 1 Z1 pdf pm2D 1, x, y for y in mrange, x in mrange Z2 pdf pm2D 2, x, y for y in mrange, x in mrange md\" Shannon's Measure\" md\"\"\" Appendix \"\"\" make a list of interesting distributions dist choices1 Select Normal 1, 0.1 \"Normal distribution\", Normal 1.1, 0.1 \"Normal with bias\", Uniform 0.9, 1.1 \"Uniform distribution ignorance \", Dirac 1.0 \"δ distribution perfect knowledge \" md\"\"\" The distribution of each of the random variables in the data is usually unknown, and may not be Normal as per the default choice below. For example, you may choose another one here bind pdata1 dist choices1 \"\"\" scatter rand pdata1, 10 , ylim 0.5, 1.5 , xlabel \" Experiment\", ylabel \"Travel time s \", label nothing, size 500, 250 , c gray d1obs rand pdata1, 10000 sample some data from a given distribution begin pd1 histogram d1obs, normalize true, size 500, 250 , label nothing, xlabel \"Measurement\", c gray plot range 0.6, 1.4, step 0.01 , pdf. pdata1, range 0.6, 1.4, step 0.01 , w 2, label \"pdf\" vline 1.0 , w 3, c blue, label \"True Measurement\", margin 1cm end bind pdata2 dist choices1 d2obs rand pdata2, 10000 dmix mapslices x A x, hcat d1obs, d2obs , dims 2 begin X range 8, 8, length 100 Y range 8, 8, length 100 end md\" Locate Source Experiment\" sxgrid range 2.0, stop 2.0, length 250 Tgrid range 0.95, 1.05, length 250 cex 5 velocity in km sec syms T 𝐱 𝐳 T expression sqrt abs2 𝐱 abs2 𝐳 inv cex get traveltime build function T expression, 𝐱, 𝐳 expression Val false sz expression sqrt abs2 cex T abs2 𝐱 return sz for a given T and sx get sz build function sz expression, T, 𝐱 expression Val false returns the derivative of sz w.r.t. T get dsz dT build function Symbolics.derivative sz expression, T , 𝐱, T expression Val false sz true 5.0 md\" UI\" function source loc ex input nsx length sxgrid nT length Tgrid return PlutoUI.combine do Child p md\"\"\" True x location of source Child \"x\", Slider range 1.5, stop 1.5, length 100 , default 1.2, show value true and known mean of z location Child \"μz\", Slider range 1, stop 5, length 100 , default 5, show value true \"\"\", σ md\"\"\" mean in x Child \"μx\", Slider sxgrid, default sxgrid div nsx,2 , show value true and standard deviation in x Child \"σx\", Slider range 0.05, stop 10, length 100 , default 10, show value true and standard deviation in z Child \"σz\", Slider range 0.001, stop .5, length 10 , default 0.05, show value true \"\"\", priorT md\"\"\" variance in observed traveltime Child \"σT\", Slider range 0.01, stop 0.5, length 100 , default 0.01, show value true \"\"\", md\"\"\" Locate The Source Consider a hypothetical experiment, where the x coordinate of the source has to be estimated given the P or S arrival travel time measured at a single receiver. Here, luckily, the z coordinate of the source has a known mean, and it has a given standard deviation True source location is p Prior information is assumed to be of Gaussian type with σ The uncertainty in the observed data has a standard deviation priorT \"\"\" end end bind sex source loc ex input uncertainity in sz, with a fixed mean sz true pz Normal sex.μz, sex.σz theoretical information Θex broadcast Iterators.product sxgrid, Tgrid do sx, T pdf pz, get sz T, sx get dsz dT sx, T end prior on sx ρsx Normal sex.μx, sex.σx generate observed traveltime Tobs get traveltime sex.x, sz true Gaussian uncertainty for observed traveltime ρT Normal Tobs, sex.σT prior information ρex broadcast Iterators.product sxgrid, Tgrid do sx, T pdf ρsx, sx pdf ρT, T end plot sxgrid, sum ρex . Θex, dims 2 , w 2, c black, title \"Marginalized Posterior Model Information\", xlabel \"Source x location\", size 500, 250 , label nothing posterior information σex ρex . Θex md\" Plots\" begin userplot pheat2d recipe function f h pheat2d grid true size 500, 400 margin 2cm color amp seriestype contourf colorbar nothing series begin h.args end end end scatter2D d1, d2, lim auto, title \"\" scatter collect zip d1, d2 , xlabel \"Measurement 1\", ylabel \"Measurement 2\", label nothing, size 500, 500 , c gray, title title, lim lim, margin 1cm, framestyle box scatter2D d1obs, d2obs, 0.5, 1.5 , \"Independent Measurements\" scatter2D dmix , 1 , dmix , 2 , auto, \"Dependent Measurements\" Θ plot pheat2d Tgrid, sxgrid, Θex, xlabel \"Travel time\", title \"Theoretical Information Θ d, m \" σ plot pheat2d Tgrid, sxgrid, σex, xlabel \"Travel time\", title \"Posterior Information σ d, m \" ρ plot pheat2d Tgrid, sxgrid, ρex, xlabel \"Travel time\", ylabel \"Source x location\", title \"Prior Information ρ d, m \" plot ρ plot, Θ plot, σ plot, layout 1, 3 , size 1000, 350 , margin 4mm md\" Tikz\" tikz default options raw\"\"\" background rectangle .style fill white , show background rectangle, \"\"\" tikz preamble raw\"\"\" \\usepackage tikz \\usepackage tikz \\usetikzlibrary fit, matrix, shapes.geometric \\tikzset % use tikzset, not tikzstyle cell .style rectangle, rounded corners 5pt, draw, \\tikzset % use tikzset, not tikzstyle cellv .style rectangle, rounded corners 5pt, draw, rotate 90, \\usepackage xifthen \\usetikzlibrary hobby \\usepackage pgfplots \\usepackage fontawesome \\usepackage bm,amsfonts,amsmath \\usetikzlibrary backgrounds,pgfplots.groupplots,snakes \\usepgfplotslibrary patchplots \\pgfplotsset try min ticks 2 \\usepackage pgfplotstable \\usetikzlibrary plotmarks,positioning,spy \\usetikzlibrary shapes.geometric, arrows, fadings \\usepgfplotslibrary groupplots, polar \\usepackage space grffile \\usetikzlibrary % decorations.pathreplacing,% decorations.pathmorphing% \\usetikzlibrary positioning,fit,backgrounds \\usetikzlibrary shapes,arrows \\usetikzlibrary decorations.markings \\usetikzlibrary patterns \\usetikzlibrary plotmarks \\usetikzlibrary fit \\usetikzlibrary intersections \\usepgfplotslibrary fillbetween \\pgfplotsset axis line style black 10 , every axis label .append style black 10 , every axis title .append style black 10 , every tick label .append style black 10 % need for pgfplots \\newcommand \\axisz 0cm \\newcommand \\axisx 0cm \\usetikzlibrary positioning \\usetikzlibrary shapes.geometric \\usetikzlibrary backgrounds \"\"\" md\"\"\" References Mosegaard, Klaus, and Albert Tarantola. \"Probabilistic approach to inverse problems.\" International Geophysics Series 81.A 2002 237 268. Fichtner, Andreas. \"Lecture Notes on Inverse Theory.\" 2021 . \"\"\" "},{"url":"mod1_inverse_theory/probabilistic-inverse-problems/","title":"Probabilistic Inverse Problems","tags":["module1"],"text":" A Pluto.jl notebook v0.19.38 frontmatter layout \"layout.jlhtml\" title \"Probabilistic Inverse Problems\" tags \"module1\" description \"Posterior Information Conjunction Prior Information, Theoretical Information .\" using Markdown using InteractiveUtils This Pluto notebook uses bind for interactivity. When running this notebook outside of Pluto, the following 'mock version' of bind gives bound variables a default value instead of an error . macro bind def, element quote local iv try Base.loaded modules Base.PkgId Base.UUID \"6e696c72 6542 2067 7265 42206c756150\" , \"AbstractPlutoDingetjes\" .Bonds.initial value catch b missing end local el esc element global esc def Core.applicable Base.get, el ? Base.get el iv el el end end using PlutoUI, Plots, Distributions, Measures, PlutoTeachingTools, StatsPlots, Symbolics, LaTeXStrings, TikzPictures ChooseDisplayMode TableOfContents md\"\"\" Probabilistic Inverse Problems The fundamental idea of probabilistic inverse theory is to express all knowledge concerning model parameters, data, and the physical theory in terms of probabilities. Frequentist interpretation of probability is simple it considers a large number of repeatable experiments. When we don't consider repeatable experiments, we adopt the Bayesian interpretation of probabilities, where they represent state of information. \"\"\" md\"\"\" Repeating Experiments The data measured at the receivers are no longer certain. They change from one experiment to another. For example, we can measure the traveltime at a specific receiver 10 times after repeating the experiment. \"\"\" md\"\"\" As we think of data as a set of random variables, we can plot the normalized histogram to roughly understand its probability density function. \"\"\" md\" Joint Probability Usually, our data are composed of multiple random variables. Independent if the conditional distribution is in. \" md\"Are the elements of the data vector independent? Most likely not.\" A randn 2, 2 mixing matrix, lets call this op md\" Coordinate Transformation\" plot histogram rand Uniform 0.5, 4 , 10000 , normalize true, label nothing, xlabel \"bulk modulus\", c gray, xlim 0, 5 , histogram inv. rand Uniform 0.5, 4 , 10000 , normalize true, label nothing, xlabel \"compressibility\", c gray , size 700, 300 , margin 1cm mrange range 0, 5, length 100 md\"\"\" Multi dimensional Gaussian Distribution ```math \\frac 1 \\sqrt 2\\pi \\mathrm det \\,C m \\,\\exp\\left \\frac 1 2 \\, m m 0 ^\\top\\,C m^ 1 \\, m m 0 \\right ``` \"\"\" bind cov12 Slider range 0.7, stop 0.7, length 100 , show value true Cₘ 1 cov12 cov12 1 pm2D MvNormal 3, 2 , Cₘ Z pdf pm2D, x, y for y in mrange, x in mrange md\"\"\" Marginal densities Given joint information about m 1 and m 2 , if we are only interested in one of the parameters, say m 1 , then we can marginalize over m 2 . ```math \\rho m 1 \\int m 2 \\rho m 1, m 2 \\,\\mathrm d m 2 ``` is the marginal probability density that contains all the information on m 1 that is independent of the information on m 2 . \"\"\" begin x, y rand Normal , 1000 , rand Uniform 10, 15 , 1000 layout layout a b 0.8w,0.8h c default plot layout layout, link both, size 500, 500 , margin 0.3cm scatter x, y, subplot 2, framestyle box, fillcolor lightgrey, markercolor gray, grid false, legend false, xlabel \"m₁\", ylabel \"m₂\" histogram x y , subplot 1 3 , orientation v h , framestyle none, label nothing, c gray end md\"\"\" Mean of measurements Consider the mean of measurements that were collected by repeating the experiment. What would be the distribution of the mean? You may slide to increase the number of independent experiments. \"\"\" bind d distribution Select Normal 1, 1 , Uniform 2, 2 bind nm Slider range 1, stop 25, step 1 , show value true dobs mean mean rand d distribution, 1000 for i in 1 nm begin histogram dobs mean, normalize true, size 500, 250 , label nothing, xlabel \"Measurement\", c gray, xlim 5, 5 vline 1.0 , w 3, c blue, label \"True Measurement\", margin 1cm, legend topleft end md\"\"\" Theoretical Information Θ d, m is the joint probability density describing the correlations that correspond to our physical theory, together with inherent uncertainites of the theory in this case, knowledge on the the outgoing wavenumber vector is uncertain, which is attributed to the raytracing \"\"\" md\"\"\" ```math \\Theta d, m \\theta d\\,|\\,m \\,μ m m ``` \"\"\" md\"\"\" ```math \\theta d\\,|\\,m \\text const. \\,\\exp\\left \\frac 1 2 \\, d g m ^\\top\\,C T^ 1 \\, d g m \\right ``` \"\"\" md\" Measurements\" md\"\"\" \\rho D d \"\"\" md\"\"\" Prior Information ```math \\rho M m ``` \"\"\" md\" Joint Prior Information ```math \\rho d, m \\rho D d \\,\\rho M m ```\" md\"\"\" Combining states of information Different experts or different datasets often provide different pieces of information that may be encoded by the probability densities ρ1 m and ρ2 m , respectively. ```math \\rho 1\\land\\rho 2 m k\\,\\frac \\rho 1 m \\rho 2 m \\rho h m ``` The homogeneous uninformative probability density in equation 3.47 ensures that the conjunction of information ρ1 with the no information ρh does not yield any new information, that is ```math \\rho 1 \\land \\rho h \\rho 1 ``` \"\"\" pm2D 1 MvNormal 1, 1 , 1 0 0 1 pm2D 2 MvNormal 3, 3 , 1 0.5 0.5 1 Z1 pdf pm2D 1, x, y for y in mrange, x in mrange Z2 pdf pm2D 2, x, y for y in mrange, x in mrange md\" Shannon's Measure\" md\"\"\" Appendix \"\"\" make a list of interesting distributions dist choices1 Select Normal 1, 0.1 \"Normal distribution\", Normal 1.1, 0.1 \"Normal with bias\", Uniform 0.9, 1.1 \"Uniform distribution ignorance \", Dirac 1.0 \"δ distribution perfect knowledge \" md\"\"\" The distribution of each of the random variables in the data is usually unknown, and may not be Normal as per the default choice below. For example, you may choose another one here bind pdata1 dist choices1 \"\"\" scatter rand pdata1, 10 , ylim 0.5, 1.5 , xlabel \" Experiment\", ylabel \"Travel time s \", label nothing, size 500, 250 , c gray d1obs rand pdata1, 10000 sample some data from a given distribution begin pd1 histogram d1obs, normalize true, size 500, 250 , label nothing, xlabel \"Measurement\", c gray plot range 0.6, 1.4, step 0.01 , pdf. pdata1, range 0.6, 1.4, step 0.01 , w 2, label \"pdf\" vline 1.0 , w 3, c blue, label \"True Measurement\", margin 1cm end bind pdata2 dist choices1 d2obs rand pdata2, 10000 dmix mapslices x A x, hcat d1obs, d2obs , dims 2 begin X range 8, 8, length 100 Y range 8, 8, length 100 end md\" Locate Source Experiment\" sxgrid range 2.0, stop 2.0, length 250 Tgrid range 0.95, 1.05, length 250 cex 5 velocity in km sec syms T 𝐱 𝐳 T expression sqrt abs2 𝐱 abs2 𝐳 inv cex get traveltime build function T expression, 𝐱, 𝐳 expression Val false sz expression sqrt abs2 cex T abs2 𝐱 return sz for a given T and sx get sz build function sz expression, T, 𝐱 expression Val false returns the derivative of sz w.r.t. T get dsz dT build function Symbolics.derivative sz expression, T , 𝐱, T expression Val false sz true 5.0 md\" UI\" function source loc ex input nsx length sxgrid nT length Tgrid return PlutoUI.combine do Child p md\"\"\" True x location of source Child \"x\", Slider range 1.5, stop 1.5, length 100 , default 1.2, show value true and known mean of z location Child \"μz\", Slider range 1, stop 5, length 100 , default 5, show value true \"\"\", σ md\"\"\" mean in x Child \"μx\", Slider sxgrid, default sxgrid div nsx,2 , show value true and standard deviation in x Child \"σx\", Slider range 0.05, stop 10, length 100 , default 10, show value true and standard deviation in z Child \"σz\", Slider range 0.001, stop .5, length 10 , default 0.05, show value true \"\"\", priorT md\"\"\" variance in observed traveltime Child \"σT\", Slider range 0.01, stop 0.5, length 100 , default 0.01, show value true \"\"\", md\"\"\" Locate The Source Consider a hypothetical experiment, where the x coordinate of the source has to be estimated given the P or S arrival travel time measured at a single receiver. Here, luckily, the z coordinate of the source has a known mean, and it has a given standard deviation True source location is p Prior information is assumed to be of Gaussian type with σ The uncertainty in the observed data has a standard deviation priorT \"\"\" end end bind sex source loc ex input uncertainity in sz, with a fixed mean sz true pz Normal sex.μz, sex.σz theoretical information Θex broadcast Iterators.product sxgrid, Tgrid do sx, T pdf pz, get sz T, sx get dsz dT sx, T end prior on sx ρsx Normal sex.μx, sex.σx generate observed traveltime Tobs get traveltime sex.x, sz true Gaussian uncertainty for observed traveltime ρT Normal Tobs, sex.σT prior information ρex broadcast Iterators.product sxgrid, Tgrid do sx, T pdf ρsx, sx pdf ρT, T end plot sxgrid, sum ρex . Θex, dims 2 , w 2, c black, title \"Marginalized Posterior Model Information\", xlabel \"Source x location\", size 500, 250 , label nothing posterior information σex ρex . Θex md\" Plots\" begin userplot pheat2d recipe function f h pheat2d grid true size 500, 400 margin 2cm color amp seriestype contourf colorbar nothing series begin h.args end end end pheat2d mrange, mrange, Z, aspect ratio 1, title \"2 D Gaussian Density Function\" scatter2D d1, d2, lim auto, title \"\" scatter collect zip d1, d2 , xlabel \"Measurement 1\", ylabel \"Measurement 2\", label nothing, size 500, 500 , c gray, title title, lim lim, margin 1cm, framestyle box scatter2D d1obs, d2obs, 0.5, 1.5 , \"Independent Measurements\" scatter2D dmix , 1 , dmix , 2 , auto, \"Dependent Measurements\" Θ plot pheat2d Tgrid, sxgrid, Θex, xlabel \"Travel time\", title \"Theoretical Information Θ d, m \" σ plot pheat2d Tgrid, sxgrid, σex, xlabel \"Travel time\", title \"Posterior Information σ d, m \" ρ plot pheat2d Tgrid, sxgrid, ρex, xlabel \"Travel time\", ylabel \"Source x location\", title \"Prior Information ρ d, m \" plot ρ plot, Θ plot, σ plot, layout 1, 3 , size 1000, 350 , margin 4mm md\" Tikz\" tikz default options raw\"\"\" background rectangle .style fill white , show background rectangle, \"\"\" tikz preamble raw\"\"\" \\usepackage tikz \\usepackage tikz \\usetikzlibrary fit, matrix, shapes.geometric \\tikzset % use tikzset, not tikzstyle cell .style rectangle, rounded corners 5pt, draw, \\tikzset % use tikzset, not tikzstyle cellv .style rectangle, rounded corners 5pt, draw, rotate 90, \\usepackage xifthen \\usetikzlibrary hobby \\usepackage pgfplots \\usepackage fontawesome \\usepackage bm,amsfonts,amsmath \\usetikzlibrary backgrounds,pgfplots.groupplots,snakes \\usepgfplotslibrary patchplots \\pgfplotsset try min ticks 2 \\usepackage pgfplotstable \\usetikzlibrary plotmarks,positioning,spy \\usetikzlibrary shapes.geometric, arrows, fadings \\usepgfplotslibrary groupplots, polar \\usepackage space grffile \\usetikzlibrary % decorations.pathreplacing,% decorations.pathmorphing% \\usetikzlibrary positioning,fit,backgrounds \\usetikzlibrary shapes,arrows \\usetikzlibrary decorations.markings \\usetikzlibrary patterns \\usetikzlibrary plotmarks \\usetikzlibrary fit \\usetikzlibrary intersections \\usepgfplotslibrary fillbetween \\pgfplotsset axis line style black 10 , every axis label .append style black 10 , every axis title .append style black 10 , every tick label .append style black 10 % need for pgfplots \\newcommand \\axisz 0cm \\newcommand \\axisx 0cm \\usetikzlibrary positioning \\usetikzlibrary shapes.geometric \\usetikzlibrary backgrounds \"\"\" md\"\"\" References Mosegaard, Klaus, and Albert Tarantola. \"Probabilistic approach to inverse problems.\" International Geophysics Series 81.A 2002 237 268. Fichtner, Andreas. \"Lecture Notes on Inverse Theory.\" 2021 . \"\"\" "},{"url":"mod1_inverse_theory/pseudoinverse/","title":"Pseudoinverse","tags":["module1"],"text":" A Pluto.jl notebook v0.19.36 frontmatter chapter \"1\" title \"Pseudoinverse\" tags \"module1\" layout \"layout.jlhtml\" using Markdown using InteractiveUtils md\" Pseudoinverse\" md\"\"\" G has independent columns then G^ G^TG ^ 1 G^T is the pseudoinverse \"\"\" md\"\"\" G has independent rows then G^ G^T GG^T ^ 1 is the pseudo inverse \"\"\" md\"\"\" Diagonal Matrix For a diagonal matrix \\Sigma , it is inverted where possible, otherwise \\Sigma^ has zeros \"\"\" md\"\"\" SVD SVD of a matrix G leads to its pseudoinverse G^ The pseudoinverse of G U\\Sigma V^T is G^ V\\Sigma^ U^T \"\"\" "},{"url":"mod1_inverse_theory/svd/","title":"Singular Value Decomposition","tags":["module1"],"text":" A Pluto.jl notebook v0.19.36 frontmatter chapter \"1\" title \"Singular Value Decomposition\" tags \"module1\" layout \"layout.jlhtml\" using Markdown using InteractiveUtils This Pluto notebook uses bind for interactivity. When running this notebook outside of Pluto, the following 'mock version' of bind gives bound variables a default value instead of an error . macro bind def, element quote local iv try Base.loaded modules Base.PkgId Base.UUID \"6e696c72 6542 2067 7265 42206c756150\" , \"AbstractPlutoDingetjes\" .Bonds.initial value catch b missing end local el esc element global esc def Core.applicable Base.get, el ? Base.get el iv el el end end using PlutoPlotly, LinearAlgebra, PlutoUI, PlutoTeachingTools TableOfContents md\"\"\" Singular Value Decomposition SVD ```math G U\\Sigma V^T ``` SVD produces two sets of singular vectors columns of matrices `U` and `V` . For a matrix `G` of size m,n , these singular vectors form orthogonal axes in \\mathbf R ^m and \\mathbf R ^n , respectively. In this demo, we consider a square matrix `G` here, the matrix maps each of the columns in `V` to the corresponding columns in `U`. Notice that the orthogonal axes of `U` and `V` are similar except for the sign in the case when `G` is symmetric. If `G` is singular, we can rotate m to be perpendicular to the columns of G to see zero vector d yes, the null space is orthogonal to the column space of a matrix. \"\"\" ThreeColumn md\"\"\" bind Atype MultiCheckBox \"Symmetric\" \"G is Symmetric\", \"Singular\" \"G is Singular\" \"\"\",md\"\"\" bind sampleG CounterButton \"Resample G\" \"\"\", md\"\"\" and Rotate m bind mphi Slider range 0,2pi,length 1000 \"\"\" md\"Scale the columns of U and V with singular values? bind scaleUV CheckBox \" md\" Orthogonal Matrices Rotation in 2D Invertible\" md\"\"\" Symmetric Matrices GᵀG and GGᵀ `V` contains orthonormal eigenvectors of GᵀG, and `U` contains orthonormal eigenvectors of GGᵀ, where both of them share eigenvalues. \"\"\" begin sampleG G randn 2,2 if \"Symmetric\" ∈ Atype G 0.5 G G' end if \"Singular\" ∈ Atype G ,2 . randn . G ,1 end end F svd G begin m cos mphi , sin mphi end n F.Vt m o Diagonal F.S n m1 F.U o md\" Appendix\" md\" Plots\" function quiverplot p1, p2 zeros size p1 colors fill \"black\", size p1,2 , xylim 3.0, title \"\", names string. collect 1 size p1,2 vector scale 1 scale factor in 0, 1 for the vector directions to avoid quiver overlapping arrow scale 0.25 angle π 9 scaleratio 1.0 aspect ratio for the 2d plot d 1.0 a scale factor in 0.9, 1 for the already scaled direction p1 cat p1,dims 2 p2 cat p2,dims 2 assert size p1,2 size p2,2 plots mapreduce vcat, 1 size p1,2 do i x p2 1 1, i y p2 2 2, i u p1 1 1, i v p1 2 2, i length x length y length u length v && vector scale 0 && arrow scale 0 || error \"the vects x, y, u, v do not have the same length\" u vector scale scaleratio u v vector scale v end x x . u end y y . v function tuple interleave tu Union NTuple 3, Vector , NTuple 4, Vector auxilliary function to interleave elements of a NTuple of vectors, N 3 or 4 zipped data collect zip tu... vv zdata collect elem for elem in zipped data return reduce vcat, vv zdata end vect nans repeat NaN , length x barb x tuple interleave x, x . d u, vect nans barb y tuple interleave y, y . d v, vect nans barb length sqrt. u scaleratio .^2 . v .^2 arrow length arrow scale barb length barb angle atan. v, u scaleratio ang1 barb angle . angle ang2 barb angle . angle seg1 x arrow length . cos. ang1 seg1 y arrow length . sin. ang1 seg2 x arrow length . cos. ang2 seg2 y arrow length . sin. ang2 arrowend1 x end x . seg1 x scaleratio arrowend1 y end y . seg1 y arrowend2 x end x . seg2 x scaleratio arrowend2 y end y . seg2 y arrow x tuple interleave arrowend1 x, end x, arrowend2 x, vect nans arrow y tuple interleave arrowend1 y, end y, arrowend2 y, vect nans barb scatter x barb x, y barb y, mode \"lines\", line color colors i , name names i ,showlegend names i \"\" arrow scatter x arrow x, y arrow y, mode \"lines\", line color colors i , fill \"toself\", fillcolor colors i , hoverinfo \"skip\", showlegend false return barb, arrow end layout Layout title title,width 250, height 260, yaxis attr range xylim, xylim ,xaxis attr range xylim, xylim , legend attr x 0.75, y 1, yanchor \"bottom\", xanchor \"right\", orientation \"h\" , showlegend true return plot Plot plots, layout, config PlotConfig staticPlot true end PlutoUI.ExperimentalLayout.hbox quiverplot G, title \"Columns of G\" , quiverplot m, title \"m\", colors \"blue\" , names \"\" let I scaleUV ? Diagonal F.S Diagonal ones 2 PlutoUI.ExperimentalLayout.hbox quiverplot F.U I, title \"Columns of U\" , quiverplot F.V I, title \"Columns of V\" end PlutoUI.ExperimentalLayout.hbox quiverplot hcat m,o,m1 , colors \"blue\",\"magenta\", \"red\" , names \"m\",\"o\",\"Gm\" , quiverplot hcat n,o , colors \"green\", \"magenta\" , names \"n\",\"o Σn\" , quiverplot hcat m,n , colors \"blue\", \"green\" , names \"m\",\"n Vᵀm\" , quiverplot G', colors \"blue\", \"green\" , title \"Row f G\" quiverplot hcat m,F.Vt m , colors \"blue\", \"green\" , names \"m\",\"Vᵀm\" quiverplot hcat F.Vt m, F.Vt F.V m , colors \"blue\", \"green\" , names \"m\",\"VᵀVm\" md\"\"\" Resources Wolfram Alpha Demo https demonstrations.wolfram.com SingularValueDecomposition \"\"\" "},{"url":"mod1_inverse_theory/svd_assignment_sanket/","title":"Singular Value Decomposition","tags":["module1"],"text":" A Pluto.jl notebook v0.19.38 frontmatter chapter \"1\" title \"Singular Value Decomposition\" tags \"module1\" layout \"layout.jlhtml\" using Markdown using InteractiveUtils This Pluto notebook uses bind for interactivity. When running this notebook outside of Pluto, the following 'mock version' of bind gives bound variables a default value instead of an error . macro bind def, element quote local iv try Base.loaded modules Base.PkgId Base.UUID \"6e696c72 6542 2067 7265 42206c756150\" , \"AbstractPlutoDingetjes\" .Bonds.initial value catch b missing end local el esc element global esc def Core.applicable Base.get, el ? Base.get el iv el el end end using PlutoPlotly, LinearAlgebra, PlutoUI, PlutoTeachingTools,HDF5 ChooseDisplayMode TableOfContents md\"\"\" Reading the data \"\"\" G mat Array h5open \". atm pressure dataset.h5\" \"data\" md\"\"\" Perturbation of atmospheric pressure in x y plane at t bind time Slider 1 25,show value true sec\"\"\" PlutoPlotly.plot PlutoPlotly.heatmap z G mat , ,time ,colorscale \"seismic\",zmin 4,zmax 4 ,Layout width 600,height 600,title \"time time sec\" G mat reshaped reshape G mat, ,25 md\"\"\" Singular Value Decomposition SVD ```math G U\\Sigma V^T ``` \"\"\" U,S,Vt svd G mat reshaped md\"\"\" Singular values\"\"\" S PlutoPlotly.plot PlutoPlotly.scatter y S,mode \"lines markers\" ,Layout title \"Singular Values\",width 600,height 300 md\"\"\" Visualizing the spatial patterns corresponding to the singular value bind sig Slider S,show value true \"\"\" PlutoPlotly.plot PlutoPlotly.heatmap z reshape U ,findfirst x x sig,S ,20,20 ,colorscale \"seismic\" ,Layout width 600,height 600 md\"\"\" The number of significant singular values can be determined either by visualizing their significance or by understanding their contributions towards the data\"\"\" md\"\"\" Significant Spatial patterns \"\"\" let p PlutoPlotly.plot Layout uirevision 1, showlegend false, margin 0.5, height 650, width 1500, title attr font size 6, , legend attr x 0.6, y 0.0, , font attr size 8 , Subplots rows 1, cols 3, shared xaxes true add trace p, PlutoPlotly.heatmap colorscale \"seismic\",z reshape U ,1 ,20,20 ,zmin .1,zmax .1 , row 1, col 1 add trace p, PlutoPlotly.heatmap colorscale \"seismic\",z reshape U ,2 ,20,20 ,zmin .1,zmax .1 , row 1, col 2 add trace p, PlutoPlotly.heatmap colorscale \"seismic\",z reshape U ,3 ,20,20 ,zmin .1,zmax .1 , row 1, col 3 end md\"\"\" Individual Temporal Variations \"\"\" let p PlutoPlotly.plot Layout uirevision 1, showlegend false, margin 0.5, height 700, width 1200, title attr font size 6, , legend attr x 0.6, y 0.0, , font attr size 8 , Subplots x title \"time\",subplot titles \"Singular value S 1 \" \"Singular value S 2 \" \"Singular value S 3 \" ,rows 3, cols 1, shared xaxes true add trace p, PlutoPlotly.scatter y Vt ,1 , row 1, col 1 add trace p, PlutoPlotly.scatter y Vt ,2 , row 2, col 1 add trace p, PlutoPlotly.scatter y Vt ,3 , row 3, col 1 end SVD produces two sets of singular vectors columns of matrices `U` and `V` . For a matrix `G` of size m,n , these singular vectors form orthogonal axes in \\mathbf R ^m and \\mathbf R ^n , respectively. In this demo, we consider a square matrix `G` here, the matrix maps each of the columns in `V` to the corresponding columns in `U`. Notice that the orthogonal axes of `U` and `V` are similar except for the sign in the case when `G` is symmetric. If `G` is singular, we can rotate m to be perpendicular to the columns of G to see zero vector d yes, the null space is orthogonal to the column space of a matrix. md\"\"\" Implications The first 3 significant singular values explain most of the variability present in the data. Removal of lower singular values helps in noise reduction. The most significant implication is low rank approximation of high dimensional data i.e. dimensionality reduction . \"\"\" md\"\"\" Reconstruction of data Optional Let's try to reconstruct the data by considering only first 3 significant singular values\"\"\" G recon reshape U ,1 3 Diagonal S 1 3 Vt ,1 3 ',20,20, PlutoPlotly.plot PlutoPlotly.heatmap z G recon , ,time ,colorscale \"seismic\",zmin 4,zmax 4 ,Layout width 600,height 600,title \"time time sec\" U,S,V SVD G mat ThreeColumn md\"\"\" bind Atype MultiCheckBox \"Symmetric\" \"G is Symmetric\", \"Singular\" \"G is Singular\" \"\"\",md\"\"\" bind sampleG CounterButton \"Resample G\" \"\"\", md\"\"\" and Rotate m bind mphi Slider range 0,2pi,length 1000 \"\"\" md\"Scale the columns of U and V with singular values? bind scaleUV CheckBox \" md\" Orthogonal Matrices Rotation in 2D Invertible\" md\"\"\" Symmetric Matrices GᵀG and GGᵀ `V` contains orthonormal eigenvectors of GᵀG, and `U` contains orthonormal eigenvectors of GGᵀ, where both of them share eigenvalues. \"\"\" begin sampleG G randn 2,2 if \"Symmetric\" ∈ Atype G 0.5 G G' end if \"Singular\" ∈ Atype G ,2 . randn . G ,1 end end F svd G begin m cos mphi , sin mphi end n F.Vt m o Diagonal F.S n m1 F.U o md\" Appendix\" md\" Plots\" function quiverplot p1, p2 zeros size p1 colors fill \"black\", size p1,2 , xylim 3.0, title \"\", names string. collect 1 size p1,2 vector scale 1 scale factor in 0, 1 for the vector directions to avoid quiver overlapping arrow scale 0.25 angle π 9 scaleratio 1.0 aspect ratio for the 2d plot d 1.0 a scale factor in 0.9, 1 for the already scaled direction p1 cat p1,dims 2 p2 cat p2,dims 2 assert size p1,2 size p2,2 plots mapreduce vcat, 1 size p1,2 do i x p2 1 1, i y p2 2 2, i u p1 1 1, i v p1 2 2, i length x length y length u length v && vector scale 0 && arrow scale 0 || error \"the vects x, y, u, v do not have the same length\" u vector scale scaleratio u v vector scale v end x x . u end y y . v function tuple interleave tu Union NTuple 3, Vector , NTuple 4, Vector auxilliary function to interleave elements of a NTuple of vectors, N 3 or 4 zipped data collect zip tu... vv zdata collect elem for elem in zipped data return reduce vcat, vv zdata end vect nans repeat NaN , length x barb x tuple interleave x, x . d u, vect nans barb y tuple interleave y, y . d v, vect nans barb length sqrt. u scaleratio .^2 . v .^2 arrow length arrow scale barb length barb angle atan. v, u scaleratio ang1 barb angle . angle ang2 barb angle . angle seg1 x arrow length . cos. ang1 seg1 y arrow length . sin. ang1 seg2 x arrow length . cos. ang2 seg2 y arrow length . sin. ang2 arrowend1 x end x . seg1 x scaleratio arrowend1 y end y . seg1 y arrowend2 x end x . seg2 x scaleratio arrowend2 y end y . seg2 y arrow x tuple interleave arrowend1 x, end x, arrowend2 x, vect nans arrow y tuple interleave arrowend1 y, end y, arrowend2 y, vect nans barb scatter x barb x, y barb y, mode \"lines\", line color colors i , name names i ,showlegend names i \"\" arrow scatter x arrow x, y arrow y, mode \"lines\", line color colors i , fill \"toself\", fillcolor colors i , hoverinfo \"skip\", showlegend false return barb, arrow end layout Layout title title,width 250, height 260, yaxis attr range xylim, xylim ,xaxis attr range xylim, xylim , legend attr x 0.75, y 1, yanchor \"bottom\", xanchor \"right\", orientation \"h\" , showlegend true return plot Plot plots, layout, config PlotConfig staticPlot true end PlutoUI.ExperimentalLayout.hbox quiverplot G, title \"Columns of G\" , quiverplot m, title \"m\", colors \"blue\" , names \"\" let I scaleUV ? Diagonal F.S Diagonal ones 2 PlutoUI.ExperimentalLayout.hbox quiverplot F.U I, title \"Columns of U\" , quiverplot F.V I, title \"Columns of V\" end PlutoUI.ExperimentalLayout.hbox quiverplot hcat m,o,m1 , colors \"blue\",\"magenta\", \"red\" , names \"m\",\"o\",\"Gm\" , quiverplot hcat n,o , colors \"green\", \"magenta\" , names \"n\",\"o Σn\" , quiverplot hcat m,n , colors \"blue\", \"green\" , names \"m\",\"n Vᵀm\" , quiverplot G', colors \"blue\", \"green\" , title \"Row f G\" quiverplot hcat m,F.Vt m , colors \"blue\", \"green\" , names \"m\",\"Vᵀm\" quiverplot hcat F.Vt m, F.Vt F.V m , colors \"blue\", \"green\" , names \"m\",\"VᵀVm\" hide everything below html\"\"\" style pluto cell.hide everything below ~ pluto cell display none style script const cell currentScript.closest \"pluto cell\" const setclass console.log \"change \" cell.classList.toggle \"hide everything below\", true setclass const observer new MutationObserver setclass observer.observe cell, subtree false, attributeFilter \"class\" , invalidation.then observer.disconnect cell.classList.toggle \"hide everything below\", false script \"\"\" hide everything below md\"\"\" Resources Wolfram Alpha Demo https demonstrations.wolfram.com SingularValueDecomposition \"\"\" "},{"url":"mod2_learning/deep-learning/","title":"deep-learning","tags":[],"text":" A Pluto.jl notebook v0.19.41 using Markdown using InteractiveUtils This Pluto notebook uses bind for interactivity. When running this notebook outside of Pluto, the following 'mock version' of bind gives bound variables a default value instead of an error . macro bind def, element quote local iv try Base.loaded modules Base.PkgId Base.UUID \"6e696c72 6542 2067 7265 42206c756150\" , \"AbstractPlutoDingetjes\" .Bonds.initial value catch b missing end local el esc element global esc def Core.applicable Base.get, el ? Base.get el iv el el end end using PlutoPlotly, LinearAlgebra, Flux, PlutoUI, Statistics, Distributions, PlutoHooks, PlutoLinks TableOfContents md\"\"\" Introduction to Deep Learning This notebook aims to provide basic intuition attached to neural networks. Specifically, we will consider shallow, fully connected neural networks with relu activation. We will understand how these networks represent a family of piecewise linear regions. This leads to the universal approximation theorem. Then, we train the models for a simple 1 D regression example to demonstrate the concepts of noise, bias, and variance and their tradeoffs. We used `Flux.jl`. \"\"\" begin xmin 2 xmax 2 x collect range xmin, xmax, length 1000 xm Float32. reshape x, 1, to be used as input for dense layers end md\" Shallow Neural Networks\" md\" Activation Function\" plot scatter x x,y relu. x , Layout width 350, height 250 Markdown.MD Markdown.Admonition \"warning\", \"Universal Approximation Theorem\", md\"\"\" The universal approximation theorem proves that for any continuous function, there exists a shallow network that can approximate this function to any specified precision. Intuition Every time we add a hidden unit, we add another linear region to the function. As these regions become more numerous, they represent smaller sections of the function, which are increasingly well approximated by a line. \"\"\" ntrain datasets 10 md\" Deep Neural Networks\" md\" Matrix Notation\" md\" Appendix\" md\" UI\" function gui input return PlutoUI.combine do Child inputs md\"\"\" Network Width Child \"network width\", Slider 3 100, show value true Train Samples Child \"ntrain samples\", Slider 3 100, show value true \"\"\", md\"\"\" Child \"resample data\", CounterButton \"Regenerate Training Data\" Child \"new network\", CounterButton \"Reinitialize Network\" Child \"retrain\", CounterButton \"Train Network\" Child \"reset plot\", CounterButton \"Reset Plot\" \"\"\" md\"\"\" inputs \"\"\" end end trainui bind para gui input trainui trainui trainui training datasets use memo para.resample data, para.ntrain samples, ntrain datasets do xtrain Float32. reshape rand Uniform xmin, xmax , para.ntrain samples , 1, training datasets map 1 ntrain datasets do i ytrain Float32. sin. 2.0 . xtrain 0.1 randn 1, para.ntrain samples loader Flux.DataLoader xtrain, ytrain , batchsize 5, shuffle true return xtrain, ytrain, loader end training datasets end shallow fig use memo para.resample data, para.reset plot do xtrain, ytrain training datasets 1 return plot scatter x vec xtrain , y vec ytrain , mode \"markers\", name \"training data\" , scatter x vec x , y vec sin. 2.0 x , name \"true function\", line attr color \"black\" , Layout width 350, height 250, title \"Testing Learned Models\", yaxis attr range 2, 2 ,legend attr x 1, y 0.5, yanchor \"bottom\", xanchor \"right\", orientation \"h\" , end md\" Model\" begin struct Affine W b end Affine in Integer, out Integer Affine randn out, in , randn out Overload call, so the object can be used as a function m Affine x m.W x . m.b a Affine 10, 5 Flux. layer Affine end models, optims use memo para.new network, para.network width do models Chain Affine 1, para.network width , relu, Affine para.network width, 1 for i in 1 ntrain datasets optims Flux.setup Flux.Adam 0.001 , model for model in models models, optims end trained use memo para.retrain do map 1 ntrain datasets do i loader training datasets i .loader model models i for epoch in 1 300 Flux.train model, loader, optims i do m, x, y y hat m x Flux.mse y hat, y end end color i 1 ? \"red\" \"gray\" opacity i 1 ? 1.0 0.5 width i 1 ? 1.0 2.0 add trace shallow fig, scatter opacity opacity, x vec x , y vec models i reshape Float32. x , 1, , line attr width 1, color color ,showlegend false end return randn end begin para trained shallow fig end model models 1 h collect. eachslice model.layers 1 xm , dims 1 plot scatter x x, y plotitem for plotitem in h , Layout width 350, height 250, showlegend false, title \"hᵢ θ1ᵢ x θ2ᵢ\" ha collect. eachslice model.layers 2 model.layers 1 xm , dims 1 plot scatter x x, y plotitem for plotitem in ha , Layout width 350, height 250, showlegend false, title \"a hᵢ \" y model xm plot scatter x x, y plotitem for plotitem in vec y , Layout width 350, height 250, title \"y ϕ ∑ᵢ ϕᵢ a hᵢ \" md\"\"\" References ^book Prince, Simon JD. Understanding Deep Learning. MIT press, 2023. \"\"\" "},{"url":"mod2_learning/pinn/","title":"pinn","tags":[],"text":" A Pluto.jl notebook v0.19.40 using Markdown using InteractiveUtils begin ENV \"JULIA COPY STACKS\" \"1\" using PlutoPlotly, TauP end x range 1, 1, length 100 TimeTauP taup time \"P\",\"S\" , 55.0, 100.0 model \"iasp91\", verbose true "},{"url":"mod2_learning/pinn/","title":"To be updated","tags":["module2"],"text":"Many real-time optimization problems involve minimizing the cost or time taken to reach a goal. In this section,\nwe test the PINN method on the task of fnding the shortest-time path in several environments where an analytic\nsolution exists. One signifcant diference from the previous example (swinging up a pendulum) is that the time\ntaken is a variable and the subject to be minimized.\nWe present two famous examples of fnding the shortest-time path. (1) Fermat’s principle, or the principle of\nleast time, is that the path of the light ray between two given points is determined as the path that can be traveled\nin the shortest time. (2) Another one is the shortest-time descent path between two given points under gravity,\nknown as the brachistochrone curve. It has been mathematically proven that it is part of a cycloid.\nTe refraction of light can be explained by Fermat’s principle. When the refraction index in a medium varies\naccording to the location, the speed of the ray changes. In this case, the path of the ray bends to fnd a shortertime path in the medium. An example of the refraction of light within a medium where the refraction index\nvaries is shown in Fig. 3a.\nFigure 3. Applications of PINN for determining the shortest-time path under specifc environments. (a)\nFinding the shortest-time path of a light ray within the medium where the refraction index varies along y. (b)\nFinding the shortest-time descent path between two given points under constant gravity. In the two fgures, the\nanalytic solutions are given in yellow dashed lines and the converged solutions by PINN are shown in blue. For\nbaselines, the results using RL with 105\niterations are shown in magenta lines.\n5\nVol.:(0123456789)\nScientifc Reports | (2024) 14:202 | https://doi.org/10.1038/s41598-023-49977-3\nwww.nature.com/scientificreports/\nIn the 2D xy space of Fig. 3a, the refraction index (n) has a sinusoidal profle with respect to y, as represented\nby the contour color. Te ray slows down around y = 0.5 where the n is high. Terefore, the path of light that\npasses in the shortest time will be determined to become more vertical near the slowest region, y = 0.5. Tus,\nthe ray trajectory will bend according to the changes in the refraction index, consistent with the analytic solution dictated by the law of refraction, as shown in yellow dashed line in Fig. 3a. When using RL to search for the\nshortest-time arrival trajectory, even afer 105\niterations of training, a trajectory far from the analytic solution\nemerges, as indicated by the magenta line. While this trajectory does become vertical around y = 0.5 where n\nis high, it is still far from being the shortest possible time.\nTo fnd the shortest-time path using PINN, the input of the neural network of Fig. 1 is set to the normalized\ntime (tN ), and the outputs are the x and y coordinates. The governing equation is given by\nF =\n� 1\nT\ndx\ndtN\n�2\n+\n� 1\nT\ndy\ndtN\n�2\n− � c\nn\n�2\n, where c = 1 is the speed of light in vacuum and T is the time taken from\nthe starting point to the endpoint. Here, T is unknown and a trainable variable during the neural network training. Constraints are set as the coordinates of the starting and ending points, respectively (0, 0), (1, 1), and the\ngoal is set as Lgoal = T, aiming to minimize the time taken. More specifc settings can be found in the “Methods”\nsection.\nTe solid lines in Fig. 3a depict the solution paths at each checkpoint (iteration I = 500, 1000, 1500, 2000),\nwith the blue solid line representing the converged fnal solution (I = 2232). Unlike traditional methods that\nexplore the shortest-time curve from a fxed start point to an endpoint, the PINN approach shows the characteristic of searching for the shortest-time curve while simultaneously approaching the start and endpoint. Te\nconverged solution shows a path that almost coincides with the analytic solution.\nFigure 3b illustrates the search for the shortest-time descent curve (brachistochrone curve) connecting two\ngiven points under gravity (g = 9.8 m/s2). Here, the yellow dashed line is the analytic solution for the shortesttime curve, which is a cycloid. In the RL solution with 105\niterations shown in magenta, the path more vertically\nfree-falls to increase velocity and then changes direction horizontally at the lower altitude to move at a high\nspeed. While this seems intuitively plausible, it deviates from the actual shortest curve, the cycloid. On the other\nhand, for PINN, the governing equation is set as the mechanical energy conservation law,\nF = gy0 −\n�\ngy + 1\n2\n�� 1\nT\ndx\ndtN\n�2\n+\n� 1\nT\ndy\ndtN\n�2\n��, and the constraints were set using the start ((x0, y0) = (0, 1))\nand endpoint coordinates ((x1, y1) = (1, 0)). Te goal, similar to Fig. 3a, was set as Lgoal = T to fnd the shortesttime curve. In Fig. 3b, at the initial phase (I = 500), a non-physical path that fails to align the start and endpoints\nis derived. But it gradually converges to a path close to the analytic solution shown in yellow. Tis approach using\nPINN to search for the shortest-time path can be utilized in chip design to fnd the minimum-loss circuit."},{"url":"mod2_learning/tbu/","title":"To be updated","tags":["module2"],"text":"COMING SOON"},{"url":"mod3_time_series/tbu/","title":"To be updated","tags":["module3"],"text":"COMING SOON"}]